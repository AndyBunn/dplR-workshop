<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Chronology Building | Learning to Love dplR</title>
  <meta name="description" content="Helful materials for dplR" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Chronology Building | Learning to Love dplR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Helful materials for dplR" />
  <meta name="github-repo" content="OpenDendro/dplR-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Chronology Building | Learning to Love dplR" />
  
  <meta name="twitter:description" content="Helful materials for dplR" />
  

<meta name="author" content="Andy Bunn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-dplr.html"/>
<link rel="next" href="simple-signal-free.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
      // AGB add fold-hide
    if (classList[i] === 'fold-hide') {
        show = false;
      }
    }
    // AGB
    // if code block has been labeled with class `fold-hide`, hide the code on init!
//    var classList = $(this).attr('class').split(/\s+/);
//    for (var i = 0; i < classList.length; i++) {
//    if (classList[i] === 'fold-hide') {
//        show = false;
//      }
//    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = true;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  // AGB add fold-hide changed === to !== to default to showing code
  window.initializeCodeFolding("show" !== "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#before-starting"><i class="fa fa-check"></i><b>2.1</b> Before Starting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#getting-dplr"><i class="fa fa-check"></i><b>2.1.2</b> Getting dplR</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#layout"><i class="fa fa-check"></i><b>2.2</b> Layout</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#a-note-on-name-conflicts"><i class="fa fa-check"></i><b>2.2.1</b> A Note on Name Conflicts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.3</b> Getting Help with R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#citing-r-dplr-and-other-packages"><i class="fa fa-check"></i><b>2.4</b> Citing R, dplR, and Other Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-dplr.html"><a href="using-dplr.html"><i class="fa fa-check"></i><b>3</b> Using dplR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-dplr.html"><a href="using-dplr.html#what-is-covered"><i class="fa fa-check"></i><b>3.1</b> What is Covered</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="using-dplr.html"><a href="using-dplr.html#load-dplr"><i class="fa fa-check"></i><b>3.1.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-dplr.html"><a href="using-dplr.html#working-with-ring-width-data"><i class="fa fa-check"></i><b>3.2</b> Working with Ring-Width Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="using-dplr.html"><a href="using-dplr.html#reading-data"><i class="fa fa-check"></i><b>3.2.1</b> Reading Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-dplr.html"><a href="using-dplr.html#describing-and-plotting-ring-width-data"><i class="fa fa-check"></i><b>3.2.2</b> Describing and Plotting Ring-Width Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4" data-path="using-dplr.html"><a href="using-dplr.html#detrending"><i class="fa fa-check"></i><b>3.4</b> Detrending</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="using-dplr.html"><a href="using-dplr.html#common-detrending-methods"><i class="fa fa-check"></i><b>3.4.1</b> Common Detrending Methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="using-dplr.html"><a href="using-dplr.html#other-detrending-methods"><i class="fa fa-check"></i><b>3.4.2</b> Other Detrending Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics-for-detrended-data"><i class="fa fa-check"></i><b>3.5</b> Descriptive Statistics for Detrended Data</a></li>
<li class="chapter" data-level="3.6" data-path="using-dplr.html"><a href="using-dplr.html#building-a-mean-value-chronology"><i class="fa fa-check"></i><b>3.6</b> Building a Mean-Value Chronology</a></li>
<li class="chapter" data-level="3.7" data-path="using-dplr.html"><a href="using-dplr.html#conclusion"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chronology-building.html"><a href="chronology-building.html"><i class="fa fa-check"></i><b>4</b> Chronology Building</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chronology-building.html"><a href="chronology-building.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chronology-building.html"><a href="chronology-building.html#data-sets"><i class="fa fa-check"></i><b>4.2</b> Data Sets</a></li>
<li class="chapter" data-level="4.3" data-path="chronology-building.html"><a href="chronology-building.html#traditional-chronology"><i class="fa fa-check"></i><b>4.3</b> Traditional Chronology</a></li>
<li class="chapter" data-level="4.4" data-path="chronology-building.html"><a href="chronology-building.html#using-a-sample-depth-cutoff"><i class="fa fa-check"></i><b>4.4</b> Using a Sample Depth Cutoff</a></li>
<li class="chapter" data-level="4.5" data-path="chronology-building.html"><a href="chronology-building.html#using-sss-as-a-cutoff"><i class="fa fa-check"></i><b>4.5</b> Using SSS as a Cutoff</a></li>
<li class="chapter" data-level="4.6" data-path="chronology-building.html"><a href="chronology-building.html#chronology-uncertainty"><i class="fa fa-check"></i><b>4.6</b> Chronology Uncertainty</a></li>
<li class="chapter" data-level="4.7" data-path="chronology-building.html"><a href="chronology-building.html#the-arstan-chronology"><i class="fa fa-check"></i><b>4.7</b> The ARSTAN Chronology</a></li>
<li class="chapter" data-level="4.8" data-path="chronology-building.html"><a href="chronology-building.html#stabalizing-the-variance"><i class="fa fa-check"></i><b>4.8</b> Stabalizing the Variance</a></li>
<li class="chapter" data-level="4.9" data-path="chronology-building.html"><a href="chronology-building.html#stripping-out-series-by-eps"><i class="fa fa-check"></i><b>4.9</b> Stripping out series by EPS</a></li>
<li class="chapter" data-level="4.10" data-path="chronology-building.html"><a href="chronology-building.html#conclusion-1"><i class="fa fa-check"></i><b>4.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simple-signal-free.html"><a href="simple-signal-free.html"><i class="fa fa-check"></i><b>5</b> Simple Signal-Free</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#making-the-simple-signal-free-chronology"><i class="fa fa-check"></i><b>5.4</b> Making the Simple Signal-Free Chronology</a></li>
<li class="chapter" data-level="5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#changing-the-detrending-method"><i class="fa fa-check"></i><b>5.5</b> Changing the Detrending Method</a></li>
<li class="chapter" data-level="5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#walk-through"><i class="fa fa-check"></i><b>5.6</b> Walk Through</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-1-iteration-0"><i class="fa fa-check"></i><b>5.6.1</b> Step 1 (Iteration 0)</a></li>
<li class="chapter" data-level="5.6.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-2-and-3-iteration-1"><i class="fa fa-check"></i><b>5.6.2</b> Steps 2 and 3 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-4-and-5-iteration-1"><i class="fa fa-check"></i><b>5.6.3</b> Steps 4 and 5 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-6-and-7-iteration-1"><i class="fa fa-check"></i><b>5.6.4</b> Step 6 and 7 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-8-begin-iterations"><i class="fa fa-check"></i><b>5.6.5</b> Step 8 (Begin Iterations)</a></li>
<li class="chapter" data-level="5.6.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#iterations-visualized"><i class="fa fa-check"></i><b>5.6.6</b> Iterations Visualized</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="simple-signal-free.html"><a href="simple-signal-free.html#final-thoughts"><i class="fa fa-check"></i><b>5.7</b> Final Thoughts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="xdate.html"><a href="xdate.html"><i class="fa fa-check"></i><b>6</b> xDate</a>
<ul>
<li class="chapter" data-level="6.1" data-path="xdate.html"><a href="xdate.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="xdate.html"><a href="xdate.html#using-the-xdater-app"><i class="fa fa-check"></i><b>6.2</b> Using the xDater app</a></li>
<li class="chapter" data-level="6.3" data-path="xdate.html"><a href="xdate.html#crossdating-by-hand-in-dplr"><i class="fa fa-check"></i><b>6.3</b> Crossdating by hand in dplR</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="xdate.html"><a href="xdate.html#load-dplr-1"><i class="fa fa-check"></i><b>6.3.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="xdate.html"><a href="xdate.html#ruining-a-perfectly-good-data-set"><i class="fa fa-check"></i><b>6.4</b> Ruining a Perfectly Good Data Set</a></li>
<li class="chapter" data-level="6.5" data-path="xdate.html"><a href="xdate.html#series-correlation-by-segment"><i class="fa fa-check"></i><b>6.5</b> Series Correlation by Segment</a></li>
<li class="chapter" data-level="6.6" data-path="xdate.html"><a href="xdate.html#individual-series-correlation"><i class="fa fa-check"></i><b>6.6</b> Individual Series Correlation</a></li>
<li class="chapter" data-level="6.7" data-path="xdate.html"><a href="xdate.html#using-cross-correlation"><i class="fa fa-check"></i><b>6.7</b> Using Cross Correlation</a></li>
<li class="chapter" data-level="6.8" data-path="xdate.html"><a href="xdate.html#visual-crossdating"><i class="fa fa-check"></i><b>6.8</b> Visual Crossdating</a></li>
<li class="chapter" data-level="6.9" data-path="xdate.html"><a href="xdate.html#conclusion-2"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html"><i class="fa fa-check"></i><b>7</b> Intro to dendro time-series</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#load-libraries"><i class="fa fa-check"></i><b>7.1.1</b> Load libraries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#data-sets-1"><i class="fa fa-check"></i><b>7.2</b> Data Sets</a></li>
<li class="chapter" data-level="7.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#smoothing"><i class="fa fa-check"></i><b>7.3</b> Smoothing</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#moving-running-average"><i class="fa fa-check"></i><b>7.3.1</b> Moving (running) average</a></li>
<li class="chapter" data-level="7.3.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#hanning"><i class="fa fa-check"></i><b>7.3.2</b> Hanning</a></li>
<li class="chapter" data-level="7.3.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#splines"><i class="fa fa-check"></i><b>7.3.3</b> Splines</a></li>
<li class="chapter" data-level="7.3.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#loess"><i class="fa fa-check"></i><b>7.3.4</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#characterizing-temporal-structure"><i class="fa fa-check"></i><b>7.4</b> Characterizing Temporal Structure</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#acf-and-pacf"><i class="fa fa-check"></i><b>7.4.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="7.4.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#ar-and-arma"><i class="fa fa-check"></i><b>7.4.2</b> AR and ARMA</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#frequency-domain"><i class="fa fa-check"></i><b>7.5</b> Frequency Domain</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#power-via-spectral-analysis-and-wavelets"><i class="fa fa-check"></i><b>7.5.1</b> Power via Spectral Analysis and Wavelets</a></li>
<li class="chapter" data-level="7.5.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#extracting-signals"><i class="fa fa-check"></i><b>7.5.2</b> Extracting signals</a></li>
<li class="chapter" data-level="7.5.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#high-pass-low-pass-and-bandpass-filtering"><i class="fa fa-check"></i><b>7.5.3</b> High-pass, low-pass, and bandpass filtering</a></li>
<li class="chapter" data-level="7.5.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#interruption-duplicate-function-names"><i class="fa fa-check"></i><b>7.5.4</b> Interruption: Duplicate function names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>8</b> Acknowledgements</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning to Love dplR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chronology-building" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Chronology Building<a href="chronology-building.html#chronology-building" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction<a href="chronology-building.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The creation of a mean-value chronology is one of the central tasks for a dendrochronologist. It’s most commonly done by calculating the mean of each year across all the series in the data. However, there are several more ways to approach the problem and this document explains a few different ways of going about it.</p>
<p>The use of the signal-free method of chronology building with <code>ssf</code> is complex enough to warrant its own chapter.</p>
</div>
<div id="data-sets" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Data Sets<a href="chronology-building.html#data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout this document we will use the onboard data set <code>wa082</code> which gives the raw ring widths for Pacific silver fir <em>Abies amabilis</em> at Hurricane Ridge in Washington, USA. There are 23 series covering 286 years.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="chronology-building.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplR)</span></code></pre></div>
<pre><code>## This is dplR version 1.7.3.
## New users can visit https://opendendro.github.io/dplR-workshop/ to get started.</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chronology-building.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wa082)</span>
<span id="cb60-2"><a href="chronology-building.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wa082, <span class="at">plot.type=</span><span class="st">&quot;spag&quot;</span>)</span></code></pre></div>
<p><img src="03-crn_files/figure-html/load%20wa082-1.png" width="672" /></p>
<p>By the way, if this is all new to you – go back and look at earlier chapters and proceed immediately to a good primer on dendrochronology like Fritts <span class="citation">(<a href="references.html#ref-Fritts2001" role="doc-biblioref">2001</a>)</span>.</p>
</div>
<div id="traditional-chronology" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Traditional Chronology<a href="chronology-building.html#traditional-chronology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us make a few chronologies from the <code>wa082</code> data after detrending each series with an age-dependent spline (using <code>ads</code>). Detrending is an enormously complicated
area unto itself and more deserving of a chapter than chronology building is. We over some of the issues around detrending in the prior chapter. There is a reason,
after all, that dendrochronologists have been arguing about detrending for decades.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="chronology-building.html#cb61-1" aria-hidden="true" tabindex="-1"></a>wa082RWI <span class="ot">&lt;-</span> <span class="fu">detrend</span>(wa082, <span class="at">method=</span><span class="st">&quot;AgeDepSpline&quot;</span>)</span></code></pre></div>
<p>The simplest way to make a chronology in <code>dplR</code> is chronology is with the <code>chron</code>
function which also has a <code>plot</code> method. This defaults to building a mean-value
chronology by averaging the rows of the <code>rwi</code> data using Tukey’s biweight robust
mean (function <code>tbrm</code>). Here it is with a a 30-year smoothing spline for visualization.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chronology-building.html#cb62-1" aria-hidden="true" tabindex="-1"></a>wa082Crn <span class="ot">&lt;-</span> <span class="fu">chron</span>(wa082RWI)</span>
<span id="cb62-2"><a href="chronology-building.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wa082Crn)</span></code></pre></div>
<pre><code>## Classes &#39;crn&#39; and &#39;data.frame&#39;:  286 obs. of  2 variables:
##  $ std       : num  1.147 0.913 0.914 0.624 0.855 ...
##  $ samp.depth: num  1 1 1 1 2 2 2 2 3 3 ...</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chronology-building.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wa082Crn, <span class="at">add.spline=</span><span class="cn">TRUE</span>, <span class="at">nyrs=</span><span class="dv">30</span>)</span></code></pre></div>
<p><img src="03-crn_files/figure-html/crn1-1.png" width="672" /></p>
<p>Note the structure (<code>str</code>) of the output object states that it is <code>class</code> <code>crn</code>. This means that there are some generic functions that <code>dplR</code> has ready to work with this kind of object (e.g., <code>time</code> to extract the years, and <code>plot</code> which then calls <code>crn.plot</code>).</p>
<p>The <code>chron</code> function will also compute a residual chronology by prewhitening the series before averaging. If the <code>prewhiten</code> flag is set to <code>TRUE</code>, each series is whitened using <code>ar</code> prior to averaging. The residual chronology is thus white noise. Note that the <code>crn</code> object below has two columns with chronologies as well as the sample depth in a third column.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="chronology-building.html#cb65-1" aria-hidden="true" tabindex="-1"></a>wa082CrnResid <span class="ot">&lt;-</span> <span class="fu">chron</span>(wa082RWI, <span class="at">prewhiten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-2"><a href="chronology-building.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wa082CrnResid)</span></code></pre></div>
<pre><code>## Classes &#39;crn&#39; and &#39;data.frame&#39;:  286 obs. of  3 variables:
##  $ std       : num  1.147 0.913 0.914 0.624 0.855 ...
##  $ res       : num  NA NA NA NA NA ...
##  $ samp.depth: num  1 1 1 1 2 2 2 2 3 3 ...</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="chronology-building.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wa082CrnResid)</span></code></pre></div>
<p><img src="03-crn_files/figure-html/crnRes-1.png" width="672" /></p>
</div>
<div id="using-a-sample-depth-cutoff" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Using a Sample Depth Cutoff<a href="chronology-building.html#using-a-sample-depth-cutoff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A relatively simple addition to the traditional chronology is to truncate the
chronology when the sample depth gets to a certain threshold. The output from
the <code>chron</code> function contains a column called <code>samp.depth</code> which shows the
number of series that are average for a particular year. We can use the
<code>subset</code> function to modify the chronology. A standard method is to truncate the sample depth to a minimum of five series.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="chronology-building.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wa082Crn)</span></code></pre></div>
<pre><code>##         std samp.depth
## 1698 1.1472          1
## 1699 0.9133          1
## 1700 0.9135          1
## 1701 0.6244          1
## 1702 0.8551          2
## 1703 0.6795          2</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="chronology-building.html#cb70-1" aria-hidden="true" tabindex="-1"></a>wa082CrnTrunc <span class="ot">&lt;-</span> <span class="fu">subset</span>(wa082Crn, samp.depth <span class="sc">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb70-2"><a href="chronology-building.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wa082CrnTrunc,<span class="at">add.spline=</span>T,<span class="at">nyrs=</span><span class="dv">30</span>)</span></code></pre></div>
<p><img src="03-crn_files/figure-html/trunc5-1.png" width="672" /></p>
<p>It would likely be more robust to recalculate the ring-width indices object by truncating the <code>rwl</code> file and then making a chronology which could be done by nesting commands via:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="chronology-building.html#cb71-1" aria-hidden="true" tabindex="-1"></a>wa082CrnTrunc <span class="ot">&lt;-</span> <span class="fu">chron</span>(<span class="fu">detrend</span>(wa082[wa082Crn<span class="sc">$</span>samp.depth <span class="sc">&gt;</span> <span class="dv">4</span>,], </span>
<span id="cb71-2"><a href="chronology-building.html#cb71-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">method=</span><span class="st">&quot;AgeDepSpline&quot;</span>))</span></code></pre></div>
<p>The result in this case is likely to be virtually identical to truncating after calculating the chronology but still seems like a good practice.</p>
</div>
<div id="using-sss-as-a-cutoff" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Using SSS as a Cutoff<a href="chronology-building.html#using-sss-as-a-cutoff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A more interesting and likely more robust approach is to truncate via the
subsample signal strength (SSS). Just for fun, I’ll show how we can do this using <code>tidy</code> syntax and <code>ggplot</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="chronology-building.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.6     ✓ dplyr   1.0.8
## ✓ tidyr   1.2.0     ✓ stringr 1.4.0
## ✓ readr   2.1.2     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="chronology-building.html#cb76-1" aria-hidden="true" tabindex="-1"></a>wa082Ids <span class="ot">&lt;-</span> <span class="fu">autoread.ids</span>(wa082)</span>
<span id="cb76-2"><a href="chronology-building.html#cb76-2" aria-hidden="true" tabindex="-1"></a>sssThresh <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb76-3"><a href="chronology-building.html#cb76-3" aria-hidden="true" tabindex="-1"></a>wa082SSS <span class="ot">&lt;-</span> <span class="fu">sss</span>(wa082RWI, wa082Ids)</span>
<span id="cb76-4"><a href="chronology-building.html#cb76-4" aria-hidden="true" tabindex="-1"></a>yrs <span class="ot">&lt;-</span> <span class="fu">time</span>(wa082)</span>
<span id="cb76-5"><a href="chronology-building.html#cb76-5" aria-hidden="true" tabindex="-1"></a>yrCutoff <span class="ot">&lt;-</span> <span class="fu">max</span>(yrs[wa082SSS <span class="sc">&lt;</span> sssThresh])</span>
<span id="cb76-6"><a href="chronology-building.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb76-7"><a href="chronology-building.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax=</span><span class="cn">Inf</span>,<span class="at">xmin=</span><span class="sc">-</span><span class="cn">Inf</span>,<span class="at">xmax=</span>yrCutoff),</span>
<span id="cb76-8"><a href="chronology-building.html#cb76-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span><span class="st">&quot;darkred&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb76-9"><a href="chronology-building.html#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">y=</span><span class="fl">1.5</span>,<span class="at">x=</span><span class="dv">1725</span>,<span class="at">label=</span><span class="st">&quot;SSS &lt; 0.85&quot;</span>)<span class="sc">+</span></span>
<span id="cb76-10"><a href="chronology-building.html#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-11"><a href="chronology-building.html#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>wa082Crn<span class="sc">$</span>std)) <span class="sc">+</span></span>
<span id="cb76-12"><a href="chronology-building.html#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;RWI&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="03-crn_files/figure-html/truncsss-1.png" width="672" /></p>
<p>Now we can cutoff the <code>rwl</code> data and redo the chronology.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="chronology-building.html#cb77-1" aria-hidden="true" tabindex="-1"></a>wa082RwlSSS <span class="ot">&lt;-</span> wa082[wa082SSS <span class="sc">&gt;</span> sssThresh,]</span>
<span id="cb77-2"><a href="chronology-building.html#cb77-2" aria-hidden="true" tabindex="-1"></a>wa082RwiSSS <span class="ot">&lt;-</span> <span class="fu">detrend</span>(wa082RwlSSS, <span class="at">method=</span><span class="st">&quot;AgeDepSpl&quot;</span>)</span>
<span id="cb77-3"><a href="chronology-building.html#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="chronology-building.html#cb77-4" aria-hidden="true" tabindex="-1"></a>wa082CrnSSS <span class="ot">&lt;-</span> <span class="fu">chron</span>(wa082RwiSSS)</span>
<span id="cb77-5"><a href="chronology-building.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-6"><a href="chronology-building.html#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="chronology-building.html#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">time</span>(wa082CrnSSS),<span class="at">y=</span>wa082CrnSSS<span class="sc">$</span>std)) <span class="sc">+</span></span>
<span id="cb77-8"><a href="chronology-building.html#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">time</span>(wa082CrnSSS),</span>
<span id="cb77-9"><a href="chronology-building.html#cb77-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span><span class="fu">caps</span>(wa082CrnSSS<span class="sc">$</span>std,<span class="at">nyrs =</span> <span class="dv">30</span>)),</span>
<span id="cb77-10"><a href="chronology-building.html#cb77-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-11"><a href="chronology-building.html#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;RWI&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="03-crn_files/figure-html/truncsss2-1.png" width="672" /></p>
</div>
<div id="chronology-uncertainty" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Chronology Uncertainty<a href="chronology-building.html#chronology-uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Typically we calculate a chronology by taking the average of each year from the ring-width indices. And that is typically the biweight robust mean. The function <code>chron</code> like pretty many of the functions in <code>dplR</code> are relatively simple chunks of code that are used for convenience. We can make our own chronology and get the mean plus two standard errors of the yearly growth quite simply. It’s important for new users of <code>dplR</code> not to get stuck with just the available functions and to roll your own code.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="chronology-building.html#cb78-1" aria-hidden="true" tabindex="-1"></a>wa082AvgCrn <span class="ot">&lt;-</span> <span class="fu">apply</span>(wa082RwiSSS,<span class="dv">1</span>,mean,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-2"><a href="chronology-building.html#cb78-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb78-3"><a href="chronology-building.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(x)</span>
<span id="cb78-4"><a href="chronology-building.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x2)</span>
<span id="cb78-5"><a href="chronology-building.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(x2)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb78-6"><a href="chronology-building.html#cb78-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-7"><a href="chronology-building.html#cb78-7" aria-hidden="true" tabindex="-1"></a>wa082AvgCrnSE <span class="ot">&lt;-</span> <span class="fu">apply</span>(wa082RwiSSS,<span class="dv">1</span>,se)</span>
<span id="cb78-8"><a href="chronology-building.html#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="chronology-building.html#cb78-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span><span class="fu">as.numeric</span>(<span class="fu">names</span>(wa082AvgCrn)), </span>
<span id="cb78-10"><a href="chronology-building.html#cb78-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">std =</span> wa082AvgCrn,</span>
<span id="cb78-11"><a href="chronology-building.html#cb78-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lwr =</span> wa082AvgCrn <span class="sc">-</span> wa082AvgCrnSE<span class="sc">*</span><span class="dv">2</span>,</span>
<span id="cb78-12"><a href="chronology-building.html#cb78-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">upr =</span> wa082AvgCrn <span class="sc">+</span> wa082AvgCrnSE<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb78-13"><a href="chronology-building.html#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat,<span class="fu">aes</span>(<span class="at">x=</span>yrs)) <span class="sc">+</span></span>
<span id="cb78-14"><a href="chronology-building.html#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-15"><a href="chronology-building.html#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr,<span class="at">ymax=</span>upr),</span>
<span id="cb78-16"><a href="chronology-building.html#cb78-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-17"><a href="chronology-building.html#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>std),<span class="at">col=</span><span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-18"><a href="chronology-building.html#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;RWI&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="03-crn_files/figure-html/crn%20se-1.png" width="672" /></p>
<p>It is interesting to note how the uncertainty increases towards the end of the chronology. This is somewhat unusual.</p>
</div>
<div id="the-arstan-chronology" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> The ARSTAN Chronology<a href="chronology-building.html#the-arstan-chronology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The function <code>chron.ars</code> produces the so-called ARSTAN chronology which retains the autoregressive structure of the input data. Users unfamiliar with the concept should dive into Cook <span class="citation">(<a href="references.html#ref-cook1985" role="doc-biblioref">1985</a>)</span>. This produces three mean-value chronologies: standard, residual, and ARSTAN.</p>
<p>The standard chronology is the (biweight) mean value across rows and identical to <code>chron</code>. The residual chronology is the prewhitened chronology as described by Cook <span class="citation">(<a href="references.html#ref-cook1985" role="doc-biblioref">1985</a>)</span> and uses uses multivariate autoregressive modeling to determine the order of the AR process. It’s important to note that residual chronology produced here is different than the simple residual chronology produced by <code>chron</code> which returns the residuals of an AR process using a naive call to <code>ar</code>. But in practice the results will be similar. For more on the residual chronology in this function, see pp. 153-154 in Cook <span class="citation">(<a href="references.html#ref-cook1985" role="doc-biblioref">1985</a>)</span>.</p>
<p>The ARSTAN chronology builds on the residual chronology but returns a re-whitened chronology where the pooled AR coefficients from the multivariate autoregressive modeling are reintroduced.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="chronology-building.html#cb79-1" aria-hidden="true" tabindex="-1"></a>wa082ArsCrnSSS <span class="ot">&lt;-</span> <span class="fu">chron.ars</span>(wa082RwiSSS)</span></code></pre></div>
<pre><code>## Pooled AR Summary
## ACF
##  ar(0)  ar(1)  ar(2)  ar(3)  ar(4)  ar(5)  ar(6)  ar(7)  ar(8)  ar(9) ar(10) 
## 1.0000 0.3548 0.3356 0.3073 0.2524 0.2306 0.2201 0.1940 0.2093 0.2107 0.2063 
## AR Coefs
##              1       2       3        4        5        6         7        8
## ar(1)  -0.3548  0.0000  0.0000  0.00000  0.00000  0.00000  0.000000  0.00000
## ar(2)  -0.2697 -0.2399  0.0000  0.00000  0.00000  0.00000  0.000000  0.00000
## ar(3)  -0.2314 -0.1968 -0.1598  0.00000  0.00000  0.00000  0.000000  0.00000
## ar(4)  -0.2197 -0.1825 -0.1429 -0.07294  0.00000  0.00000  0.000000  0.00000
## ar(5)  -0.2156 -0.1744 -0.1326 -0.06051 -0.05657  0.00000  0.000000  0.00000
## ar(6)  -0.2124 -0.1710 -0.1251 -0.05060 -0.04432 -0.05685  0.000000  0.00000
## ar(7)  -0.2105 -0.1695 -0.1234 -0.04655 -0.03878 -0.04997 -0.032391  0.00000
## ar(8)  -0.2084 -0.1663 -0.1209 -0.04357 -0.03087 -0.03911 -0.018905 -0.06406
## ar(9)  -0.2044 -0.1651 -0.1185 -0.04164 -0.02815 -0.03156 -0.008518 -0.05105
## ar(10) -0.2013 -0.1625 -0.1181 -0.04003 -0.02672 -0.02943 -0.002472 -0.04262
##               9       10
## ar(1)   0.00000  0.00000
## ar(2)   0.00000  0.00000
## ar(3)   0.00000  0.00000
## ar(4)   0.00000  0.00000
## ar(5)   0.00000  0.00000
## ar(6)   0.00000  0.00000
## ar(7)   0.00000  0.00000
## ar(8)   0.00000  0.00000
## ar(9)  -0.06245  0.00000
## ar(10) -0.05202 -0.05102
## AIC
##  ar(0)  ar(1)  ar(2)  ar(3)  ar(4)  ar(5)  ar(6)  ar(7)  ar(8)  ar(9) ar(10) 
##   1775   1748   1737   1733   1734   1735   1736   1738   1739   1740   1742 
## Selected Order
## [1] 3</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="chronology-building.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wa082ArsCrnSSS)</span></code></pre></div>
<pre><code>## Classes &#39;crn&#39; and &#39;data.frame&#39;:  220 obs. of  4 variables:
##  $ std       : num  0.997 1.176 1.071 1.007 1.197 ...
##  $ res       : num  NaN NaN NaN NA NA ...
##  $ ars       : num  NaN NaN NaN 1.04 1.23 ...
##  $ samp.depth: num  9 9 9 9 9 9 10 10 11 12 ...</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="chronology-building.html#cb83-1" aria-hidden="true" tabindex="-1"></a>wa082ArsCrnSSS <span class="ot">&lt;-</span> wa082ArsCrnSSS[,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb83-2"><a href="chronology-building.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wa082ArsCrnSSS,<span class="at">add.spline=</span><span class="cn">TRUE</span>,<span class="at">nyrs=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="03-crn_files/figure-html/crn%20ars-1.png" width="672" /></p>
</div>
<div id="stabalizing-the-variance" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Stabalizing the Variance<a href="chronology-building.html#stabalizing-the-variance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The function <code>chron.stabilized</code> builds a <em>variance stabilized</em> mean-value chronology following Frank et al. <span class="citation">(<a href="references.html#ref-frank2006" role="doc-biblioref">2006</a>)</span>. The code for this function was written by David Frank and adapted for <code>dplR</code> by Stefan Klesse. The stabilized chronology accounts for both temporal changes in the interseries correlation and sample depth to produce a mean value chronology with stabilized variance.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chronology-building.html#cb84-1" aria-hidden="true" tabindex="-1"></a>wa082StabCrnSSS <span class="ot">&lt;-</span> <span class="fu">chron.stabilized</span>(wa082RwiSSS,<span class="at">winLength=</span><span class="dv">101</span>)</span>
<span id="cb84-2"><a href="chronology-building.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wa082StabCrnSSS) <span class="co"># not class crn</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    220 obs. of  2 variables:
##  $ adj.crn   : num  1.02 1.14 1.07 1.02 1.16 ...
##  $ samp.depth: num  9 9 9 9 9 9 10 10 11 12 ...</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="chronology-building.html#cb86-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(wa082StabCrnSSS)), </span>
<span id="cb86-2"><a href="chronology-building.html#cb86-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Chron =</span> wa082StabCrnSSS<span class="sc">$</span>adj.crn) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="chronology-building.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Smoothed =</span> <span class="fu">caps</span>(Chron,<span class="at">nyrs=</span><span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="chronology-building.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>)</span>
<span id="cb86-5"><a href="chronology-building.html#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="chronology-building.html#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat,<span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>variable)) <span class="sc">+</span></span>
<span id="cb86-7"><a href="chronology-building.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-8"><a href="chronology-building.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb86-9"><a href="chronology-building.html#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;darkred&quot;</span>)) <span class="sc">+</span></span>
<span id="cb86-10"><a href="chronology-building.html#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">title=</span><span class="st">&quot;Variable Stabilized Chronology&quot;</span>) <span class="sc">+</span> </span>
<span id="cb86-11"><a href="chronology-building.html#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb86-12"><a href="chronology-building.html#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="03-crn_files/figure-html/crn%20stab-1.png" width="672" /></p>
</div>
<div id="stripping-out-series-by-eps" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Stripping out series by EPS<a href="chronology-building.html#stripping-out-series-by-eps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We want to introduce one other approach that doesn’t deal explicitly with chronology building but can be used to build a better chronology. The <code>strip.rwl</code> function uses EPS-based chronology stripping where each series is assessed to see if its inclusion in the chronology improves the EPS <span class="citation">(<a href="references.html#ref-fowler2003" role="doc-biblioref">Fowler &amp; Boswijk, 2003</a>)</span>. If it does not the series is dropped from the <code>rwl</code> object. As we will see in this example one series are excluded which causes a modest improvement in EPS. This function was contributed by Christain Zang.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="chronology-building.html#cb87-1" aria-hidden="true" tabindex="-1"></a>wa082StripRwl <span class="ot">&lt;-</span> <span class="fu">strip.rwl</span>(wa082, <span class="at">ids =</span> wa082Ids)</span></code></pre></div>
<pre><code>## REMOVE -- Iteration 1: leaving series 712071 out.
## EPS improved from 0.907 to 0.908.
## 
## REMOVE -- Iteration 2: no improvement of EPS. Aborting...
## REINSERT -- Iteration 1: no improvement of EPS. Aborting...</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="chronology-building.html#cb89-1" aria-hidden="true" tabindex="-1"></a>wa082StripRwi <span class="ot">&lt;-</span> <span class="fu">detrend</span>(wa082StripRwl, <span class="at">method=</span><span class="st">&quot;Spline&quot;</span>)</span>
<span id="cb89-2"><a href="chronology-building.html#cb89-2" aria-hidden="true" tabindex="-1"></a>wa082StripCrn <span class="ot">&lt;-</span> <span class="fu">chron</span>(wa082StripRwi)</span>
<span id="cb89-3"><a href="chronology-building.html#cb89-3" aria-hidden="true" tabindex="-1"></a>wa082StripCrn <span class="ot">&lt;-</span> <span class="fu">subset</span>(wa082StripCrn, samp.depth <span class="sc">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb89-4"><a href="chronology-building.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wa082StripCrn, <span class="at">add.spline=</span><span class="cn">TRUE</span>, <span class="at">nyrs=</span><span class="dv">30</span>)</span></code></pre></div>
<p><img src="03-crn_files/figure-html/crn%20eps-1.png" width="672" /></p>
</div>
<div id="conclusion-1" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Conclusion<a href="chronology-building.html#conclusion-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have tried to introduce a few ways of building chronologies with <code>dplR</code> that are either typical (like truncating by sample depth) or less commonly used. In this chapter we aren’t advocating any particular method but trying to get the users familiar with ways of interacting with the objects that <code>dplR</code> produces. Once the user understands the data structures the rest of <code>R</code> opens up.</p>
<p>Again, we feel that it is important to reiterate that the advantage of using <code>dplR</code> is that it gets the analyst to use <code>R</code> and thus have access to the
essentially limitless tool that it provides. Go foRth!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-dplr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple-signal-free.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
