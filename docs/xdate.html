<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 xDate | Learning to Love dplR</title>
  <meta name="description" content="Helful materials for dplR" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 xDate | Learning to Love dplR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Helful materials for dplR" />
  <meta name="github-repo" content="OpenDendro/dplR-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 xDate | Learning to Love dplR" />
  
  <meta name="twitter:description" content="Helful materials for dplR" />
  

<meta name="author" content="Andy Bunn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-signal-free.html"/>
<link rel="next" href="intro-to-dendro-time-series.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
      // AGB add fold-hide
    if (classList[i] === 'fold-hide') {
        show = false;
      }
    }
    // AGB
    // if code block has been labeled with class `fold-hide`, hide the code on init!
//    var classList = $(this).attr('class').split(/\s+/);
//    for (var i = 0; i < classList.length; i++) {
//    if (classList[i] === 'fold-hide') {
//        show = false;
//      }
//    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = true;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  // AGB add fold-hide changed === to !== to default to showing code
  window.initializeCodeFolding("show" !== "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#before-starting"><i class="fa fa-check"></i><b>2.1</b> Before Starting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#getting-dplr"><i class="fa fa-check"></i><b>2.1.2</b> Getting dplR</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#layout"><i class="fa fa-check"></i><b>2.2</b> Layout</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#a-note-on-name-conflicts"><i class="fa fa-check"></i><b>2.2.1</b> A Note on Name Conflicts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.3</b> Getting Help with R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#citing-r-dplr-and-other-packages"><i class="fa fa-check"></i><b>2.4</b> Citing R, dplR, and Other Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-dplr.html"><a href="using-dplr.html"><i class="fa fa-check"></i><b>3</b> Using dplR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-dplr.html"><a href="using-dplr.html#what-is-covered"><i class="fa fa-check"></i><b>3.1</b> What is Covered</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="using-dplr.html"><a href="using-dplr.html#load-dplr"><i class="fa fa-check"></i><b>3.1.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-dplr.html"><a href="using-dplr.html#working-with-ring-width-data"><i class="fa fa-check"></i><b>3.2</b> Working with Ring-Width Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="using-dplr.html"><a href="using-dplr.html#reading-data"><i class="fa fa-check"></i><b>3.2.1</b> Reading Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-dplr.html"><a href="using-dplr.html#describing-and-plotting-ring-width-data"><i class="fa fa-check"></i><b>3.2.2</b> Describing and Plotting Ring-Width Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4" data-path="using-dplr.html"><a href="using-dplr.html#detrending"><i class="fa fa-check"></i><b>3.4</b> Detrending</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="using-dplr.html"><a href="using-dplr.html#common-detrending-methods"><i class="fa fa-check"></i><b>3.4.1</b> Common Detrending Methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="using-dplr.html"><a href="using-dplr.html#interactive-detrending"><i class="fa fa-check"></i><b>3.4.2</b> Interactive detrending</a></li>
<li class="chapter" data-level="3.4.3" data-path="using-dplr.html"><a href="using-dplr.html#other-detrending-methods"><i class="fa fa-check"></i><b>3.4.3</b> Other Detrending Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics-for-detrended-data"><i class="fa fa-check"></i><b>3.5</b> Descriptive Statistics for Detrended Data</a></li>
<li class="chapter" data-level="3.6" data-path="using-dplr.html"><a href="using-dplr.html#building-a-mean-value-chronology"><i class="fa fa-check"></i><b>3.6</b> Building a Mean-Value Chronology</a></li>
<li class="chapter" data-level="3.7" data-path="using-dplr.html"><a href="using-dplr.html#conclusion"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chronology-building.html"><a href="chronology-building.html"><i class="fa fa-check"></i><b>4</b> Chronology Building</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chronology-building.html"><a href="chronology-building.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chronology-building.html"><a href="chronology-building.html#data-sets"><i class="fa fa-check"></i><b>4.2</b> Data Sets</a></li>
<li class="chapter" data-level="4.3" data-path="chronology-building.html"><a href="chronology-building.html#traditional-chronology"><i class="fa fa-check"></i><b>4.3</b> Traditional Chronology</a></li>
<li class="chapter" data-level="4.4" data-path="chronology-building.html"><a href="chronology-building.html#using-a-sample-depth-cutoff"><i class="fa fa-check"></i><b>4.4</b> Using a Sample Depth Cutoff</a></li>
<li class="chapter" data-level="4.5" data-path="chronology-building.html"><a href="chronology-building.html#using-sss-as-a-cutoff"><i class="fa fa-check"></i><b>4.5</b> Using SSS as a Cutoff</a></li>
<li class="chapter" data-level="4.6" data-path="chronology-building.html"><a href="chronology-building.html#chronology-uncertainty"><i class="fa fa-check"></i><b>4.6</b> Chronology Uncertainty</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chronology-building.html"><a href="chronology-building.html#bootstrapping-confidence-intervals"><i class="fa fa-check"></i><b>4.6.1</b> Bootstrapping confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chronology-building.html"><a href="chronology-building.html#the-arstan-chronology"><i class="fa fa-check"></i><b>4.7</b> The ARSTAN Chronology</a></li>
<li class="chapter" data-level="4.8" data-path="chronology-building.html"><a href="chronology-building.html#stabalizing-the-variance"><i class="fa fa-check"></i><b>4.8</b> Stabalizing the Variance</a></li>
<li class="chapter" data-level="4.9" data-path="chronology-building.html"><a href="chronology-building.html#stripping-out-series-by-eps"><i class="fa fa-check"></i><b>4.9</b> Stripping out series by EPS</a></li>
<li class="chapter" data-level="4.10" data-path="chronology-building.html"><a href="chronology-building.html#conclusion-1"><i class="fa fa-check"></i><b>4.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simple-signal-free.html"><a href="simple-signal-free.html"><i class="fa fa-check"></i><b>5</b> Simple Signal-Free</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#making-the-simple-signal-free-chronology"><i class="fa fa-check"></i><b>5.4</b> Making the Simple Signal-Free Chronology</a></li>
<li class="chapter" data-level="5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#walk-through"><i class="fa fa-check"></i><b>5.5</b> Walk Through</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-1-iteration-0"><i class="fa fa-check"></i><b>5.5.1</b> Step 1 (Iteration 0)</a></li>
<li class="chapter" data-level="5.5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-2-and-3-iteration-1"><i class="fa fa-check"></i><b>5.5.2</b> Steps 2 and 3 (Iteration 1)</a></li>
<li class="chapter" data-level="5.5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-4-and-5-iteration-1"><i class="fa fa-check"></i><b>5.5.3</b> Steps 4 and 5 (Iteration 1)</a></li>
<li class="chapter" data-level="5.5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-6-and-7-iteration-1"><i class="fa fa-check"></i><b>5.5.4</b> Step 6 and 7 (Iteration 1)</a></li>
<li class="chapter" data-level="5.5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-8-begin-iterations"><i class="fa fa-check"></i><b>5.5.5</b> Step 8 (Begin Iterations)</a></li>
<li class="chapter" data-level="5.5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#iterations-visualized"><i class="fa fa-check"></i><b>5.5.6</b> Iterations Visualized</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#changing-the-detrending-method"><i class="fa fa-check"></i><b>5.6</b> Changing the Detrending Method</a></li>
<li class="chapter" data-level="5.7" data-path="simple-signal-free.html"><a href="simple-signal-free.html#final-thoughts"><i class="fa fa-check"></i><b>5.7</b> Final Thoughts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="xdate.html"><a href="xdate.html"><i class="fa fa-check"></i><b>6</b> xDate</a>
<ul>
<li class="chapter" data-level="6.1" data-path="xdate.html"><a href="xdate.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="xdate.html"><a href="xdate.html#using-the-xdater-app"><i class="fa fa-check"></i><b>6.2</b> Using the xDater app</a></li>
<li class="chapter" data-level="6.3" data-path="xdate.html"><a href="xdate.html#crossdating-by-hand-in-dplr"><i class="fa fa-check"></i><b>6.3</b> Crossdating by hand in dplR</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="xdate.html"><a href="xdate.html#load-dplr-1"><i class="fa fa-check"></i><b>6.3.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="xdate.html"><a href="xdate.html#ruining-a-perfectly-good-data-set"><i class="fa fa-check"></i><b>6.4</b> Ruining a Perfectly Good Data Set</a></li>
<li class="chapter" data-level="6.5" data-path="xdate.html"><a href="xdate.html#series-correlation-by-segment"><i class="fa fa-check"></i><b>6.5</b> Series Correlation by Segment</a></li>
<li class="chapter" data-level="6.6" data-path="xdate.html"><a href="xdate.html#individual-series-correlation"><i class="fa fa-check"></i><b>6.6</b> Individual Series Correlation</a></li>
<li class="chapter" data-level="6.7" data-path="xdate.html"><a href="xdate.html#using-cross-correlation"><i class="fa fa-check"></i><b>6.7</b> Using Cross Correlation</a></li>
<li class="chapter" data-level="6.8" data-path="xdate.html"><a href="xdate.html#visual-crossdating"><i class="fa fa-check"></i><b>6.8</b> Visual Crossdating</a></li>
<li class="chapter" data-level="6.9" data-path="xdate.html"><a href="xdate.html#conclusion-2"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html"><i class="fa fa-check"></i><b>7</b> Intro to dendro time-series</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#load-libraries"><i class="fa fa-check"></i><b>7.1.1</b> Load libraries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#data-sets-1"><i class="fa fa-check"></i><b>7.2</b> Data Sets</a></li>
<li class="chapter" data-level="7.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#smoothing"><i class="fa fa-check"></i><b>7.3</b> Smoothing</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#moving-running-average"><i class="fa fa-check"></i><b>7.3.1</b> Moving (running) average</a></li>
<li class="chapter" data-level="7.3.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#hanning"><i class="fa fa-check"></i><b>7.3.2</b> Hanning</a></li>
<li class="chapter" data-level="7.3.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#splines"><i class="fa fa-check"></i><b>7.3.3</b> Splines</a></li>
<li class="chapter" data-level="7.3.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#loess"><i class="fa fa-check"></i><b>7.3.4</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#characterizing-temporal-structure"><i class="fa fa-check"></i><b>7.4</b> Characterizing Temporal Structure</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#acf-and-pacf"><i class="fa fa-check"></i><b>7.4.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="7.4.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#ar-and-arma"><i class="fa fa-check"></i><b>7.4.2</b> AR and ARMA</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#frequency-domain"><i class="fa fa-check"></i><b>7.5</b> Frequency Domain</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#power-via-spectral-analysis-and-wavelets"><i class="fa fa-check"></i><b>7.5.1</b> Power via Spectral Analysis and Wavelets</a></li>
<li class="chapter" data-level="7.5.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#extracting-signals"><i class="fa fa-check"></i><b>7.5.2</b> Extracting signals</a></li>
<li class="chapter" data-level="7.5.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#high-pass-low-pass-and-bandpass-filtering"><i class="fa fa-check"></i><b>7.5.3</b> High-pass, low-pass, and bandpass filtering</a></li>
<li class="chapter" data-level="7.5.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#interruption-duplicate-function-names"><i class="fa fa-check"></i><b>7.5.4</b> Interruption: Duplicate function names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>8</b> Acknowledgements</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning to Love dplR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="xdate" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> xDate<a href="xdate.html#xdate" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this document we cover basic crossdating techniques in <code>dplR</code> by deliberately
misdating one of the series in a well-dated set of ring widths and tracking
down the dating error. As with any dating enterprise, statistical
crossdating is merely a tool and users should always rely on the wood to
accurately date tree-ring data.</p>
<div id="introduction-3" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction<a href="xdate.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This gives an introduction of some of the crossdating functions in
dplR. This is essentially a rehashing of <span class="citation">(<a href="references.html#ref-Bunn2010">Bunn, 2010</a>)</span>. Please
cite that paper if you use dplR for crossdating. There is more detailed
information on all these functions in the help files.</p>
</div>
<div id="using-the-xdater-app" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Using the xDater app<a href="xdate.html#using-the-xdater-app" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below I’ll walk through using <code>dplR</code>’s crossdating functions on the command line. But I’ve also built a Shiny app for doing crossdating in an interactive graphical workflow that is one of the rare cases where an app and GUI are more useful than working in a script. This is definitely still in development and I plan on cleaning it up soon. It’s meant to mimic a lot of the look and feel of COFECHA since that’s what most folks are used to using. Here it is:</p>
<p><a href="https://viz.datascience.arizona.edu/xDateR/" target="_blank">viz.datascience.arizona.edu/xDateR/</a></p>
<p>While the xDater app is cool, the <a href="https://ringdater.shinyapps.io/launcher/" target="_blank">ringdater app</a> from David Reynolds, David Edge &amp; Bryan Black is also very handy Check that out too.</p>
</div>
<div id="crossdating-by-hand-in-dplr" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Crossdating by hand in dplR<a href="xdate.html#crossdating-by-hand-in-dplr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is a walk through of using <code>dplR</code> for crossdating on the command line.</p>
<div id="load-dplr-1" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Load dplR<a href="xdate.html#load-dplr-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will be using <code>dplR</code> in here. Load it:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="xdate.html#cb131-1" tabindex="-1"></a><span class="fu">library</span>(dplR)</span></code></pre></div>
<pre><code>## This is dplR version 1.7.6.
## dplR is part of openDendro https://opendendro.org.
## New users can visit https://opendendro.github.io/dplR-workshop/ to get started.</code></pre>
</div>
</div>
<div id="ruining-a-perfectly-good-data-set" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Ruining a Perfectly Good Data Set<a href="xdate.html#ruining-a-perfectly-good-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout this document we will use the on-board data set <code>co021</code> which gives the raw ring widths for Douglas fir <em>Pseudotsuga menziesii</em> at Mesa Verde in Colorado, USA. There are 35 series spanning 788 years.</p>
<p>We will rename the <code>co021</code> object to <code>dat</code> because we are going to mess around with it and it seems like good practice to rename it.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="xdate.html#cb133-1" tabindex="-1"></a><span class="fu">data</span>(co021)</span>
<span id="cb133-2"><a href="xdate.html#cb133-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> co021</span>
<span id="cb133-3"><a href="xdate.html#cb133-3" tabindex="-1"></a>dat.sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(dat)</span>
<span id="cb133-4"><a href="xdate.html#cb133-4" tabindex="-1"></a><span class="fu">mean</span>(dat.sum<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## [1] 564.9143</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="xdate.html#cb135-1" tabindex="-1"></a><span class="fu">mean</span>(dat.sum<span class="sc">$</span>stdev)</span></code></pre></div>
<pre><code>## [1] 0.3231714</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="xdate.html#cb137-1" tabindex="-1"></a><span class="fu">mean</span>(dat.sum<span class="sc">$</span>median)</span></code></pre></div>
<pre><code>## [1] 0.3211429</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="xdate.html#cb139-1" tabindex="-1"></a><span class="fu">mean</span>(dat.sum<span class="sc">$</span>ar1)</span></code></pre></div>
<pre><code>## [1] 0.6038</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="xdate.html#cb141-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">interseries.cor</span>(dat)[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.8477981</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="xdate.html#cb143-1" tabindex="-1"></a><span class="fu">plot</span>(dat, <span class="at">plot.type=</span><span class="st">&quot;spag&quot;</span>)</span></code></pre></div>
<p><img src="05-xdate_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>We can see that this is a beautifully sensitive collection with long segment lengths, high standard deviation (relative to ring widths), large first-order autocorrelation, and a high mean interseries correlation (<span class="math inline">\(\mathrm{r}\approx 0.84\)</span>).</p>
<p>To demonstrate how crossdating works in <code>dplR</code>, we will take this perfectly
lovely data set and corrupt the dating of one of the series. By doing so we
will be able to reenact one of the most common tasks of the dendrochronologist:
tracking down a misdated core. Here we will take a random series and remove
one of the years of growth. This simulates a missing ring in the series. We will
pick a random year in the core to give us a bit of a challenge in finding it.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="xdate.html#cb144-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4576</span>)</span>
<span id="cb144-2"><a href="xdate.html#cb144-2" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="fu">nrow</span>(dat), <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb144-3"><a href="xdate.html#cb144-3" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="fu">ncol</span>(dat), <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb144-4"><a href="xdate.html#cb144-4" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> dat[, j]</span>
<span id="cb144-5"><a href="xdate.html#cb144-5" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, tmp[<span class="sc">-</span>i])</span>
<span id="cb144-6"><a href="xdate.html#cb144-6" tabindex="-1"></a>dat[, j] <span class="ot">&lt;-</span> tmp</span></code></pre></div>
<p>We have now deleted the <span class="math inline">\(i^{th}\)</span> observation from the <span class="math inline">\(j^{th}\)</span> core while making sure that <code>dat</code> still has the appropriate numbers of rows. By sticking the NA at the
start of the series it is as if we missed a ring while measuring.</p>
</div>
<div id="series-correlation-by-segment" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Series Correlation by Segment<a href="xdate.html#series-correlation-by-segment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The primary function for looking the crossdating of a tree-ring data set in
dplR is <code>corr.rwl.seg</code>. This function looks at the correlation between
each tree-ring series and a master chronology built from all the other series
in the rwl object (leave-one-out principle). These correlations are calculated
on overlapping segments (e.g., 50-year segments would be overlapped by
25 years). By default, each of the series is filtered to remove low-frequency
variation prior to the correlation analysis. The help file has abundant
details. Here we will look at overlapping 60 year segments. A plot is
produced by default with <code>corr.rwl.seg</code>.</p>
<p>In the <code>corr.rwl.seg</code> plot, each segment of each series
is shown and colored by its correlation with the master. Each series is
represented by two courses of lines with the bottom course adhering to the
bottom axis timeline and the top course matching the upper axis timeline.
Segments are colored according to the strength of the correlation between
that segment and the master chronology. Blue correlates well (p-values less
or equal to the user-set critical value) while potential dating problems
are indicated by the red segments (p-values greater than the user-set
critical value). Green lines show segments that do not completely overlap
the time period and thus have no correlations calculated. Our modified data
set indicates one series with dating problems.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="xdate.html#cb145-1" tabindex="-1"></a>rwl<span class="fl">.60</span> <span class="ot">&lt;-</span> <span class="fu">corr.rwl.seg</span>(dat, <span class="at">seg.length=</span><span class="dv">60</span>, <span class="at">pcrit=</span><span class="fl">0.01</span>)</span></code></pre></div>
<p><img src="05-xdate_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In this figure, each 60-year segment of each series in the modified Mesa
Verde data set is shown and colored by its correlation with the master.
Our modified data set indicates one series with dating problems.</p>
</div>
<div id="individual-series-correlation" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Individual Series Correlation<a href="xdate.html#individual-series-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The low correlation between series <code>643114</code> and the master indicates a dating
problem. Now that we suspect a dating problem, let us take a closer look at this problem child. The figure above shows that series <code>643114</code> begins to lose correlation with the master at the end of the 19th century.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="xdate.html#cb146-1" tabindex="-1"></a>seg<span class="fl">.60</span> <span class="ot">&lt;-</span> <span class="fu">corr.series.seg</span>(<span class="at">rwl=</span>dat, <span class="at">series=</span><span class="st">&quot;643114&quot;</span>,</span>
<span id="cb146-2"><a href="xdate.html#cb146-2" tabindex="-1"></a>                          <span class="at">seg.length=</span><span class="dv">60</span>)</span></code></pre></div>
<p><img src="05-xdate_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Correlations between series <code>643114</code> and the master chronology are
shown with horizontal lines according (60-year segments lagged by 30 years).
A centered running correlation with a length of 60 years complements the
segment correlations. The critical level is shown with a dashed line.</p>
</div>
<div id="using-cross-correlation" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Using Cross Correlation<a href="xdate.html#using-cross-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This figure strongly indicates that the dating in the series <code>643114</code>
begins to deteriorate between 1850 and 1910. We can create a window (<code>win</code>) of years
and subset <code>dat</code> to the window if years we want to look at. Then we can look more closely at this time period and compute a cross-correlation function to look at lagged correlations to see if we can spot the dating problem.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="xdate.html#cb147-1" tabindex="-1"></a>win <span class="ot">&lt;-</span> <span class="dv">1800</span><span class="sc">:</span><span class="dv">1960</span></span>
<span id="cb147-2"><a href="xdate.html#cb147-2" tabindex="-1"></a>dat.yrs <span class="ot">&lt;-</span> <span class="fu">time</span>(dat)</span>
<span id="cb147-3"><a href="xdate.html#cb147-3" tabindex="-1"></a>dat.win <span class="ot">&lt;-</span> <span class="fu">subset</span>(dat,dat.yrs <span class="sc">%in%</span> win)</span>
<span id="cb147-4"><a href="xdate.html#cb147-4" tabindex="-1"></a>ccf<span class="fl">.30</span> <span class="ot">&lt;-</span> <span class="fu">ccf.series.rwl</span>(<span class="at">rwl=</span>dat.win, <span class="at">series=</span><span class="st">&quot;643114&quot;</span>, </span>
<span id="cb147-5"><a href="xdate.html#cb147-5" tabindex="-1"></a>                         <span class="at">seg.length=</span><span class="dv">30</span>, <span class="at">bin.floor=</span><span class="dv">50</span>)</span></code></pre></div>
<pre><code>## NB: With series.x = FALSE (default), negative lags indicate missing rings in series</code></pre>
<p><img src="05-xdate_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Cross-correlations between series <code>643114</code> and the master
chronology are shown for each segment (30-year segments lagged by 15 years).
The series correlates well at lag 0 until the 1865–1894 bin and then at
lag +1 prior to 1865.</p>
<p>This figure shows that 1865 to 1894 is the misdated part of
this series. The lag of +1 over a lag of 0 indicates that the series
<code>643114</code> is missing a ring as it better correlates to the master
chronology with a one-year offset.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>Using a smaller time window and shorter correlation segments we
can try to further isolate the switch from correlation at lag 0 to lag +1.
We will, of course, have to be very careful about using such short segments
for correlation and be ready to adjust our expectations accordingly.
Fortunately, in this case the trees are so exquisitely sensitive that we can
look at 20-year segments with some confidence.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="xdate.html#cb149-1" tabindex="-1"></a>win <span class="ot">&lt;-</span> <span class="dv">1850</span><span class="sc">:</span><span class="dv">1900</span></span>
<span id="cb149-2"><a href="xdate.html#cb149-2" tabindex="-1"></a>dat.win <span class="ot">&lt;-</span> <span class="fu">subset</span>(dat,dat.yrs <span class="sc">%in%</span> win)</span>
<span id="cb149-3"><a href="xdate.html#cb149-3" tabindex="-1"></a>ccf<span class="fl">.20</span> <span class="ot">&lt;-</span> <span class="fu">ccf.series.rwl</span>(<span class="at">rwl=</span>dat.win, <span class="at">series=</span><span class="st">&quot;643114&quot;</span>,</span>
<span id="cb149-4"><a href="xdate.html#cb149-4" tabindex="-1"></a>                         <span class="at">seg.length=</span><span class="dv">20</span>, <span class="at">bin.floor=</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## NB: With series.x = FALSE (default), negative lags indicate missing rings in series</code></pre>
<p><img src="05-xdate_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Cross-correlations between series `643114’ and the master
chronology at 20-year segments lagged by 10 years over 1850–1900.</p>
<p>By 1879 the correlation between series <code>643114</code> and the master is solidly at
lag +1. The 1870 to 1889 correlation is marginal
while the dating at 1880–1899 seems accurate (lag 0). This suggests that
the dating error is between 1879 and 1889.</p>
<p>At this point we could repeat the cross-correlation using even more carefuly to get even closer to the bad year if we wanted to. But at this point going and looking at the wood in that neighborhood would be the best option. Statistics only gets you so far.</p>
</div>
<div id="visual-crossdating" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Visual Crossdating<a href="xdate.html#visual-crossdating" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have strong inference now that series <code>643114</code> is misdated somewhere in a ten
year period around 1885. One final tool that <code>dplR</code> has is the ability to combine
the visual style of crossdating using skeleton plots with the statistical
approach of cross-correlation analysis. The <code>skel.ccf.plot</code> function does
just this. Here we make a skeleton plot from the 40-year period around the
suspected dating error (1885):</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="xdate.html#cb151-1" tabindex="-1"></a><span class="fu">xskel.ccf.plot</span>(<span class="at">rwl=</span>dat, <span class="at">series=</span><span class="st">&quot;643114&quot;</span>,</span>
<span id="cb151-2"><a href="xdate.html#cb151-2" tabindex="-1"></a>               <span class="at">win.start=</span><span class="dv">1865</span>, <span class="at">win.width=</span><span class="dv">40</span>)</span></code></pre></div>
<p><img src="05-xdate_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The top panel shows the normalized values for the master chronology
(bottom half) and the series <code>643114</code> (top half) in green. The values are
relative. Similarly, the black lines are a skeleton plot for the master and
series with the marker years annotated for the master on the bottom axis and
series <code>643114</code> on the top. The text at the top of the figure gives the
correlation between the series and master (green bars) as well as the percentage
of agreement between the skeleton bars for the series and master. The bottom
panels show cross correlations for the first half (left) and second half of
the time series. In this case, the early period (1865–1884) shows a mismatch
of the skeleton plot by one year coupled with a strong lag +1 correlation.</p>
<p>At this point the analyst would go to the wood and take a good look at the
core and see what they could find out. There are more heroic efforts that
one could go to to figure out exactly where the dating problem might be
but nothing ever takes the place of looking at the sample!</p>
</div>
<div id="conclusion-2" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Conclusion<a href="xdate.html#conclusion-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have strong inference now that series <code>643114</code> is misdated somewhere in a ten
year period around 1885. We have still not revealed whether this is correct
or not. Let us look at the values for <code>i</code> and <code>j</code> and see how we did:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="xdate.html#cb152-1" tabindex="-1"></a>j</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="xdate.html#cb154-1" tabindex="-1"></a><span class="fu">colnames</span>(co021)[j]</span></code></pre></div>
<pre><code>## [1] &quot;643143&quot;</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="xdate.html#cb156-1" tabindex="-1"></a>i</span></code></pre></div>
<pre><code>## [1] 557</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="xdate.html#cb158-1" tabindex="-1"></a><span class="fu">rownames</span>(co021)[i]</span></code></pre></div>
<pre><code>## [1] &quot;1732&quot;</code></pre>
<p>Our sleuthing indicated that our dating error was around the year 1885. In
fact, <code>i</code> was the year 1884.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>As of dplR version 1.60,
the cross correlations in <code>ccf.series.rwl</code> are calculated calling
<code>ccf(x=series, y=master, lag.max=lag.max, plot=FALSE)</code>. Note that
prior to dplR version 1.60, the <code>master</code> was set as <code>x</code> and
the <code>series</code> as <code>y</code>. This was changed to be more in line with
user expectations so that a missing ring in a series produces a positive
lag in the plot rather than a negative lag. This structure of this call
does put the plots at odds with Figure 3 in <span class="citation">(<a href="references.html#ref-Bunn2010">2010</a>)</span> which is
unfortunate.<a href="xdate.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-signal-free.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro-to-dendro-time-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
