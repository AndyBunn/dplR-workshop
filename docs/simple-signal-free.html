<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Simple Signal-Free | Learning to Love dplR</title>
  <meta name="description" content="Helful materials for dplR" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Simple Signal-Free | Learning to Love dplR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Helful materials for dplR" />
  <meta name="github-repo" content="OpenDendro/dplR-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Simple Signal-Free | Learning to Love dplR" />
  
  <meta name="twitter:description" content="Helful materials for dplR" />
  

<meta name="author" content="Andy Bunn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chronology-building.html"/>
<link rel="next" href="xdate.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
      // AGB add fold-hide
    if (classList[i] === 'fold-hide') {
        show = false;
      }
    }
    // AGB
    // if code block has been labeled with class `fold-hide`, hide the code on init!
//    var classList = $(this).attr('class').split(/\s+/);
//    for (var i = 0; i < classList.length; i++) {
//    if (classList[i] === 'fold-hide') {
//        show = false;
//      }
//    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = true;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  // AGB add fold-hide changed === to !== to default to showing code
  window.initializeCodeFolding("show" !== "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#before-starting"><i class="fa fa-check"></i><b>2.1</b> Before Starting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#getting-dplr"><i class="fa fa-check"></i><b>2.1.2</b> Getting dplR</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#layout"><i class="fa fa-check"></i><b>2.2</b> Layout</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#a-note-on-name-conflicts"><i class="fa fa-check"></i><b>2.2.1</b> A Note on Name Conflicts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.3</b> Getting Help with R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#citing-r-dplr-and-other-packages"><i class="fa fa-check"></i><b>2.4</b> Citing R, dplR, and Other Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-dplr.html"><a href="using-dplr.html"><i class="fa fa-check"></i><b>3</b> Using dplR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-dplr.html"><a href="using-dplr.html#what-is-covered"><i class="fa fa-check"></i><b>3.1</b> What is Covered</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="using-dplr.html"><a href="using-dplr.html#load-dplr"><i class="fa fa-check"></i><b>3.1.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-dplr.html"><a href="using-dplr.html#working-with-ring-width-data"><i class="fa fa-check"></i><b>3.2</b> Working with Ring-Width Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="using-dplr.html"><a href="using-dplr.html#reading-data"><i class="fa fa-check"></i><b>3.2.1</b> Reading Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-dplr.html"><a href="using-dplr.html#describing-and-plotting-ring-width-data"><i class="fa fa-check"></i><b>3.2.2</b> Describing and Plotting Ring-Width Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4" data-path="using-dplr.html"><a href="using-dplr.html#detrending"><i class="fa fa-check"></i><b>3.4</b> Detrending</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="using-dplr.html"><a href="using-dplr.html#common-detrending-methods"><i class="fa fa-check"></i><b>3.4.1</b> Common Detrending Methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="using-dplr.html"><a href="using-dplr.html#interactive-detrending"><i class="fa fa-check"></i><b>3.4.2</b> Interactive detrending</a></li>
<li class="chapter" data-level="3.4.3" data-path="using-dplr.html"><a href="using-dplr.html#other-detrending-methods"><i class="fa fa-check"></i><b>3.4.3</b> Other Detrending Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics-for-detrended-data"><i class="fa fa-check"></i><b>3.5</b> Descriptive Statistics for Detrended Data</a></li>
<li class="chapter" data-level="3.6" data-path="using-dplr.html"><a href="using-dplr.html#building-a-mean-value-chronology"><i class="fa fa-check"></i><b>3.6</b> Building a Mean-Value Chronology</a></li>
<li class="chapter" data-level="3.7" data-path="using-dplr.html"><a href="using-dplr.html#conclusion"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chronology-building.html"><a href="chronology-building.html"><i class="fa fa-check"></i><b>4</b> Chronology Building</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chronology-building.html"><a href="chronology-building.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chronology-building.html"><a href="chronology-building.html#data-sets"><i class="fa fa-check"></i><b>4.2</b> Data Sets</a></li>
<li class="chapter" data-level="4.3" data-path="chronology-building.html"><a href="chronology-building.html#traditional-chronology"><i class="fa fa-check"></i><b>4.3</b> Traditional Chronology</a></li>
<li class="chapter" data-level="4.4" data-path="chronology-building.html"><a href="chronology-building.html#using-a-sample-depth-cutoff"><i class="fa fa-check"></i><b>4.4</b> Using a Sample Depth Cutoff</a></li>
<li class="chapter" data-level="4.5" data-path="chronology-building.html"><a href="chronology-building.html#using-sss-as-a-cutoff"><i class="fa fa-check"></i><b>4.5</b> Using SSS as a Cutoff</a></li>
<li class="chapter" data-level="4.6" data-path="chronology-building.html"><a href="chronology-building.html#chronology-uncertainty"><i class="fa fa-check"></i><b>4.6</b> Chronology Uncertainty</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chronology-building.html"><a href="chronology-building.html#bootstrapping-confidence-intervals"><i class="fa fa-check"></i><b>4.6.1</b> Bootstrapping confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chronology-building.html"><a href="chronology-building.html#the-arstan-chronology"><i class="fa fa-check"></i><b>4.7</b> The ARSTAN Chronology</a></li>
<li class="chapter" data-level="4.8" data-path="chronology-building.html"><a href="chronology-building.html#stabalizing-the-variance"><i class="fa fa-check"></i><b>4.8</b> Stabalizing the Variance</a></li>
<li class="chapter" data-level="4.9" data-path="chronology-building.html"><a href="chronology-building.html#stripping-out-series-by-eps"><i class="fa fa-check"></i><b>4.9</b> Stripping out series by EPS</a></li>
<li class="chapter" data-level="4.10" data-path="chronology-building.html"><a href="chronology-building.html#conclusion-1"><i class="fa fa-check"></i><b>4.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simple-signal-free.html"><a href="simple-signal-free.html"><i class="fa fa-check"></i><b>5</b> Simple Signal-Free</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#making-the-simple-signal-free-chronology"><i class="fa fa-check"></i><b>5.4</b> Making the Simple Signal-Free Chronology</a></li>
<li class="chapter" data-level="5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#changing-the-detrending-method"><i class="fa fa-check"></i><b>5.5</b> Changing the Detrending Method</a></li>
<li class="chapter" data-level="5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#walk-through"><i class="fa fa-check"></i><b>5.6</b> Walk Through</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-1-iteration-0"><i class="fa fa-check"></i><b>5.6.1</b> Step 1 (Iteration 0)</a></li>
<li class="chapter" data-level="5.6.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-2-and-3-iteration-1"><i class="fa fa-check"></i><b>5.6.2</b> Steps 2 and 3 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-4-and-5-iteration-1"><i class="fa fa-check"></i><b>5.6.3</b> Steps 4 and 5 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-6-and-7-iteration-1"><i class="fa fa-check"></i><b>5.6.4</b> Step 6 and 7 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-8-begin-iterations"><i class="fa fa-check"></i><b>5.6.5</b> Step 8 (Begin Iterations)</a></li>
<li class="chapter" data-level="5.6.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#iterations-visualized"><i class="fa fa-check"></i><b>5.6.6</b> Iterations Visualized</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="simple-signal-free.html"><a href="simple-signal-free.html#final-thoughts"><i class="fa fa-check"></i><b>5.7</b> Final Thoughts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="xdate.html"><a href="xdate.html"><i class="fa fa-check"></i><b>6</b> xDate</a>
<ul>
<li class="chapter" data-level="6.1" data-path="xdate.html"><a href="xdate.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="xdate.html"><a href="xdate.html#using-the-xdater-app"><i class="fa fa-check"></i><b>6.2</b> Using the xDater app</a></li>
<li class="chapter" data-level="6.3" data-path="xdate.html"><a href="xdate.html#crossdating-by-hand-in-dplr"><i class="fa fa-check"></i><b>6.3</b> Crossdating by hand in dplR</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="xdate.html"><a href="xdate.html#load-dplr-1"><i class="fa fa-check"></i><b>6.3.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="xdate.html"><a href="xdate.html#ruining-a-perfectly-good-data-set"><i class="fa fa-check"></i><b>6.4</b> Ruining a Perfectly Good Data Set</a></li>
<li class="chapter" data-level="6.5" data-path="xdate.html"><a href="xdate.html#series-correlation-by-segment"><i class="fa fa-check"></i><b>6.5</b> Series Correlation by Segment</a></li>
<li class="chapter" data-level="6.6" data-path="xdate.html"><a href="xdate.html#individual-series-correlation"><i class="fa fa-check"></i><b>6.6</b> Individual Series Correlation</a></li>
<li class="chapter" data-level="6.7" data-path="xdate.html"><a href="xdate.html#using-cross-correlation"><i class="fa fa-check"></i><b>6.7</b> Using Cross Correlation</a></li>
<li class="chapter" data-level="6.8" data-path="xdate.html"><a href="xdate.html#visual-crossdating"><i class="fa fa-check"></i><b>6.8</b> Visual Crossdating</a></li>
<li class="chapter" data-level="6.9" data-path="xdate.html"><a href="xdate.html#conclusion-2"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html"><i class="fa fa-check"></i><b>7</b> Intro to dendro time-series</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#load-libraries"><i class="fa fa-check"></i><b>7.1.1</b> Load libraries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#data-sets-1"><i class="fa fa-check"></i><b>7.2</b> Data Sets</a></li>
<li class="chapter" data-level="7.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#smoothing"><i class="fa fa-check"></i><b>7.3</b> Smoothing</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#moving-running-average"><i class="fa fa-check"></i><b>7.3.1</b> Moving (running) average</a></li>
<li class="chapter" data-level="7.3.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#hanning"><i class="fa fa-check"></i><b>7.3.2</b> Hanning</a></li>
<li class="chapter" data-level="7.3.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#splines"><i class="fa fa-check"></i><b>7.3.3</b> Splines</a></li>
<li class="chapter" data-level="7.3.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#loess"><i class="fa fa-check"></i><b>7.3.4</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#characterizing-temporal-structure"><i class="fa fa-check"></i><b>7.4</b> Characterizing Temporal Structure</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#acf-and-pacf"><i class="fa fa-check"></i><b>7.4.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="7.4.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#ar-and-arma"><i class="fa fa-check"></i><b>7.4.2</b> AR and ARMA</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#frequency-domain"><i class="fa fa-check"></i><b>7.5</b> Frequency Domain</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#power-via-spectral-analysis-and-wavelets"><i class="fa fa-check"></i><b>7.5.1</b> Power via Spectral Analysis and Wavelets</a></li>
<li class="chapter" data-level="7.5.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#extracting-signals"><i class="fa fa-check"></i><b>7.5.2</b> Extracting signals</a></li>
<li class="chapter" data-level="7.5.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#high-pass-low-pass-and-bandpass-filtering"><i class="fa fa-check"></i><b>7.5.3</b> High-pass, low-pass, and bandpass filtering</a></li>
<li class="chapter" data-level="7.5.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#interruption-duplicate-function-names"><i class="fa fa-check"></i><b>7.5.4</b> Interruption: Duplicate function names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>8</b> Acknowledgements</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning to Love dplR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-signal-free" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Simple Signal-Free<a href="simple-signal-free.html#simple-signal-free" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="simple-signal-free.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is an initial draft that demonstrates how to build a simple signal-free chronology using the <code>ssf</code> function. Although this function is used to build chronologies, it is sufficiently different in its philosophy that it warrants its own chapter.</p>
<p>In most regards the <code>ssf</code> function follows the procedures laid out by <a href="https://crudata.uea.ac.uk/cru/people/melvin/Melvin2008/Melvin2008.pdf">Melvin and Briffa’s</a> classic 2008 paper in Dendrochronologia <span class="citation">(<a href="references.html#ref-melvin2008">Melvin &amp; Briffa, 2008</a>)</span>. This is not a treatise on the pros and cons of the signal-free approach but attempts to demonstrate how the <code>ssf</code> function in can be applied to ring-width data. This particular implementation of the signal-free approach is quite limited in its scope and users who want more control and options (such as RCS) should look to the CRUST program detailed in Melvin and Briffa <span class="citation">Melvin &amp; Briffa (<a href="references.html#ref-melvin2014b">2014b</a>)</span> available on <a href="https://github.com/ClimaticResearchUnit/CRUST">GitHub</a>.</p>
</div>
<div id="packages" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Packages<a href="simple-signal-free.html#packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here are the packages we will use.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="simple-signal-free.html#cb93-1" tabindex="-1"></a><span class="fu">library</span>(dplR)</span>
<span id="cb93-2"><a href="simple-signal-free.html#cb93-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb93-3"><a href="simple-signal-free.html#cb93-3" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb93-4"><a href="simple-signal-free.html#cb93-4" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb93-5"><a href="simple-signal-free.html#cb93-5" tabindex="-1"></a><span class="fu">library</span>(PNWColors)</span></code></pre></div>
</div>
<div id="data" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Data<a href="simple-signal-free.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will demonstrate <code>ssf</code> with Bristlecone pine ring widths from Campito Mountain which is included with <code>dplR</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="simple-signal-free.html#cb94-1" tabindex="-1"></a><span class="fu">data</span>(ca533)</span>
<span id="cb94-2"><a href="simple-signal-free.html#cb94-2" tabindex="-1"></a><span class="fu">class</span>(ca533)</span></code></pre></div>
<pre><code>## [1] &quot;rwl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="simple-signal-free.html#cb96-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> ca533</span></code></pre></div>
<p>Note the <code>class</code> of the object which is <code>rwl</code>. This means, simply, that the data are in a format that <code>dplR</code> understands. It has series in columns and years stored as <code>rownames</code>. Objects of class <code>rwl</code> can be summarized, plotted, used for detrending and so on.</p>
<p>Before we continue we will truncate the the sample depth to a minimum of five series. There is nothing magic about the sample depth but having five series is usually sufficient for having a robust chronology.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="simple-signal-free.html#cb97-1" tabindex="-1"></a>sampDepth <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="sc">!</span><span class="fu">is.na</span>(dat))</span>
<span id="cb97-2"><a href="simple-signal-free.html#cb97-2" tabindex="-1"></a>datTrunc <span class="ot">&lt;-</span> dat[sampDepth <span class="sc">&gt;</span> <span class="dv">4</span>,]</span></code></pre></div>
<p>We will now grab a few variables that will come in handy during this vigentte although they aren’t needed for a simple run of <code>ssf</code>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="simple-signal-free.html#cb98-1" tabindex="-1"></a>yrs <span class="ot">&lt;-</span> <span class="fu">time</span>(datTrunc)</span>
<span id="cb98-2"><a href="simple-signal-free.html#cb98-2" tabindex="-1"></a>medianSegLength <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">median</span>(<span class="fu">rwl.stats</span>(datTrunc)<span class="sc">$</span>year))</span>
<span id="cb98-3"><a href="simple-signal-free.html#cb98-3" tabindex="-1"></a>sampDepth <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="sc">!</span><span class="fu">is.na</span>(datTrunc))</span>
<span id="cb98-4"><a href="simple-signal-free.html#cb98-4" tabindex="-1"></a>normalizedSampleDepth <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sampDepth<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">max</span>(sampDepth<span class="dv">-1</span>))</span></code></pre></div>
<p>We will also set up some color palettes to use in plotting.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="simple-signal-free.html#cb99-1" tabindex="-1"></a><span class="co"># get some color palettes from Jake L&#39;s PNWColors</span></span>
<span id="cb99-2"><a href="simple-signal-free.html#cb99-2" tabindex="-1"></a>seriesColors <span class="ot">&lt;-</span> <span class="fu">pnw_palette</span>(<span class="at">name=</span><span class="st">&quot;Starfish&quot;</span>,<span class="at">n=</span><span class="fu">dim</span>(datTrunc)[<span class="dv">2</span>])</span>
<span id="cb99-3"><a href="simple-signal-free.html#cb99-3" tabindex="-1"></a>divColors <span class="ot">&lt;-</span> <span class="fu">pnw_palette</span>(<span class="st">&quot;Moth&quot;</span>,<span class="dv">5</span>)</span></code></pre></div>
<p>Throughout this document, we will make use of both <code>tidyverse</code> syntax and do much of the plotting in <code>ggplot</code>. E.g., here is a plot of all the ring widths that we will use.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="simple-signal-free.html#cb100-1" tabindex="-1"></a>rawRW <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, datTrunc) <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="simple-signal-free.html#cb100-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;series&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>) </span>
<span id="cb100-3"><a href="simple-signal-free.html#cb100-3" tabindex="-1"></a></span>
<span id="cb100-4"><a href="simple-signal-free.html#cb100-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>rawRW,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>series)) <span class="sc">+</span></span>
<span id="cb100-5"><a href="simple-signal-free.html#cb100-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb100-6"><a href="simple-signal-free.html#cb100-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> seriesColors) <span class="sc">+</span></span>
<span id="cb100-7"><a href="simple-signal-free.html#cb100-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;mm&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>,<span class="at">caption =</span> <span class="st">&quot;Raw Measurements&quot;</span>) <span class="sc">+</span></span>
<span id="cb100-8"><a href="simple-signal-free.html#cb100-8" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb100-9"><a href="simple-signal-free.html#cb100-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 11868 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="04-ssf_files/figure-html/first%20plot-1.png" width="672" /></p>
<p>NB <code>ggplot</code> is issuing a warning above telling us that there are quite a few <code>NA</code> values in the data. That is nothing to worry about – it is merely saying that the series have different start and end dates.</p>
</div>
<div id="making-the-simple-signal-free-chronology" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Making the Simple Signal-Free Chronology<a href="simple-signal-free.html#making-the-simple-signal-free-chronology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we create the simple signal-free chronology. In its most direct use, the <code>ssf</code> function outputs a <code>crn</code> object that has a simple onboard plotting method (<code>crn.plot</code>) which we will show rather than make a <code>ggplot</code> of the same data. Don’t worry, there is plenty of fancy plotting below.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="simple-signal-free.html#cb102-1" tabindex="-1"></a>ssfCrn <span class="ot">&lt;-</span> <span class="fu">ssf</span>(<span class="at">rwl =</span> datTrunc)</span></code></pre></div>
<pre><code>## Data read. First iteration done.
## Iteration: 2 Median Abs Diff: 0.00415 (12.05102% of threshold)
## Iteration: 3 Median Abs Diff: 0.00217 (23.0808% of threshold)
## Iteration: 4 Median Abs Diff: 0.00291 (17.19139% of threshold)
## Iteration: 5 Median Abs Diff: 0.00133 (37.67632% of threshold)
## Iteration: 6 Median Abs Diff: 0.001 (50.01761% of threshold)
## Iteration: 7 Median Abs Diff: 0.00076 (66.13473% of threshold)
## Iteration: 8 Median Abs Diff: 0.00066 (75.66402% of threshold)
## Iteration: 9 Median Abs Diff: 0.00055 (91.4003% of threshold)
## Iteration: 10 Median Abs Diff: 0.00047 (105.4908% of threshold)
## Simple Signal Free Chronology Complete
## ssf was called with these arguments
## Detrending method: AgeDepSpline
## nyrs: 
## pos.slope: FALSE
## maxIterations: 25
## madThreshold: 5e-04</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="simple-signal-free.html#cb104-1" tabindex="-1"></a><span class="fu">str</span>(ssfCrn) <span class="co"># note class of output object</span></span></code></pre></div>
<pre><code>## Classes &#39;crn&#39; and &#39;data.frame&#39;:  1007 obs. of  2 variables:
##  $ sfc       : num  1.219 1.487 0.836 0.664 0.57 ...
##  $ samp.depth: num  5 5 5 5 5 5 5 5 5 5 ...</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="simple-signal-free.html#cb106-1" tabindex="-1"></a><span class="fu">plot</span>(ssfCrn,<span class="at">add.spline=</span><span class="cn">TRUE</span>,<span class="at">nyrs=</span><span class="dv">50</span>,</span>
<span id="cb106-2"><a href="simple-signal-free.html#cb106-2" tabindex="-1"></a>     <span class="at">crn.line.col=</span>divColors[<span class="dv">3</span>],<span class="at">spline.line.col=</span>divColors[<span class="dv">1</span>],</span>
<span id="cb106-3"><a href="simple-signal-free.html#cb106-3" tabindex="-1"></a>     <span class="at">crn.lwd=</span><span class="fl">1.5</span>,<span class="at">spline.lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/do%20ssf-1.png" width="672" /></p>
<p>In the above, the signal-free chronology is shown with a 50-year smoothing spline added for visualization of low-frequency variability. The algorithm converged after 10 iterations.</p>
</div>
<div id="changing-the-detrending-method" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Changing the Detrending Method<a href="simple-signal-free.html#changing-the-detrending-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The help file for <code>ssf</code> gives more information on possible arguments. See <code>?ssf</code> for details. By default the function uses an age-depended spline (<code>dplR</code> function <code>ads</code>) for detrending. But we can also use a cubic smoothing spline (<code>caps</code>). We will arbitrarily set the stiffness to the median segment length of the input data, which is 627. Whether this is a wise choice or not is debatable.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="simple-signal-free.html#cb107-1" tabindex="-1"></a>ssfCrn2 <span class="ot">&lt;-</span> <span class="fu">ssf</span>(<span class="at">rwl =</span> datTrunc,<span class="at">method=</span><span class="st">&quot;Spline&quot;</span>,<span class="at">nyrs=</span>medianSegLength)</span></code></pre></div>
<pre><code>## Data read. First iteration done.
## Iteration: 2 Median Abs Diff: 0.00212 (23.57048% of threshold)
## Iteration: 3 Median Abs Diff: 0.00185 (26.97214% of threshold)
## Iteration: 4 Median Abs Diff: 0.0017 (29.3594% of threshold)
## Iteration: 5 Median Abs Diff: 0.00153 (32.62844% of threshold)
## Iteration: 6 Median Abs Diff: 0.00144 (34.64722% of threshold)
## Iteration: 7 Median Abs Diff: 0.00138 (36.31909% of threshold)
## Iteration: 8 Median Abs Diff: 0.00125 (39.92379% of threshold)
## Iteration: 9 Median Abs Diff: 0.00121 (41.24506% of threshold)
## Iteration: 10 Median Abs Diff: 0.00114 (43.97276% of threshold)
## Iteration: 11 Median Abs Diff: 0.00106 (47.16853% of threshold)
## Iteration: 12 Median Abs Diff: 0.00103 (48.49743% of threshold)
## Iteration: 13 Median Abs Diff: 0.00098 (50.95603% of threshold)
## Iteration: 14 Median Abs Diff: 0.00095 (52.74914% of threshold)
## Iteration: 15 Median Abs Diff: 0.00089 (55.93075% of threshold)
## Iteration: 16 Median Abs Diff: 0.00086 (58.06452% of threshold)
## Iteration: 17 Median Abs Diff: 0.00081 (61.74206% of threshold)
## Iteration: 18 Median Abs Diff: 0.00074 (67.718% of threshold)
## Iteration: 19 Median Abs Diff: 0.00067 (74.47746% of threshold)
## Iteration: 20 Median Abs Diff: 0.00064 (77.98195% of threshold)
## Iteration: 21 Median Abs Diff: 6e-04 (82.93416% of threshold)
## Iteration: 22 Median Abs Diff: 0.00057 (88.15344% of threshold)
## Iteration: 23 Median Abs Diff: 0.00053 (94.85591% of threshold)
## Iteration: 24 Median Abs Diff: 0.00048 (104.0267% of threshold)
## Simple Signal Free Chronology Complete
## ssf was called with these arguments
## Detrending method: Spline
## nyrs: 627
## maxIterations: 25
## madThreshold: 5e-04</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="simple-signal-free.html#cb109-1" tabindex="-1"></a><span class="fu">plot</span>(ssfCrn2,<span class="at">add.spline=</span><span class="cn">TRUE</span>,<span class="at">nyrs=</span><span class="dv">50</span>,</span>
<span id="cb109-2"><a href="simple-signal-free.html#cb109-2" tabindex="-1"></a>     <span class="at">crn.line.col=</span>divColors[<span class="dv">3</span>],<span class="at">spline.line.col=</span>divColors[<span class="dv">1</span>],</span>
<span id="cb109-3"><a href="simple-signal-free.html#cb109-3" tabindex="-1"></a>     <span class="at">crn.lwd=</span><span class="fl">1.5</span>,<span class="at">spline.lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/do%20ssf%20with%20caps-1.png" width="672" /></p>
<p>Note that the algorithm takes more iterations to converge but produces a qualitatively similar chronology.</p>
</div>
<div id="walk-through" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Walk Through<a href="simple-signal-free.html#walk-through" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To demonstrate how the signal free process works we can redo the chronology, this time returning information on the process at each iteration. Note the change in the structure (<code>str</code>) of the output object.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="simple-signal-free.html#cb110-1" tabindex="-1"></a>ssfCrn <span class="ot">&lt;-</span> <span class="fu">ssf</span>(<span class="at">rwl =</span> datTrunc,<span class="at">return.info =</span> <span class="cn">TRUE</span>,<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-2"><a href="simple-signal-free.html#cb110-2" tabindex="-1"></a><span class="fu">str</span>(ssfCrn)</span></code></pre></div>
<pre><code>## Classes &#39;crn&#39; and &#39;data.frame&#39;:  0 obs. of  11 variables:
##  $ infoList                :List of 5
##   ..$ method       : chr &quot;AgeDepSpline&quot;
##   ..$ nyrs         : NULL
##   ..$ pos.slope    : logi FALSE
##   ..$ maxIterations: num 25
##   ..$ madThreshold : num 5e-04
##  $ iter0Crn                :Classes &#39;crn&#39; and &#39;data.frame&#39;:  1007 obs. of  2 variables:
##   ..$ std       : num  1.288 1.557 0.884 0.703 0.6 ...
##   ..$ samp.depth: num  5 5 5 5 5 5 5 5 5 5 ...
##  $ ssfCrn                  :Classes &#39;crn&#39; and &#39;data.frame&#39;:  1007 obs. of  2 variables:
##   ..$ sfc       : num  1.219 1.487 0.836 0.664 0.57 ...
##   ..$ samp.depth: num  5 5 5 5 5 5 5 5 5 5 ...
##  $ sfRW_Array              : num [1:1007, 1:34, 1:10] NA NA NA NA NA NA NA NA NA NA ...
##  $ sfRWRescaled_Array      : num [1:1007, 1:34, 1:10] NA NA NA NA NA NA NA NA NA NA ...
##  $ sfRWRescaledCurves_Array: num [1:1007, 1:34, 1:10] NA NA NA NA NA NA NA NA NA NA ...
##  $ sfRWI_Array             : num [1:1007, 1:34, 1:10] NA NA NA NA NA NA NA NA NA NA ...
##  $ sfCrn_Mat               : num [1:1007, 1:10] 1.264 1.394 0.849 0.666 0.568 ...
##  $ hfCrn_Mat               : num [1:1007, 1:25] 0.313 0.443 -0.102 -0.285 -0.383 ...
##  $ hfCrnResids_Mat         : num [1:1007, 1:9] -0.02912 0.07009 -0.02075 -0.00941 -0.02138 ...
##  $ MAD_Vec                 : num  0.00415 0.00217 0.00291 0.00133 0.001 ...
##  - attr(*, &quot;comment&quot;)= chr &quot;ssfLong&quot;</code></pre>
<p>The <code>ssfCrn</code> object is now a list with information on all the iterations that algorithm has run through. We can save these to their own objects for easier access.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="simple-signal-free.html#cb112-1" tabindex="-1"></a>sfRW_Array <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>sfRW_Array</span>
<span id="cb112-2"><a href="simple-signal-free.html#cb112-2" tabindex="-1"></a>sfRWRescaled_Array <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>sfRWRescaled_Array</span>
<span id="cb112-3"><a href="simple-signal-free.html#cb112-3" tabindex="-1"></a>sfRWRescaledCurves_Array <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>sfRWRescaledCurves_Array</span>
<span id="cb112-4"><a href="simple-signal-free.html#cb112-4" tabindex="-1"></a>sfRWI_Array <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>sfRWI_Array</span>
<span id="cb112-5"><a href="simple-signal-free.html#cb112-5" tabindex="-1"></a>sfCrn_Mat <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>sfCrn_Mat</span>
<span id="cb112-6"><a href="simple-signal-free.html#cb112-6" tabindex="-1"></a>hfCrn_Mat <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>hfCrn_Mat</span>
<span id="cb112-7"><a href="simple-signal-free.html#cb112-7" tabindex="-1"></a>hfCrnResids_Mat <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>hfCrnResids_Mat</span>
<span id="cb112-8"><a href="simple-signal-free.html#cb112-8" tabindex="-1"></a>MAD_Vec <span class="ot">&lt;-</span> ssfCrn<span class="sc">$</span>MAD_Vec</span></code></pre></div>
<div id="step-1-iteration-0" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Step 1 (Iteration 0)<a href="simple-signal-free.html#step-1-iteration-0" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the initial, naive chronology at iteration zero.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="simple-signal-free.html#cb113-1" tabindex="-1"></a><span class="fu">plot</span>(ssfCrn<span class="sc">$</span>iter0Crn,<span class="at">add.spline=</span><span class="cn">TRUE</span>,<span class="at">nyrs=</span><span class="dv">50</span>,</span>
<span id="cb113-2"><a href="simple-signal-free.html#cb113-2" tabindex="-1"></a>     <span class="at">crn.line.col=</span>divColors[<span class="dv">4</span>],<span class="at">spline.line.col=</span>divColors[<span class="dv">2</span>],</span>
<span id="cb113-3"><a href="simple-signal-free.html#cb113-3" tabindex="-1"></a>     <span class="at">crn.lwd=</span><span class="fl">1.5</span>,<span class="at">spline.lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/init%20crn-1.png" width="672" /></p>
<p>We use this as a starting point and begin the iterations.</p>
</div>
<div id="steps-2-and-3-iteration-1" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Steps 2 and 3 (Iteration 1)<a href="simple-signal-free.html#steps-2-and-3-iteration-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The algorithm first creates signal-free measurements for each series. At the first iteration these are the measurements divided by the initial chronology.</p>
<p>These signal-free measurements are output in <code>sfRW_Array</code> which is an array of years by series, by iteration. The signal-free measurements are then rescaled to have the original mean of each series.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb114-1"><a href="simple-signal-free.html#cb114-1" tabindex="-1"></a>sfRWRescaled <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, sfRWRescaled_Array[,,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="simple-signal-free.html#cb114-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;series&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>)</span>
<span id="cb114-3"><a href="simple-signal-free.html#cb114-3" tabindex="-1"></a></span>
<span id="cb114-4"><a href="simple-signal-free.html#cb114-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sfRWRescaled,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>series)) <span class="sc">+</span></span>
<span id="cb114-5"><a href="simple-signal-free.html#cb114-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb114-6"><a href="simple-signal-free.html#cb114-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> seriesColors) <span class="sc">+</span></span>
<span id="cb114-7"><a href="simple-signal-free.html#cb114-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;Rescaled Signal Free Measurements at Iteration 1&quot;</span>,</span>
<span id="cb114-8"><a href="simple-signal-free.html#cb114-8" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;mm&quot;</span>, <span class="at">x=</span><span class="st">&quot;Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb114-9"><a href="simple-signal-free.html#cb114-9" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb114-10"><a href="simple-signal-free.html#cb114-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 11868 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="04-ssf_files/figure-html/sf%20resc%20iter1-1.png" width="672" /></p>
</div>
<div id="steps-4-and-5-iteration-1" class="section level3 hasAnchor" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Steps 4 and 5 (Iteration 1)<a href="simple-signal-free.html#steps-4-and-5-iteration-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In these steps the algorithm first looks for any places in the rescaled ring width array that have a sample depth of one and replaces the individual signal-free measurements values with the original measurement values. Then the curve fitting is repeated giving the detrending curves for iteration one.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb116-1"><a href="simple-signal-free.html#cb116-1" tabindex="-1"></a>sfRWRescaledCurves <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, sfRWRescaledCurves_Array[,,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="simple-signal-free.html#cb116-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;series&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>) </span>
<span id="cb116-3"><a href="simple-signal-free.html#cb116-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sfRWRescaledCurves,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>series)) <span class="sc">+</span></span>
<span id="cb116-4"><a href="simple-signal-free.html#cb116-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.75</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-5"><a href="simple-signal-free.html#cb116-5" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> seriesColors) <span class="sc">+</span></span>
<span id="cb116-6"><a href="simple-signal-free.html#cb116-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;Detrending Curves at Iteration 1&quot;</span>,</span>
<span id="cb116-7"><a href="simple-signal-free.html#cb116-7" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;mm&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-8"><a href="simple-signal-free.html#cb116-8" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb116-9"><a href="simple-signal-free.html#cb116-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## Warning: Removed 11868 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="04-ssf_files/figure-html/sf%20curve%20iter1-1.png" width="672" /></p>
</div>
<div id="step-6-and-7-iteration-1" class="section level3 hasAnchor" number="5.6.4">
<h3><span class="header-section-number">5.6.4</span> Step 6 and 7 (Iteration 1)<a href="simple-signal-free.html#step-6-and-7-iteration-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the detrending curves above, we make the first signal-free ring-width indices by dividing the original measurements by the curves above.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb119-1"><a href="simple-signal-free.html#cb119-1" tabindex="-1"></a>sfRWI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, sfRWI_Array[,,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb119-2"><a href="simple-signal-free.html#cb119-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;series&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>) </span>
<span id="cb119-3"><a href="simple-signal-free.html#cb119-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sfRWI,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>series)) <span class="sc">+</span></span>
<span id="cb119-4"><a href="simple-signal-free.html#cb119-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-5"><a href="simple-signal-free.html#cb119-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-6"><a href="simple-signal-free.html#cb119-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> seriesColors) <span class="sc">+</span></span>
<span id="cb119-7"><a href="simple-signal-free.html#cb119-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;Signal Free Indices at Iteration 1&quot;</span>,</span>
<span id="cb119-8"><a href="simple-signal-free.html#cb119-8" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;RWI&quot;</span>,</span>
<span id="cb119-9"><a href="simple-signal-free.html#cb119-9" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-10"><a href="simple-signal-free.html#cb119-10" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb119-11"><a href="simple-signal-free.html#cb119-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 11868 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="04-ssf_files/figure-html/sf%20rwi%20iter1-1.png" width="672" /></p>
<p>With these ring width indices we can make the signal-free chronology for the first iteration which we will plot with a 50-year smoothing spline.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb121-1"><a href="simple-signal-free.html#cb121-1" tabindex="-1"></a>sfCrn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, </span>
<span id="cb121-2"><a href="simple-signal-free.html#cb121-2" tabindex="-1"></a>                    <span class="at">msmt =</span> sfCrn_Mat[,<span class="dv">1</span>], </span>
<span id="cb121-3"><a href="simple-signal-free.html#cb121-3" tabindex="-1"></a>                    <span class="at">msmstSm=</span> <span class="fu">caps</span>(sfCrn_Mat[,<span class="dv">1</span>],<span class="at">nyrs =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="simple-signal-free.html#cb121-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;series&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>) </span>
<span id="cb121-5"><a href="simple-signal-free.html#cb121-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sfCrn,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,</span>
<span id="cb121-6"><a href="simple-signal-free.html#cb121-6" tabindex="-1"></a>                                <span class="at">color=</span>series,</span>
<span id="cb121-7"><a href="simple-signal-free.html#cb121-7" tabindex="-1"></a>                                <span class="at">size=</span>series,</span>
<span id="cb121-8"><a href="simple-signal-free.html#cb121-8" tabindex="-1"></a>                                <span class="at">alpha=</span>series)) <span class="sc">+</span></span>
<span id="cb121-9"><a href="simple-signal-free.html#cb121-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb121-10"><a href="simple-signal-free.html#cb121-10" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb121-11"><a href="simple-signal-free.html#cb121-11" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> divColors[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)]) <span class="sc">+</span></span>
<span id="cb121-12"><a href="simple-signal-free.html#cb121-12" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb121-13"><a href="simple-signal-free.html#cb121-13" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb121-14"><a href="simple-signal-free.html#cb121-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;Signal Free Chronology at Iteration 1&quot;</span>,</span>
<span id="cb121-15"><a href="simple-signal-free.html#cb121-15" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb121-16"><a href="simple-signal-free.html#cb121-16" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb121-17"><a href="simple-signal-free.html#cb121-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/sf%20chron%20iter1-1.png" width="672" /></p>
</div>
<div id="step-8-begin-iterations" class="section level3 hasAnchor" number="5.6.5">
<h3><span class="header-section-number">5.6.5</span> Step 8 (Begin Iterations)<a href="simple-signal-free.html#step-8-begin-iterations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we begin iterating through the steps above until the stopping criteria is met or until the maximum number of iterations is reached. Here we show how the chronology changes from iteration one to iteration two and how the high-pass filtering is used to calculate the median absolute difference (MAD) used as the stopping criteria.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb122-1"><a href="simple-signal-free.html#cb122-1" tabindex="-1"></a>sfCrn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, <span class="at">msmt =</span> sfCrn_Mat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="simple-signal-free.html#cb122-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Iteration 1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span>,<span class="st">`</span><span class="at">Iteration 2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="simple-signal-free.html#cb122-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>)</span>
<span id="cb122-4"><a href="simple-signal-free.html#cb122-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>sfCrn,</span>
<span id="cb122-5"><a href="simple-signal-free.html#cb122-5" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>Iteration,</span>
<span id="cb122-6"><a href="simple-signal-free.html#cb122-6" tabindex="-1"></a>                           <span class="at">linetype=</span>Iteration,</span>
<span id="cb122-7"><a href="simple-signal-free.html#cb122-7" tabindex="-1"></a>                           <span class="at">alpha=</span>Iteration)) <span class="sc">+</span></span>
<span id="cb122-8"><a href="simple-signal-free.html#cb122-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-9"><a href="simple-signal-free.html#cb122-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb122-10"><a href="simple-signal-free.html#cb122-10" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> divColors[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)]) <span class="sc">+</span></span>
<span id="cb122-11"><a href="simple-signal-free.html#cb122-11" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb122-12"><a href="simple-signal-free.html#cb122-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span><span class="st">&quot;Signal Free Chronology at Iteration 1 and 2&quot;</span>,</span>
<span id="cb122-13"><a href="simple-signal-free.html#cb122-13" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-14"><a href="simple-signal-free.html#cb122-14" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb122-15"><a href="simple-signal-free.html#cb122-15" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb122-16"><a href="simple-signal-free.html#cb122-16" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb122-17"><a href="simple-signal-free.html#cb122-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb122-18"><a href="simple-signal-free.html#cb122-18" tabindex="-1"></a></span>
<span id="cb122-19"><a href="simple-signal-free.html#cb122-19" tabindex="-1"></a>sfCrnCompare <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sfCrn_Mat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb122-20"><a href="simple-signal-free.html#cb122-20" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>sfCrnCompare, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>X1,<span class="at">y=</span>X2)) <span class="sc">+</span> </span>
<span id="cb122-21"><a href="simple-signal-free.html#cb122-21" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">color=</span>divColors[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb122-22"><a href="simple-signal-free.html#cb122-22" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb122-23"><a href="simple-signal-free.html#cb122-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">element_blank</span>(), <span class="at">x=</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb122-24"><a href="simple-signal-free.html#cb122-24" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb122-25"><a href="simple-signal-free.html#cb122-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb122-26"><a href="simple-signal-free.html#cb122-26" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb122-27"><a href="simple-signal-free.html#cb122-27" tabindex="-1"></a>p2 <span class="ot">&lt;-</span>  <span class="fu">ggMarginal</span>(p2, <span class="at">type=</span><span class="st">&quot;boxplot&quot;</span>, <span class="at">size=</span><span class="dv">6</span>,</span>
<span id="cb122-28"><a href="simple-signal-free.html#cb122-28" tabindex="-1"></a>                  <span class="at">xparams =</span> <span class="fu">list</span>(<span class="at">fill =</span> divColors[<span class="dv">4</span>],</span>
<span id="cb122-29"><a href="simple-signal-free.html#cb122-29" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>),</span>
<span id="cb122-30"><a href="simple-signal-free.html#cb122-30" tabindex="-1"></a>                  <span class="at">yparams =</span> <span class="fu">list</span>(<span class="at">fill =</span> divColors[<span class="dv">2</span>],</span>
<span id="cb122-31"><a href="simple-signal-free.html#cb122-31" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>))</span>
<span id="cb122-32"><a href="simple-signal-free.html#cb122-32" tabindex="-1"></a></span>
<span id="cb122-33"><a href="simple-signal-free.html#cb122-33" tabindex="-1"></a><span class="fu">ggdraw</span>(p1) <span class="sc">+</span></span>
<span id="cb122-34"><a href="simple-signal-free.html#cb122-34" tabindex="-1"></a>  <span class="fu">draw_plot</span>(<span class="at">plot =</span> p2, </span>
<span id="cb122-35"><a href="simple-signal-free.html#cb122-35" tabindex="-1"></a>            <span class="at">x =</span> .<span class="dv">05</span>, <span class="at">y =</span> .<span class="dv">5</span>, </span>
<span id="cb122-36"><a href="simple-signal-free.html#cb122-36" tabindex="-1"></a>            <span class="at">width =</span> .<span class="dv">5</span>, <span class="at">height =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/sf%20chron%20iters-1.png" width="672" /></p>
<p>These chronologies are quite similar but differ at higher RWI values.</p>
<p>The median absolute error between these two chronologies is calculated on the high frequency component which is calculated using a cubic smoothing spline with stiffness set to the median segment length.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb123-1"><a href="simple-signal-free.html#cb123-1" tabindex="-1"></a>highFreqCrn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, </span>
<span id="cb123-2"><a href="simple-signal-free.html#cb123-2" tabindex="-1"></a>                          <span class="at">highFreqIter1 =</span> hfCrn_Mat[,<span class="dv">1</span>],</span>
<span id="cb123-3"><a href="simple-signal-free.html#cb123-3" tabindex="-1"></a>                          <span class="at">highFreqIter2 =</span> hfCrn_Mat[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb123-4"><a href="simple-signal-free.html#cb123-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Iteration 1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span>,<span class="st">`</span><span class="at">Iteration 2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-5"><a href="simple-signal-free.html#cb123-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;Iteration&quot;</span>, </span>
<span id="cb123-6"><a href="simple-signal-free.html#cb123-6" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>)</span>
<span id="cb123-7"><a href="simple-signal-free.html#cb123-7" tabindex="-1"></a><span class="co"># plot the high freq chrons</span></span>
<span id="cb123-8"><a href="simple-signal-free.html#cb123-8" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>highFreqCrn,</span>
<span id="cb123-9"><a href="simple-signal-free.html#cb123-9" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>Iteration,</span>
<span id="cb123-10"><a href="simple-signal-free.html#cb123-10" tabindex="-1"></a>                           <span class="at">linetype=</span>Iteration,</span>
<span id="cb123-11"><a href="simple-signal-free.html#cb123-11" tabindex="-1"></a>                           <span class="at">alpha=</span>Iteration)) <span class="sc">+</span></span>
<span id="cb123-12"><a href="simple-signal-free.html#cb123-12" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-13"><a href="simple-signal-free.html#cb123-13" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb123-14"><a href="simple-signal-free.html#cb123-14" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> divColors[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)]) <span class="sc">+</span></span>
<span id="cb123-15"><a href="simple-signal-free.html#cb123-15" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb123-16"><a href="simple-signal-free.html#cb123-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;High Freq Chronology at Iteration 1 and 2&quot;</span>,</span>
<span id="cb123-17"><a href="simple-signal-free.html#cb123-17" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-18"><a href="simple-signal-free.html#cb123-18" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb123-19"><a href="simple-signal-free.html#cb123-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb123-20"><a href="simple-signal-free.html#cb123-20" tabindex="-1"></a></span>
<span id="cb123-21"><a href="simple-signal-free.html#cb123-21" tabindex="-1"></a><span class="co"># plot the high freq chron difference (stored in hfCrnResids_Mat)</span></span>
<span id="cb123-22"><a href="simple-signal-free.html#cb123-22" tabindex="-1"></a>highFreqDiff <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs=</span>yrs, </span>
<span id="cb123-23"><a href="simple-signal-free.html#cb123-23" tabindex="-1"></a>                           <span class="at">difference =</span>  hfCrnResids_Mat[,<span class="dv">1</span>])</span>
<span id="cb123-24"><a href="simple-signal-free.html#cb123-24" tabindex="-1"></a></span>
<span id="cb123-25"><a href="simple-signal-free.html#cb123-25" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(highFreqDiff,<span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>difference)) <span class="sc">+</span></span>
<span id="cb123-26"><a href="simple-signal-free.html#cb123-26" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-27"><a href="simple-signal-free.html#cb123-27" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span>divColors[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb123-28"><a href="simple-signal-free.html#cb123-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;RWI Difference&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>,</span>
<span id="cb123-29"><a href="simple-signal-free.html#cb123-29" tabindex="-1"></a>       <span class="at">caption=</span><span class="fu">paste0</span>(<span class="st">&quot;Iteration 1v2 MAD &quot;</span>, <span class="fu">round</span>(MAD_Vec[<span class="dv">1</span>],<span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb123-30"><a href="simple-signal-free.html#cb123-30" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb123-31"><a href="simple-signal-free.html#cb123-31" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb123-32"><a href="simple-signal-free.html#cb123-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb123-33"><a href="simple-signal-free.html#cb123-33" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb123-34"><a href="simple-signal-free.html#cb123-34" tabindex="-1"></a></span>
<span id="cb123-35"><a href="simple-signal-free.html#cb123-35" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2,<span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/hf-1.png" width="672" /></p>
<p>In the lower plot it’s clear that the difference in the chronologies is highest at the start and end. We calculate the median absolute difference using the normalized sample depth as:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="simple-signal-free.html#cb124-1" tabindex="-1"></a><span class="fu">median</span>(<span class="fu">abs</span>(hfCrn_Mat[,<span class="dv">2</span>]<span class="sc">*</span>normalizedSampleDepth <span class="sc">-</span> hfCrn_Mat[,<span class="dv">1</span>]<span class="sc">*</span>normalizedSampleDepth))</span></code></pre></div>
<pre><code>## [1] 0.004149028</code></pre>
<p>This is also returned in <code>MAD_Vec</code>.</p>
<p>Since this value is greater than the the stopping criteria of 5e-04, the algorithm continues to iterate until the difference is below the threshold or the maximum number of iterations is reached. Here is the difference plot between iterations nine and ten.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb126-1"><a href="simple-signal-free.html#cb126-1" tabindex="-1"></a>highFreqDiff <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs=</span>yrs, </span>
<span id="cb126-2"><a href="simple-signal-free.html#cb126-2" tabindex="-1"></a>                           <span class="at">difference =</span>  hfCrnResids_Mat[,<span class="dv">9</span>])</span>
<span id="cb126-3"><a href="simple-signal-free.html#cb126-3" tabindex="-1"></a></span>
<span id="cb126-4"><a href="simple-signal-free.html#cb126-4" tabindex="-1"></a><span class="fu">ggplot</span>(highFreqDiff,<span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>difference)) <span class="sc">+</span></span>
<span id="cb126-5"><a href="simple-signal-free.html#cb126-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-6"><a href="simple-signal-free.html#cb126-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span>divColors[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb126-7"><a href="simple-signal-free.html#cb126-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;RWI Difference&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>,</span>
<span id="cb126-8"><a href="simple-signal-free.html#cb126-8" tabindex="-1"></a>       <span class="at">caption=</span><span class="fu">paste0</span>(<span class="st">&quot;Iteration 9v10 MAD &quot;</span>, <span class="fu">round</span>(MAD_Vec[<span class="dv">9</span>],<span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb126-9"><a href="simple-signal-free.html#cb126-9" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb126-10"><a href="simple-signal-free.html#cb126-10" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb126-11"><a href="simple-signal-free.html#cb126-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb126-12"><a href="simple-signal-free.html#cb126-12" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/highFreqDiff-1.png" width="672" /></p>
</div>
<div id="iterations-visualized" class="section level3 hasAnchor" number="5.6.6">
<h3><span class="header-section-number">5.6.6</span> Iterations Visualized<a href="simple-signal-free.html#iterations-visualized" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can see the progression of the output chronology relatively clearly by plotting the 50-year smoothing spline of the final chronology for each iteration.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb127-1"><a href="simple-signal-free.html#cb127-1" tabindex="-1"></a>crnCols <span class="ot">&lt;-</span> <span class="fu">pnw_palette</span>(<span class="at">name=</span><span class="st">&quot;Starfish&quot;</span>,<span class="at">n=</span><span class="fu">dim</span>(sfCrn_Mat)[<span class="dv">2</span>])</span>
<span id="cb127-2"><a href="simple-signal-free.html#cb127-2" tabindex="-1"></a></span>
<span id="cb127-3"><a href="simple-signal-free.html#cb127-3" tabindex="-1"></a><span class="co"># smooth chrons</span></span>
<span id="cb127-4"><a href="simple-signal-free.html#cb127-4" tabindex="-1"></a>sfCrnSm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs, </span>
<span id="cb127-5"><a href="simple-signal-free.html#cb127-5" tabindex="-1"></a>                      <span class="at">msmt =</span> <span class="fu">apply</span>(sfCrn_Mat,<span class="dv">2</span>,caps,<span class="at">nyrs=</span><span class="dv">50</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb127-6"><a href="simple-signal-free.html#cb127-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>)</span>
<span id="cb127-7"><a href="simple-signal-free.html#cb127-7" tabindex="-1"></a></span>
<span id="cb127-8"><a href="simple-signal-free.html#cb127-8" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb127-9"><a href="simple-signal-free.html#cb127-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-10"><a href="simple-signal-free.html#cb127-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>sfCrnSm,</span>
<span id="cb127-11"><a href="simple-signal-free.html#cb127-11" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span><span class="fu">factor</span>(Iteration)),</span>
<span id="cb127-12"><a href="simple-signal-free.html#cb127-12" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.75</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb127-13"><a href="simple-signal-free.html#cb127-13" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> crnCols) <span class="sc">+</span></span>
<span id="cb127-14"><a href="simple-signal-free.html#cb127-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">&quot;Signal Free Chronology&quot;</span>,</span>
<span id="cb127-15"><a href="simple-signal-free.html#cb127-15" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Years&quot;</span>,<span class="at">y=</span><span class="st">&quot;RWI&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-16"><a href="simple-signal-free.html#cb127-16" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb127-17"><a href="simple-signal-free.html#cb127-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb127-18"><a href="simple-signal-free.html#cb127-18" tabindex="-1"></a></span>
<span id="cb127-19"><a href="simple-signal-free.html#cb127-19" tabindex="-1"></a>MADdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Iteration =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(sfCrn_Mat)[<span class="dv">2</span>],</span>
<span id="cb127-20"><a href="simple-signal-free.html#cb127-20" tabindex="-1"></a>                    <span class="at">MAD =</span> MAD_Vec)</span>
<span id="cb127-21"><a href="simple-signal-free.html#cb127-21" tabindex="-1"></a></span>
<span id="cb127-22"><a href="simple-signal-free.html#cb127-22" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(MADdf, <span class="fu">aes</span>(<span class="at">x =</span> Iteration,<span class="at">y =</span> MAD,<span class="at">color=</span><span class="fu">factor</span>(Iteration))) <span class="sc">+</span></span>
<span id="cb127-23"><a href="simple-signal-free.html#cb127-23" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">5e-04</span>,<span class="at">color=</span><span class="st">&quot;grey30&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span> </span>
<span id="cb127-24"><a href="simple-signal-free.html#cb127-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-25"><a href="simple-signal-free.html#cb127-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb127-26"><a href="simple-signal-free.html#cb127-26" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> crnCols) <span class="sc">+</span></span>
<span id="cb127-27"><a href="simple-signal-free.html#cb127-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="fu">max</span>(MADdf<span class="sc">$</span>Iteration),<span class="at">by=</span><span class="dv">2</span>),</span>
<span id="cb127-28"><a href="simple-signal-free.html#cb127-28" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">max</span>(MADdf<span class="sc">$</span>Iteration)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb127-29"><a href="simple-signal-free.html#cb127-29" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb127-30"><a href="simple-signal-free.html#cb127-30" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(MADdf<span class="sc">$</span>MAD))) <span class="sc">+</span></span>
<span id="cb127-31"><a href="simple-signal-free.html#cb127-31" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb127-32"><a href="simple-signal-free.html#cb127-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb127-33"><a href="simple-signal-free.html#cb127-33" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;gray95&quot;</span>))</span>
<span id="cb127-34"><a href="simple-signal-free.html#cb127-34" tabindex="-1"></a></span>
<span id="cb127-35"><a href="simple-signal-free.html#cb127-35" tabindex="-1"></a><span class="fu">ggdraw</span>(p1) <span class="sc">+</span></span>
<span id="cb127-36"><a href="simple-signal-free.html#cb127-36" tabindex="-1"></a>  <span class="fu">draw_plot</span>(<span class="at">plot =</span> p2, </span>
<span id="cb127-37"><a href="simple-signal-free.html#cb127-37" tabindex="-1"></a>            <span class="at">x =</span> .<span class="dv">15</span>, <span class="at">y =</span> .<span class="dv">6</span>, </span>
<span id="cb127-38"><a href="simple-signal-free.html#cb127-38" tabindex="-1"></a>            <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">4</span>)</span></code></pre></div>
<p><img src="04-ssf_files/figure-html/plot%20all%20sm-1.png" width="672" /></p>
<p>We can also use the <code>gganimate</code> package to combine some of these elements in a way that allows us to see the progression of the chronology through the fitting process.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb128-1"><a href="simple-signal-free.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb128-2"><a href="simple-signal-free.html#cb128-2" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb128-3"><a href="simple-signal-free.html#cb128-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;sfAnim.gif&quot;</span>)){</span>
<span id="cb128-4"><a href="simple-signal-free.html#cb128-4" tabindex="-1"></a>  <span class="co"># raw data</span></span>
<span id="cb128-5"><a href="simple-signal-free.html#cb128-5" tabindex="-1"></a>  sfCrn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs,</span>
<span id="cb128-6"><a href="simple-signal-free.html#cb128-6" tabindex="-1"></a>                      <span class="at">msmt =</span> sfCrn_Mat) <span class="sc">%&gt;%</span></span>
<span id="cb128-7"><a href="simple-signal-free.html#cb128-7" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="at">.fn =</span> seq, <span class="at">.cols =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-8"><a href="simple-signal-free.html#cb128-8" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-9"><a href="simple-signal-free.html#cb128-9" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration =</span> <span class="fu">as.numeric</span>(Iteration)) <span class="sc">%&gt;%</span></span>
<span id="cb128-10"><a href="simple-signal-free.html#cb128-10" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration2 =</span> <span class="fu">str_pad</span>(<span class="fu">as.character</span>(Iteration),<span class="at">width=</span><span class="dv">2</span>,<span class="at">pad=</span><span class="st">&quot;0&quot;</span>))</span>
<span id="cb128-11"><a href="simple-signal-free.html#cb128-11" tabindex="-1"></a>  <span class="co"># smooth data</span></span>
<span id="cb128-12"><a href="simple-signal-free.html#cb128-12" tabindex="-1"></a>  sfCrnSm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs =</span> yrs,</span>
<span id="cb128-13"><a href="simple-signal-free.html#cb128-13" tabindex="-1"></a>                        <span class="at">msmtsm =</span> <span class="fu">apply</span>(sfCrn_Mat,<span class="dv">2</span>,caps,<span class="at">nyrs=</span><span class="dv">50</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb128-14"><a href="simple-signal-free.html#cb128-14" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="at">.fn =</span> seq, <span class="at">.cols =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-15"><a href="simple-signal-free.html#cb128-15" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;msmt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-16"><a href="simple-signal-free.html#cb128-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration =</span> <span class="fu">as.numeric</span>(Iteration)) <span class="sc">%&gt;%</span></span>
<span id="cb128-17"><a href="simple-signal-free.html#cb128-17" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration2 =</span> <span class="fu">str_pad</span>(<span class="fu">as.character</span>(Iteration),<span class="at">width=</span><span class="dv">2</span>,<span class="at">pad=</span><span class="st">&quot;0&quot;</span>))</span>
<span id="cb128-18"><a href="simple-signal-free.html#cb128-18" tabindex="-1"></a>  <span class="co"># MAD data</span></span>
<span id="cb128-19"><a href="simple-signal-free.html#cb128-19" tabindex="-1"></a>  MADdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Iteration =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(sfCrn_Mat)[<span class="dv">2</span>],</span>
<span id="cb128-20"><a href="simple-signal-free.html#cb128-20" tabindex="-1"></a>                      <span class="at">IterationStatic =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(sfCrn_Mat)[<span class="dv">2</span>],</span>
<span id="cb128-21"><a href="simple-signal-free.html#cb128-21" tabindex="-1"></a>                      <span class="at">MAD =</span> <span class="fu">c</span>(<span class="cn">NA</span>,MAD_Vec)) <span class="sc">%&gt;%</span></span>
<span id="cb128-22"><a href="simple-signal-free.html#cb128-22" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration2 =</span> <span class="fu">str_pad</span>(<span class="fu">as.character</span>(Iteration),<span class="at">width=</span><span class="dv">2</span>,<span class="at">pad=</span><span class="st">&quot;0&quot;</span>))</span>
<span id="cb128-23"><a href="simple-signal-free.html#cb128-23" tabindex="-1"></a>  </span>
<span id="cb128-24"><a href="simple-signal-free.html#cb128-24" tabindex="-1"></a>  <span class="co"># hf diff data</span></span>
<span id="cb128-25"><a href="simple-signal-free.html#cb128-25" tabindex="-1"></a>  <span class="co"># diff data have to add a column of zeros for iter 1</span></span>
<span id="cb128-26"><a href="simple-signal-free.html#cb128-26" tabindex="-1"></a>  highFreqDiff <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yrs=</span>yrs,</span>
<span id="cb128-27"><a href="simple-signal-free.html#cb128-27" tabindex="-1"></a>                             <span class="at">difference =</span>  <span class="fu">cbind</span>(<span class="dv">0</span>,hfCrnResids_Mat)) <span class="sc">%&gt;%</span></span>
<span id="cb128-28"><a href="simple-signal-free.html#cb128-28" tabindex="-1"></a>    <span class="fu">rename_with</span>(<span class="at">.fn =</span> seq, <span class="at">.cols =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-29"><a href="simple-signal-free.html#cb128-29" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">!</span>yrs,<span class="at">names_to =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;difference&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-30"><a href="simple-signal-free.html#cb128-30" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration =</span> <span class="fu">as.numeric</span>(Iteration)) <span class="sc">%&gt;%</span></span>
<span id="cb128-31"><a href="simple-signal-free.html#cb128-31" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Iteration2 =</span> <span class="fu">str_pad</span>(<span class="fu">as.character</span>(Iteration),<span class="at">width=</span><span class="dv">2</span>,<span class="at">pad=</span><span class="st">&quot;0&quot;</span>))</span>
<span id="cb128-32"><a href="simple-signal-free.html#cb128-32" tabindex="-1"></a>  </span>
<span id="cb128-33"><a href="simple-signal-free.html#cb128-33" tabindex="-1"></a>  <span class="co"># crn plot</span></span>
<span id="cb128-34"><a href="simple-signal-free.html#cb128-34" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb128-35"><a href="simple-signal-free.html#cb128-35" tabindex="-1"></a>    <span class="co"># layer 1</span></span>
<span id="cb128-36"><a href="simple-signal-free.html#cb128-36" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-37"><a href="simple-signal-free.html#cb128-37" tabindex="-1"></a>    <span class="co"># layer 2</span></span>
<span id="cb128-38"><a href="simple-signal-free.html#cb128-38" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data=</span>sfCrn,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>Iteration2),</span>
<span id="cb128-39"><a href="simple-signal-free.html#cb128-39" tabindex="-1"></a>              <span class="at">alpha=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb128-40"><a href="simple-signal-free.html#cb128-40" tabindex="-1"></a>    <span class="co"># layer 3</span></span>
<span id="cb128-41"><a href="simple-signal-free.html#cb128-41" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data=</span>sfCrnSm,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>msmt,<span class="at">color=</span>Iteration2),</span>
<span id="cb128-42"><a href="simple-signal-free.html#cb128-42" tabindex="-1"></a>              <span class="at">alpha=</span><span class="fl">0.75</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb128-43"><a href="simple-signal-free.html#cb128-43" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> crnCols) <span class="sc">+</span></span>
<span id="cb128-44"><a href="simple-signal-free.html#cb128-44" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Years&quot;</span>, <span class="at">y=</span><span class="st">&quot;RWI&quot;</span>,</span>
<span id="cb128-45"><a href="simple-signal-free.html#cb128-45" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;Signal Free Chronology&quot;</span>,</span>
<span id="cb128-46"><a href="simple-signal-free.html#cb128-46" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Iteration: {as.integer(frame_time)}&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-47"><a href="simple-signal-free.html#cb128-47" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb128-48"><a href="simple-signal-free.html#cb128-48" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb128-49"><a href="simple-signal-free.html#cb128-49" tabindex="-1"></a>  </span>
<span id="cb128-50"><a href="simple-signal-free.html#cb128-50" tabindex="-1"></a>  <span class="co"># mad plot</span></span>
<span id="cb128-51"><a href="simple-signal-free.html#cb128-51" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(MADdf, <span class="fu">aes</span>(<span class="at">x =</span> IterationStatic,<span class="at">y =</span>  MAD)) <span class="sc">+</span></span>
<span id="cb128-52"><a href="simple-signal-free.html#cb128-52" tabindex="-1"></a>    <span class="co">#static</span></span>
<span id="cb128-53"><a href="simple-signal-free.html#cb128-53" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">5e-04</span>,<span class="at">color=</span><span class="st">&quot;grey30&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-54"><a href="simple-signal-free.html#cb128-54" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(IterationStatic)),<span class="at">size=</span><span class="dv">4</span>,<span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb128-55"><a href="simple-signal-free.html#cb128-55" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> crnCols) <span class="sc">+</span></span>
<span id="cb128-56"><a href="simple-signal-free.html#cb128-56" tabindex="-1"></a>    <span class="co"># dynamic</span></span>
<span id="cb128-57"><a href="simple-signal-free.html#cb128-57" tabindex="-1"></a>    <span class="co"># Direction of segment reversed below, less distracting</span></span>
<span id="cb128-58"><a href="simple-signal-free.html#cb128-58" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-59"><a href="simple-signal-free.html#cb128-59" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> Iteration, <span class="at">yend =</span> MAD),</span>
<span id="cb128-60"><a href="simple-signal-free.html#cb128-60" tabindex="-1"></a>                 <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">colour =</span> <span class="st">&#39;gray50&#39;</span>) <span class="sc">+</span></span>
<span id="cb128-61"><a href="simple-signal-free.html#cb128-61" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Iteration),<span class="at">size=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;grey30&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb128-62"><a href="simple-signal-free.html#cb128-62" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="fu">max</span>(MADdf<span class="sc">$</span>Iteration),<span class="at">by=</span><span class="dv">2</span>),</span>
<span id="cb128-63"><a href="simple-signal-free.html#cb128-63" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">max</span>(MADdf<span class="sc">$</span>Iteration)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb128-64"><a href="simple-signal-free.html#cb128-64" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb128-65"><a href="simple-signal-free.html#cb128-65" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(MADdf<span class="sc">$</span>MAD))) <span class="sc">+</span></span>
<span id="cb128-66"><a href="simple-signal-free.html#cb128-66" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&#39;off&#39;</span>) <span class="sc">+</span></span>
<span id="cb128-67"><a href="simple-signal-free.html#cb128-67" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">y =</span> <span class="st">&quot;MAD&quot;</span>, </span>
<span id="cb128-68"><a href="simple-signal-free.html#cb128-68" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb128-69"><a href="simple-signal-free.html#cb128-69" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-70"><a href="simple-signal-free.html#cb128-70" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb128-71"><a href="simple-signal-free.html#cb128-71" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb128-72"><a href="simple-signal-free.html#cb128-72" tabindex="-1"></a>  <span class="co"># dif plot</span></span>
<span id="cb128-73"><a href="simple-signal-free.html#cb128-73" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(highFreqDiff,<span class="fu">aes</span>(<span class="at">x=</span>yrs,<span class="at">y=</span>difference)) <span class="sc">+</span></span>
<span id="cb128-74"><a href="simple-signal-free.html#cb128-74" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-75"><a href="simple-signal-free.html#cb128-75" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(Iteration))) <span class="sc">+</span></span>
<span id="cb128-76"><a href="simple-signal-free.html#cb128-76" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> crnCols) <span class="sc">+</span></span>
<span id="cb128-77"><a href="simple-signal-free.html#cb128-77" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;RWI Difference&quot;</span>,<span class="at">x=</span><span class="st">&quot;Years&quot;</span>,</span>
<span id="cb128-78"><a href="simple-signal-free.html#cb128-78" tabindex="-1"></a>         <span class="at">caption=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-79"><a href="simple-signal-free.html#cb128-79" tabindex="-1"></a>    <span class="fu">lims</span>(<span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb128-80"><a href="simple-signal-free.html#cb128-80" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb128-81"><a href="simple-signal-free.html#cb128-81" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb128-82"><a href="simple-signal-free.html#cb128-82" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb128-83"><a href="simple-signal-free.html#cb128-83" tabindex="-1"></a>  </span>
<span id="cb128-84"><a href="simple-signal-free.html#cb128-84" tabindex="-1"></a>  <span class="do">## do the animations  and write the final gif</span></span>
<span id="cb128-85"><a href="simple-signal-free.html#cb128-85" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">transition_time</span>(Iteration) <span class="sc">+</span> </span>
<span id="cb128-86"><a href="simple-signal-free.html#cb128-86" tabindex="-1"></a>    <span class="fu">shadow_mark</span>(<span class="at">exclude_layer =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb128-87"><a href="simple-signal-free.html#cb128-87" tabindex="-1"></a>    <span class="fu">enter_fade</span>()</span>
<span id="cb128-88"><a href="simple-signal-free.html#cb128-88" tabindex="-1"></a>  </span>
<span id="cb128-89"><a href="simple-signal-free.html#cb128-89" tabindex="-1"></a>  a1_gif <span class="ot">&lt;-</span> <span class="fu">animate</span>(a1, <span class="at">nframes =</span> <span class="dv">100</span>, <span class="at">duration =</span> <span class="dv">10</span>,</span>
<span id="cb128-90"><a href="simple-signal-free.html#cb128-90" tabindex="-1"></a>                    <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">res =</span> <span class="dv">200</span>, </span>
<span id="cb128-91"><a href="simple-signal-free.html#cb128-91" tabindex="-1"></a>                    <span class="at">renderer =</span> <span class="fu">magick_renderer</span>())</span>
<span id="cb128-92"><a href="simple-signal-free.html#cb128-92" tabindex="-1"></a>  </span>
<span id="cb128-93"><a href="simple-signal-free.html#cb128-93" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">transition_reveal</span>(Iteration)</span>
<span id="cb128-94"><a href="simple-signal-free.html#cb128-94" tabindex="-1"></a>  a2_gif <span class="ot">&lt;-</span> <span class="fu">animate</span>(a2, <span class="at">nframes =</span> <span class="dv">100</span>, <span class="at">duration =</span> <span class="dv">10</span>,</span>
<span id="cb128-95"><a href="simple-signal-free.html#cb128-95" tabindex="-1"></a>                    <span class="at">width =</span> <span class="dv">3</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">res =</span> <span class="dv">200</span>, </span>
<span id="cb128-96"><a href="simple-signal-free.html#cb128-96" tabindex="-1"></a>                    <span class="at">renderer =</span> <span class="fu">magick_renderer</span>())</span>
<span id="cb128-97"><a href="simple-signal-free.html#cb128-97" tabindex="-1"></a>  </span>
<span id="cb128-98"><a href="simple-signal-free.html#cb128-98" tabindex="-1"></a>  a3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">transition_time</span>(Iteration) <span class="sc">+</span> </span>
<span id="cb128-99"><a href="simple-signal-free.html#cb128-99" tabindex="-1"></a>    <span class="fu">enter_fade</span>() <span class="sc">+</span></span>
<span id="cb128-100"><a href="simple-signal-free.html#cb128-100" tabindex="-1"></a>    <span class="fu">exit_fade</span>()</span>
<span id="cb128-101"><a href="simple-signal-free.html#cb128-101" tabindex="-1"></a></span>
<span id="cb128-102"><a href="simple-signal-free.html#cb128-102" tabindex="-1"></a>  a3_gif <span class="ot">&lt;-</span> <span class="fu">animate</span>(a3, <span class="at">nframes =</span> <span class="dv">100</span>, <span class="at">duration =</span> <span class="dv">10</span>,</span>
<span id="cb128-103"><a href="simple-signal-free.html#cb128-103" tabindex="-1"></a>                    <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">res =</span> <span class="dv">200</span>, </span>
<span id="cb128-104"><a href="simple-signal-free.html#cb128-104" tabindex="-1"></a>                    <span class="at">renderer =</span> <span class="fu">magick_renderer</span>())</span>
<span id="cb128-105"><a href="simple-signal-free.html#cb128-105" tabindex="-1"></a>  </span>
<span id="cb128-106"><a href="simple-signal-free.html#cb128-106" tabindex="-1"></a>  combined_gif <span class="ot">&lt;-</span> <span class="fu">image_montage</span>(<span class="fu">c</span>(a1_gif[<span class="dv">1</span>],a2_gif[<span class="dv">1</span>],a3_gif[<span class="dv">1</span>]),</span>
<span id="cb128-107"><a href="simple-signal-free.html#cb128-107" tabindex="-1"></a>                                <span class="at">tile =</span> <span class="st">&quot;2x2&quot;</span>,</span>
<span id="cb128-108"><a href="simple-signal-free.html#cb128-108" tabindex="-1"></a>                                <span class="fu">geometry_size_percent</span>(<span class="dv">100</span>,<span class="dv">100</span>))</span>
<span id="cb128-109"><a href="simple-signal-free.html#cb128-109" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>){ <span class="co"># nframe</span></span>
<span id="cb128-110"><a href="simple-signal-free.html#cb128-110" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">image_montage</span>(<span class="fu">c</span>(a1_gif[i],a2_gif[i],a3_gif[i]),</span>
<span id="cb128-111"><a href="simple-signal-free.html#cb128-111" tabindex="-1"></a>                         <span class="at">tile =</span> <span class="st">&quot;2x2&quot;</span>,</span>
<span id="cb128-112"><a href="simple-signal-free.html#cb128-112" tabindex="-1"></a>                         <span class="fu">geometry_size_percent</span>(<span class="dv">100</span>,<span class="dv">100</span>))</span>
<span id="cb128-113"><a href="simple-signal-free.html#cb128-113" tabindex="-1"></a>    combined_gif <span class="ot">&lt;-</span> <span class="fu">c</span>(combined_gif,tmp)</span>
<span id="cb128-114"><a href="simple-signal-free.html#cb128-114" tabindex="-1"></a>  }</span>
<span id="cb128-115"><a href="simple-signal-free.html#cb128-115" tabindex="-1"></a>  <span class="fu">image_write</span>(<span class="at">image =</span> combined_gif,<span class="at">format =</span> <span class="st">&quot;gif&quot;</span>,<span class="at">path =</span> <span class="st">&quot;sfAnim.gif&quot;</span>)</span>
<span id="cb128-116"><a href="simple-signal-free.html#cb128-116" tabindex="-1"></a>}</span>
<span id="cb128-117"><a href="simple-signal-free.html#cb128-117" tabindex="-1"></a></span>
<span id="cb128-118"><a href="simple-signal-free.html#cb128-118" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;sfAnim.gif&quot;</span>)</span></code></pre></div>
<p><img src="sfAnim.gif" /><!-- --></p>
<p>One thing to note with these data is that the upturns and downturns at the ends of the chronology are persistent even though they shrink vastly in the later iterations.</p>
</div>
</div>
<div id="final-thoughts" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Final Thoughts<a href="simple-signal-free.html#final-thoughts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This document shows how the algorithm progresses through the iterations in order to calculate the simple signal-free chronology. We should caution here that while there are excellent theoretical reasons to use the signal-free approach, the method is not a panacea for all applications. Detrending, after all, is a dark art and it is always up to the user to carefully evaluate the data and build chronologies with expectation that the final product is heavily dependent on the site and on the methods used.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chronology-building.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="xdate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
