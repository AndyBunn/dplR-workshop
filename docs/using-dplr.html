<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Using dplR | Learning to Love dplR</title>
  <meta name="description" content="Helful materials for dplR" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Using dplR | Learning to Love dplR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Helful materials for dplR" />
  <meta name="github-repo" content="OpenDendro/dplR-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Using dplR | Learning to Love dplR" />
  
  <meta name="twitter:description" content="Helful materials for dplR" />
  

<meta name="author" content="Andy Bunn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="chronology-building.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
      // AGB add fold-hide
    if (classList[i] === 'fold-hide') {
        show = false;
      }
    }
    // AGB
    // if code block has been labeled with class `fold-hide`, hide the code on init!
//    var classList = $(this).attr('class').split(/\s+/);
//    for (var i = 0; i < classList.length; i++) {
//    if (classList[i] === 'fold-hide') {
//        show = false;
//      }
//    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = true;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  // AGB add fold-hide changed === to !== to default to showing code
  window.initializeCodeFolding("show" !== "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#before-starting"><i class="fa fa-check"></i><b>2.1</b> Before Starting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#getting-dplr"><i class="fa fa-check"></i><b>2.1.2</b> Getting dplR</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#layout"><i class="fa fa-check"></i><b>2.2</b> Layout</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#a-note-on-name-conflicts"><i class="fa fa-check"></i><b>2.2.1</b> A Note on Name Conflicts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.3</b> Getting Help with R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#citing-r-dplr-and-other-packages"><i class="fa fa-check"></i><b>2.4</b> Citing R, dplR, and Other Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-dplr.html"><a href="using-dplr.html"><i class="fa fa-check"></i><b>3</b> Using dplR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-dplr.html"><a href="using-dplr.html#what-is-covered"><i class="fa fa-check"></i><b>3.1</b> What is Covered</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="using-dplr.html"><a href="using-dplr.html#load-dplr"><i class="fa fa-check"></i><b>3.1.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-dplr.html"><a href="using-dplr.html#working-with-ring-width-data"><i class="fa fa-check"></i><b>3.2</b> Working with Ring-Width Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="using-dplr.html"><a href="using-dplr.html#reading-data"><i class="fa fa-check"></i><b>3.2.1</b> Reading Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-dplr.html"><a href="using-dplr.html#describing-and-plotting-ring-width-data"><i class="fa fa-check"></i><b>3.2.2</b> Describing and Plotting Ring-Width Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4" data-path="using-dplr.html"><a href="using-dplr.html#detrending"><i class="fa fa-check"></i><b>3.4</b> Detrending</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="using-dplr.html"><a href="using-dplr.html#common-detrending-methods"><i class="fa fa-check"></i><b>3.4.1</b> Common Detrending Methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="using-dplr.html"><a href="using-dplr.html#interactive-detrending"><i class="fa fa-check"></i><b>3.4.2</b> Interactive detrending</a></li>
<li class="chapter" data-level="3.4.3" data-path="using-dplr.html"><a href="using-dplr.html#other-detrending-methods"><i class="fa fa-check"></i><b>3.4.3</b> Other Detrending Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics-for-detrended-data"><i class="fa fa-check"></i><b>3.5</b> Descriptive Statistics for Detrended Data</a></li>
<li class="chapter" data-level="3.6" data-path="using-dplr.html"><a href="using-dplr.html#building-a-mean-value-chronology"><i class="fa fa-check"></i><b>3.6</b> Building a Mean-Value Chronology</a></li>
<li class="chapter" data-level="3.7" data-path="using-dplr.html"><a href="using-dplr.html#conclusion"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chronology-building.html"><a href="chronology-building.html"><i class="fa fa-check"></i><b>4</b> Chronology Building</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chronology-building.html"><a href="chronology-building.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chronology-building.html"><a href="chronology-building.html#data-sets"><i class="fa fa-check"></i><b>4.2</b> Data Sets</a></li>
<li class="chapter" data-level="4.3" data-path="chronology-building.html"><a href="chronology-building.html#traditional-chronology"><i class="fa fa-check"></i><b>4.3</b> Traditional Chronology</a></li>
<li class="chapter" data-level="4.4" data-path="chronology-building.html"><a href="chronology-building.html#using-a-sample-depth-cutoff"><i class="fa fa-check"></i><b>4.4</b> Using a Sample Depth Cutoff</a></li>
<li class="chapter" data-level="4.5" data-path="chronology-building.html"><a href="chronology-building.html#using-sss-as-a-cutoff"><i class="fa fa-check"></i><b>4.5</b> Using SSS as a Cutoff</a></li>
<li class="chapter" data-level="4.6" data-path="chronology-building.html"><a href="chronology-building.html#chronology-uncertainty"><i class="fa fa-check"></i><b>4.6</b> Chronology Uncertainty</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chronology-building.html"><a href="chronology-building.html#bootstrapping-confidence-intervals"><i class="fa fa-check"></i><b>4.6.1</b> Bootstrapping confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chronology-building.html"><a href="chronology-building.html#the-arstan-chronology"><i class="fa fa-check"></i><b>4.7</b> The ARSTAN Chronology</a></li>
<li class="chapter" data-level="4.8" data-path="chronology-building.html"><a href="chronology-building.html#stabalizing-the-variance"><i class="fa fa-check"></i><b>4.8</b> Stabalizing the Variance</a></li>
<li class="chapter" data-level="4.9" data-path="chronology-building.html"><a href="chronology-building.html#stripping-out-series-by-eps"><i class="fa fa-check"></i><b>4.9</b> Stripping out series by EPS</a></li>
<li class="chapter" data-level="4.10" data-path="chronology-building.html"><a href="chronology-building.html#conclusion-1"><i class="fa fa-check"></i><b>4.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simple-signal-free.html"><a href="simple-signal-free.html"><i class="fa fa-check"></i><b>5</b> Simple Signal-Free</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#making-the-simple-signal-free-chronology"><i class="fa fa-check"></i><b>5.4</b> Making the Simple Signal-Free Chronology</a></li>
<li class="chapter" data-level="5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#walk-through"><i class="fa fa-check"></i><b>5.5</b> Walk Through</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-1-iteration-0"><i class="fa fa-check"></i><b>5.5.1</b> Step 1 (Iteration 0)</a></li>
<li class="chapter" data-level="5.5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-2-and-3-iteration-1"><i class="fa fa-check"></i><b>5.5.2</b> Steps 2 and 3 (Iteration 1)</a></li>
<li class="chapter" data-level="5.5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-4-and-5-iteration-1"><i class="fa fa-check"></i><b>5.5.3</b> Steps 4 and 5 (Iteration 1)</a></li>
<li class="chapter" data-level="5.5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-6-and-7-iteration-1"><i class="fa fa-check"></i><b>5.5.4</b> Step 6 and 7 (Iteration 1)</a></li>
<li class="chapter" data-level="5.5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-8-begin-iterations"><i class="fa fa-check"></i><b>5.5.5</b> Step 8 (Begin Iterations)</a></li>
<li class="chapter" data-level="5.5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#iterations-visualized"><i class="fa fa-check"></i><b>5.5.6</b> Iterations Visualized</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#changing-the-detrending-method"><i class="fa fa-check"></i><b>5.6</b> Changing the Detrending Method</a></li>
<li class="chapter" data-level="5.7" data-path="simple-signal-free.html"><a href="simple-signal-free.html#final-thoughts"><i class="fa fa-check"></i><b>5.7</b> Final Thoughts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="xdate.html"><a href="xdate.html"><i class="fa fa-check"></i><b>6</b> xDate</a>
<ul>
<li class="chapter" data-level="6.1" data-path="xdate.html"><a href="xdate.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="xdate.html"><a href="xdate.html#using-the-xdater-app"><i class="fa fa-check"></i><b>6.2</b> Using the xDater app</a></li>
<li class="chapter" data-level="6.3" data-path="xdate.html"><a href="xdate.html#crossdating-by-hand-in-dplr"><i class="fa fa-check"></i><b>6.3</b> Crossdating by hand in dplR</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="xdate.html"><a href="xdate.html#load-dplr-1"><i class="fa fa-check"></i><b>6.3.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="xdate.html"><a href="xdate.html#ruining-a-perfectly-good-data-set"><i class="fa fa-check"></i><b>6.4</b> Ruining a Perfectly Good Data Set</a></li>
<li class="chapter" data-level="6.5" data-path="xdate.html"><a href="xdate.html#series-correlation-by-segment"><i class="fa fa-check"></i><b>6.5</b> Series Correlation by Segment</a></li>
<li class="chapter" data-level="6.6" data-path="xdate.html"><a href="xdate.html#individual-series-correlation"><i class="fa fa-check"></i><b>6.6</b> Individual Series Correlation</a></li>
<li class="chapter" data-level="6.7" data-path="xdate.html"><a href="xdate.html#using-cross-correlation"><i class="fa fa-check"></i><b>6.7</b> Using Cross Correlation</a></li>
<li class="chapter" data-level="6.8" data-path="xdate.html"><a href="xdate.html#visual-crossdating"><i class="fa fa-check"></i><b>6.8</b> Visual Crossdating</a></li>
<li class="chapter" data-level="6.9" data-path="xdate.html"><a href="xdate.html#conclusion-2"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html"><i class="fa fa-check"></i><b>7</b> Intro to dendro time-series</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#load-libraries"><i class="fa fa-check"></i><b>7.1.1</b> Load libraries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#data-sets-1"><i class="fa fa-check"></i><b>7.2</b> Data Sets</a></li>
<li class="chapter" data-level="7.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#smoothing"><i class="fa fa-check"></i><b>7.3</b> Smoothing</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#moving-running-average"><i class="fa fa-check"></i><b>7.3.1</b> Moving (running) average</a></li>
<li class="chapter" data-level="7.3.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#hanning"><i class="fa fa-check"></i><b>7.3.2</b> Hanning</a></li>
<li class="chapter" data-level="7.3.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#splines"><i class="fa fa-check"></i><b>7.3.3</b> Splines</a></li>
<li class="chapter" data-level="7.3.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#loess"><i class="fa fa-check"></i><b>7.3.4</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#characterizing-temporal-structure"><i class="fa fa-check"></i><b>7.4</b> Characterizing Temporal Structure</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#acf-and-pacf"><i class="fa fa-check"></i><b>7.4.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="7.4.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#ar-and-arma"><i class="fa fa-check"></i><b>7.4.2</b> AR and ARMA</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#frequency-domain"><i class="fa fa-check"></i><b>7.5</b> Frequency Domain</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#power-via-spectral-analysis-and-wavelets"><i class="fa fa-check"></i><b>7.5.1</b> Power via Spectral Analysis and Wavelets</a></li>
<li class="chapter" data-level="7.5.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#extracting-signals"><i class="fa fa-check"></i><b>7.5.2</b> Extracting signals</a></li>
<li class="chapter" data-level="7.5.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#high-pass-low-pass-and-bandpass-filtering"><i class="fa fa-check"></i><b>7.5.3</b> High-pass, low-pass, and bandpass filtering</a></li>
<li class="chapter" data-level="7.5.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#interruption-duplicate-function-names"><i class="fa fa-check"></i><b>7.5.4</b> Interruption: Duplicate function names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>8</b> Acknowledgements</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning to Love dplR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-dplr" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Using dplR<a href="using-dplr.html#using-dplr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This document describes basic features of <code>dplR</code> by following the initial steps that an analyst might follow when working with a new tree-ring data set. The document starts with reading in ring widths and plotting them. We describe a few of the available methods for detrending and then show how to extract basic descriptive statistics. We show how to build and plot a simple mean-value chronology. We also show how to build a chronology using the expressed population signal from the detrended ring widths as an example of how more complicated analysis can be done using <code>dplR</code>.</p>
<div id="what-is-covered" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> What is Covered<a href="using-dplr.html#what-is-covered" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Dendrochronology Program Library in R (<code>dplR</code>) is a package for dendrochronologists to handle data processing and analysis. This document gives just a brief introduction of some of the most commonly used functions in <code>dplR</code>. There is more detailed information available in the help files and in the literature <span class="citation">(<a href="references.html#ref-Bunn2008">Bunn, 2008</a>)</span>.</p>
<p>In this document, we will walk through the most basic activities of working with tree-ring data in roughly the order that a user might follow. E.g., reading data, detrending, chronology building, and doing preliminary exploratory data analysis via descriptive statistics.</p>
<div id="load-dplr" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Load dplR<a href="using-dplr.html#load-dplr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will be using <code>dplR</code> in here. Load it:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="using-dplr.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(dplR)</span></code></pre></div>
<pre><code>## This is dplR version 1.7.6.
## dplR is part of openDendro https://opendendro.org.
## New users can visit https://opendendro.github.io/dplR-workshop/ to get started.</code></pre>
</div>
</div>
<div id="working-with-ring-width-data" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Working with Ring-Width Data<a href="using-dplr.html#working-with-ring-width-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="reading-data" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Reading Data<a href="using-dplr.html#reading-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are many ways that tree-ring data are digitally stored. These range in sophistication from the simple (and commonly used) <a href="http://www1.ncdc.noaa.gov/pub/data/paleo/treering/treeinfo.txt">Tucson/decadal</a> format file of ring widths to the more complex (but richer) <a href="http://www.tridas.org/">TRiDaS format</a>. The type of data used most often by dendrochronologists is a series of ring widths from tree cores. We generally refer to these as <code>rwl</code> objects for “ring width length” but there is no reason these cannot be other types of tree-ring data (e.g., density).</p>
<p>The workhorse function for getting tree-ring data into R is dplR’s <code>read.rwl</code> function. This function reads files in <code>"tucson"</code>, <code>"compact"</code>, <code>"tridas"</code>, and <code>"heidelberg"</code> formats. The on-board <code>rwl</code> data sets in <code>dplR</code> (i.e., <code>co021</code>, <code>ca533</code>, <code>gp.rwl</code>) were all imported into R using this function.</p>
<p>Throughout this document we will use the on-board data set <code>ca533</code> which gives the raw ring widths for bristlecone pine <em>Pinus longaeva</em> at Campito Mountain in California, USA. There are 34 series spanning 1358 years.</p>
<p>These objects are structured very simply as a <code>data.frame</code> with the series in columns and the years as rows. The series IDs are the column names and the years are the row names (both stored as characters). For instance, using the Campito Mountain ring widths we can load the data and learn some basic things about it:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="using-dplr.html#cb17-1" tabindex="-1"></a><span class="fu">data</span>(ca533) <span class="co"># the result of ca533 &lt;- read.rwl(&#39;ca533.rwl&#39;)</span></span>
<span id="cb17-2"><a href="using-dplr.html#cb17-2" tabindex="-1"></a><span class="fu">nrow</span>(ca533) <span class="co"># 1358 years</span></span></code></pre></div>
<pre><code>## [1] 1358</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="using-dplr.html#cb19-1" tabindex="-1"></a><span class="fu">ncol</span>(ca533) <span class="co"># 34 series</span></span></code></pre></div>
<pre><code>## [1] 34</code></pre>
<p>We can look a little deeper at this object (<code>ca533</code>) and get the series names as well as look at the time values associates with the data:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="using-dplr.html#cb21-1" tabindex="-1"></a><span class="fu">colnames</span>(ca533) <span class="co"># the series IDs</span></span></code></pre></div>
<pre><code>##  [1] &quot;CAM011&quot; &quot;CAM021&quot; &quot;CAM031&quot; &quot;CAM032&quot; &quot;CAM041&quot; &quot;CAM042&quot; &quot;CAM051&quot; &quot;CAM061&quot;
##  [9] &quot;CAM062&quot; &quot;CAM071&quot; &quot;CAM072&quot; &quot;CAM081&quot; &quot;CAM082&quot; &quot;CAM091&quot; &quot;CAM092&quot; &quot;CAM101&quot;
## [17] &quot;CAM102&quot; &quot;CAM111&quot; &quot;CAM112&quot; &quot;CAM121&quot; &quot;CAM122&quot; &quot;CAM131&quot; &quot;CAM132&quot; &quot;CAM141&quot;
## [25] &quot;CAM151&quot; &quot;CAM152&quot; &quot;CAM161&quot; &quot;CAM162&quot; &quot;CAM171&quot; &quot;CAM172&quot; &quot;CAM181&quot; &quot;CAM191&quot;
## [33] &quot;CAM201&quot; &quot;CAM211&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="using-dplr.html#cb23-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">time</span>(ca533),<span class="at">n =</span> <span class="dv">10</span>) <span class="co"># the first 10 years</span></span></code></pre></div>
<pre><code>##  [1] 626 627 628 629 630 631 632 633 634 635</code></pre>
</div>
<div id="describing-and-plotting-ring-width-data" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Describing and Plotting Ring-Width Data<a href="using-dplr.html#describing-and-plotting-ring-width-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once a <code>rwl</code> data set has been read into R, there are a variety of ways to describe and visualize those data. Take note that this object is stored both as a generic <code>data.frame</code> in R but it also is part of a special class called <code>rwl</code> which will let R know how to do some special things with it like summarize and plot the data:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="using-dplr.html#cb25-1" tabindex="-1"></a><span class="fu">class</span>(ca533) </span></code></pre></div>
<pre><code>## [1] &quot;rwl&quot;        &quot;data.frame&quot;</code></pre>
<p>Thus, we can plot a <code>rwl</code> object by showing either the segments arranged over time as straight lines or as a “spaghetti plot”. The <code>rwl</code> objects have generic S3 methods for <code>plot</code> and <code>summary</code> meaning that <code>R</code> knows how to do something special when <code>plot</code> or <code>summary</code> are invoked on an object with class <code>rwl</code>. E.g.,:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="using-dplr.html#cb27-1" tabindex="-1"></a><span class="fu">plot</span>(ca533, <span class="at">plot.type=</span><span class="st">&quot;spag&quot;</span>)</span></code></pre></div>
<p><img src="02-intro_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="descriptive-statistics" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Descriptive Statistics<a href="using-dplr.html#descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simplest report on a <code>rwl</code> object can be print to the screen via:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="using-dplr.html#cb28-1" tabindex="-1"></a><span class="fu">rwl.report</span>(ca533)</span></code></pre></div>
<pre><code>## Number of dated series: 34 
## Number of measurements: 23276 
## Avg series length: 684.5882 
## Range:  1358 
## Span:  626 - 1983 
## Mean (Std dev) series intercorrelation: 0.6294255 (0.0859289)
## Mean (Std dev) AR1: 0.7092647 (0.09811876)
## -------------
## Years with absent rings listed by series 
##     Series CAM011 -- 1753 1782 
##     Series CAM031 -- 1497 1500 1523 1533 1540 1542 1545 1578 1579 1580 1655 1668 1670 1681 
##     Series CAM032 -- 1497 1523 1579 1654 1670 1681 1782 
##     Series CAM051 -- 1475 
##     Series CAM061 -- 1497 1523 1542 1545 1547 1579 1654 1655 1668 1670 1672 1782 1858 1960 
##     Series CAM062 -- 1542 1545 1547 1548 1579 1654 1655 1670 1672 1782 1836 1857 1858 1929 
##     Series CAM071 -- 1269 1497 1498 1523 1542 1547 1578 1579 1612 1655 1656 1668 1670 1672 1674 1690 1707 1708 1756 1782 1795 1820 1836 1845 1857 1858 1924 1948 1960 
##     Series CAM072 -- 1218 1497 1498 1523 1533 1538 1542 1545 1546 1547 1571 1579 1580 1590 1654 1655 1668 1670 1672 1675 1690 
##     Series CAM081 -- 1218 1336 
##     Series CAM082 -- 1362 1858 1865 
##     Series CAM091 -- 1655 1669 1670 1782 1858 
##     Series CAM092 -- 1624 1654 1655 1670 1672 1675 1677 1690 1703 1705 1707 1708 1710 1733 1753 1756 1757 1774 1777 1781 1782 1783 1784 1795 1807 1824 1829 1836 1845 1857 1858 1899 1904 1929 1936 1961 
##     Series CAM101 -- 1782 1783 1899 1929 
##     Series CAM102 -- 1669 1690 1782 1858 1899 1929 
##     Series CAM111 -- 1542 
##     Series CAM112 -- 1542 
##     Series CAM121 -- 1093 1218 1254 1361 1365 1460 1462 1468 1473 1475 1492 1497 1542 1544 1545 1547 1600 1899 1960 
##     Series CAM122 -- 1117 1133 1147 1177 1218 1254 1361 1475 1497 1670 
##     Series CAM131 -- 1361 
##     Series CAM151 -- 1670 1703 
##     Series CAM161 -- 1523 
##     Series CAM162 -- 1618 1624 1641 
##     Series CAM181 -- 1450 1523 
##     Series CAM191 -- 1475 1497 1523 1533 1542 1558 1571 1578 1618 1655 1668 1670 1675 1677 1690 1705 1777 1929 
##     Series CAM201 -- 1523 
##     Series CAM211 -- 645 762 809 847 924 957 1014 1118 1123 1133 1147 1189 1350 1384 1468 1571 1641 
## 234 absent rings (1.005%)
## -------------
## Years with internal NA values listed by series 
##     None</code></pre>
<p>That’s pretty basic information. We can look at some common (and not-so common) descriptive statistics of a <code>rwl</code> object:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="using-dplr.html#cb30-1" tabindex="-1"></a>ca533.stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(ca533) <span class="co"># same as calling rwl.stats(ca533)</span></span>
<span id="cb30-2"><a href="using-dplr.html#cb30-2" tabindex="-1"></a><span class="fu">head</span>(ca533.stats,<span class="at">n=</span><span class="dv">5</span>) <span class="co"># look at the first five series</span></span></code></pre></div>
<pre><code>##   series first last year  mean median stdev  skew  gini   ar1
## 1 CAM011  1530 1983  454 0.440   0.40 0.222 1.029 0.273 0.696
## 2 CAM021  1433 1983  551 0.424   0.40 0.185 0.946 0.237 0.701
## 3 CAM031  1356 1983  628 0.349   0.29 0.214 0.690 0.341 0.808
## 4 CAM032  1435 1983  549 0.293   0.26 0.163 0.717 0.309 0.661
## 5 CAM041  1683 1983  301 0.526   0.53 0.223 0.488 0.238 0.690</code></pre>
<p>These are common summary statistics like mean, median, etc. but also statistics that are more specific to dendrochronology like the first-order autocorrelation (<code>ar1</code>), gini (<code>gini</code>). Note that output object <code>ca533.stats</code> is itself a <code>data.frame</code> and its data can be used to plot, summarize, etc.</p>
<p>For instance, we can get the mean and standard deviation of segment length via:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="using-dplr.html#cb32-1" tabindex="-1"></a><span class="fu">mean</span>(ca533.stats<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## [1] 684.5882</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="using-dplr.html#cb34-1" tabindex="-1"></a><span class="fu">sd</span>(ca533.stats<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## [1] 276.9972</code></pre>
<p>Or, we can look at the spread of the first-order autocorrelation via <code>summary(ca533.stats$ar1)</code> or make a plot to show the data. Here we will demonstrate a somewhat involved plot to get you an idea of how to layer plotting commands:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="using-dplr.html#cb36-1" tabindex="-1"></a><span class="fu">boxplot</span>(ca533.stats<span class="sc">$</span>ar1,<span class="at">ylab=</span><span class="fu">expression</span>(phi[<span class="dv">1</span>]),<span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb36-2"><a href="using-dplr.html#cb36-2" tabindex="-1"></a><span class="fu">stripchart</span>(ca533.stats<span class="sc">$</span>ar1, <span class="at">vertical =</span> <span class="cn">TRUE</span>,  </span>
<span id="cb36-3"><a href="using-dplr.html#cb36-3" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="at">jitter =</span> <span class="fl">0.02</span>,<span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&#39;darkblue&#39;</span>,<span class="at">cex=</span><span class="fl">1.25</span>)</span>
<span id="cb36-4"><a href="using-dplr.html#cb36-4" tabindex="-1"></a>ar1Quant <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ca533.stats<span class="sc">$</span>ar1,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb36-5"><a href="using-dplr.html#cb36-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>ar1Quant,<span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb36-6"><a href="using-dplr.html#cb36-6" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="fu">names</span>(ar1Quant),<span class="at">side =</span> <span class="dv">4</span>,<span class="at">at =</span> ar1Quant,<span class="at">las=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-intro_files/figure-html/unnamed-chunk-8-1.png" width="480" /></p>
<p>Quick editorial note. I’ve switched from base R plotting to using <code>ggplot</code> in most all of my work. I need to go through and provide new plotting examples for everything, but time is short. Real quick though, here is a <code>ggplot</code></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="using-dplr.html#cb37-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb37-2"><a href="using-dplr.html#cb37-2" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="st">&quot;CA 533&quot;</span>,<span class="at">y=</span>ca533.stats<span class="sc">$</span>ar1)</span>
<span id="cb37-3"><a href="using-dplr.html#cb37-3" tabindex="-1"></a><span class="fu">ggplot</span>(ar1,<span class="fu">aes</span>(x,y)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">width=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="using-dplr.html#cb37-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb37-5"><a href="using-dplr.html#cb37-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(phi[<span class="dv">1</span>]),<span class="at">x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb37-6"><a href="using-dplr.html#cb37-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="02-intro_files/figure-html/unnamed-chunk-9-1.png" width="192" /></p>
<p>There are a few other descriptive stats that are available. Mean sensitivity (<code>sens1</code> and <code>sens2</code>) used to be included in the standard summary statistics but <strong>mean sensitivity is actually a terrible statistic that should rarely, if ever, be used <span class="citation">(<a href="references.html#ref-Bunn2013">Bunn <em>et al.</em>, 2013</a>)</span>.</strong> It is at best equivalent to the standard deviation of a time series in cases without high autocorrelation and is an inefficient estimator of the coefficient of variation. So use cautiously if at all.</p>
</div>
<div id="detrending" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Detrending<a href="using-dplr.html#detrending" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analysts often (but not always) detrend a <code>rwl</code> data set to create an object containing ring-width index (<code>rwi</code>) values. The <code>dplR</code> package contains most standard detrending methods including detrending via splines, fitting negative exponential curves, and so on. There are also <code>dplR</code> functions for less commonly used detrending methods like regional curve and signal-free standardization.</p>
<p>A <code>rwi</code> object has the same basic properties as the <code>rwl</code> object from which it is made. I.e., it has the same number of rows and columns, the same names, and so on. The difference is that each series has been standardized by dividing the ring widths against a growth model (e.g., a stiff spline, a negative exponential, etc.). This gives each series a mean of one (thus referred to as “indexed”) and allows a chronology to be built (next section). As <code>read.rwl</code> is the primary function for getting data into R, <code>detrend</code> is the primary function for standardizing <code>rwl</code> objects (but see <code>cms</code>, <code>rcs</code>, <code>bai.in</code>, and <code>bai.out</code> as well).</p>
<div id="common-detrending-methods" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Common Detrending Methods<a href="using-dplr.html#common-detrending-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As any dendrochronologist will tell you, detrending is a dark art. In <code>dplR</code> we have implemented some of the standard tools for detrending but all have drawbacks. In all of the methods, the detrending is the estimation and removal of the low frequency variability that is due to biological or stand effects. The standardization is done by dividing each series by the growth trend to produce units in the dimensionless ring-width index (RWI). Much of the text that follows is modified from the help page of <code>detrend</code>.</p>
<p>Probably the most common method for detrending is what is often called the “conservative” approach of attempting to fit a negative exponential curve to a series. In the <code>dplR</code> implementation the <code>"ModNegExp"</code> method of <code>detrend</code> attempts to fit a classic nonlinear model of biological growth of the form <span class="math inline">\((f(t) = a \times \mathrm{e}^{bt} + k)\)</span>, where the argument of the function is time, using <code>nls</code>. See Fritts <span class="citation">(<a href="references.html#ref-Fritts2001">2001</a>)</span> for details about the parameters. If a suitable nonlinear model cannot be fit (function is non-decreasing or some values are not positive) then a linear model is fit using <code>lm</code>. That linear model can have a positive slope unless <code>pos.slope</code> is <code>FALSE</code> in which case the series is standardized by its mean (method <code>"Mean"</code> in <code>detrend</code>).</p>
<p>For instance, every series in the <code>ca533</code> object can be detrended at once with an age-dependent spline via:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="using-dplr.html#cb38-1" tabindex="-1"></a>ca533.rwi <span class="ot">&lt;-</span> <span class="fu">detrend</span>(<span class="at">rwl =</span> ca533, <span class="at">method =</span> <span class="st">&quot;AgeDepSpline&quot;</span>)</span></code></pre></div>
<p>This saves the results in <code>ca533.rwi</code> which is a <code>data.frame</code> with the same dimensions as the <code>rwl</code> object <code>ca533</code> and each series standardized.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="using-dplr.html#cb39-1" tabindex="-1"></a><span class="fu">nrow</span>(ca533.rwi) <span class="co"># 1358 years</span></span></code></pre></div>
<pre><code>## [1] 1358</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="using-dplr.html#cb41-1" tabindex="-1"></a><span class="fu">ncol</span>(ca533.rwi) <span class="co"># 34 series</span></span></code></pre></div>
<pre><code>## [1] 34</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="using-dplr.html#cb43-1" tabindex="-1"></a><span class="fu">colMeans</span>(ca533.rwi, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##    CAM011    CAM021    CAM031    CAM032    CAM041    CAM042    CAM051    CAM061 
## 1.0631050 1.0224109 2.2693152 1.3842987 1.0406039 1.0705729 0.9986579 1.0271454 
##    CAM062    CAM071    CAM072    CAM081    CAM082    CAM091    CAM092    CAM101 
## 0.9972379 1.0019581 1.3751516 1.3000696 0.9988440 1.1558844 1.1102479 1.4626404 
##    CAM102    CAM111    CAM112    CAM121    CAM122    CAM131    CAM132    CAM141 
## 1.0631347 1.1279841 1.0140838 1.3058103 1.0625794 1.1127666 0.9997782 1.0105626 
##    CAM151    CAM152    CAM161    CAM162    CAM171    CAM172    CAM181    CAM191 
## 1.1363804 0.9990169 0.9992451 1.1053696 1.0649315 1.0242845 1.5740168 1.0651213 
##    CAM201    CAM211 
## 1.0478775 1.1227146</code></pre>
<p>When <code>detrend</code> is run on a <code>rwl</code> object the function loops through
each series. It does this by calling a different function
(<code>detrend.series</code>) for each column in the <code>rwl</code> object.
But, a user can also call <code>detrend.series</code> and it is useful to do so here
for educational purposes.</p>
<p>Let us detrend a single series and apply more than one detrending method when we call the detrend function. We will call <code>detrend.series</code> using the verbose mode so that we can see the parameters applied for each method. The <code>detrend.series</code> function produces a plot by default.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="using-dplr.html#cb45-1" tabindex="-1"></a>CAM011.rwi <span class="ot">&lt;-</span> <span class="fu">detrend.series</span>(<span class="at">y =</span> ca533[, <span class="st">&quot;CAM011&quot;</span>],<span class="at">verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
## Verbose output: 
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Options
##  make.plot      TRUE
##  method(s)1     c(&quot;Spline&quot;, &quot;ModNegExp&quot;, &quot;Mean&quot;, &quot;Ar&quot;, &quot;Friedman&quot;, &quot;ModHugershoff&quot;, 
##  method(s)2     &quot;AgeDepSpline&quot;)
##  nyrs           NULL
##  f              0.5
##  pos.slope      FALSE
##  constrain.nls  never
##  verbose        TRUE
##  return.info    FALSE
##  wt             default
##  span           cv
##  bass           0
##  difference     FALSE
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Zero indices in input series:
##  1128 1157
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by ModNegExp.
##  Trying to fit nls model...
##  nls coefs
##  a:  0.66109686
##  b: -0.01184415
##  k:  0.31793386
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by ModHugershoff.
##  Trying to fit nls model...
##  nls coefs
##  a: 0.45550002
##  b: 0.15419657
##  g: 0.01532032
##  d: 0.32391578
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by age-dependent spline.
##  Spline parameters
##  nyrs = 50, pos.slope = FALSE
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by spline.
##  Spline parameters
##  nyrs = 304, f = 0.5
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by mean.
##  Mean =  0.4395859
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by prewhitening.
## Call:
## ar(x = y[idx.goody])
## 
## Coefficients:
##       1        2        3        4        5        6        7        8  
##  0.3884   0.1393   0.0002   0.0838   0.1321   0.0613   0.0381  -0.1255  
##       9       10       11       12       13       14       15       16  
##  0.0366  -0.0996  -0.0102   0.0147   0.0879   0.0104   0.0639  -0.0132  
##      17       18       19       20       21       22       23  
##  0.0151  -0.0044  -0.0539   0.1240  -0.0302  -0.0545   0.1370  
## 
## Order selected 23  sigma^2 estimated as  0.02092
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Fits from method==&#39;Ar&#39; are not all positive. 
##   Setting values &lt;0 to 0 before rescaling.  
##   This might not be what you want. 
##   ARSTAN would tell you to plot that dirty dog at this point. 
##   Proceed with caution.
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Detrend by Friedman&#39;s super smoother.
##  Smoother parameters
##  span = cv, bass = 0
##  wt = default
## 
##  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Zero indices in Ar series:
##  993</code></pre>
<p><img src="02-intro_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Note that advanced users can use <code>return.info=TRUE</code> to have all the fitting parameters returned in a <code>list</code>. Having access to these is occasionally desirable.</p>
</div>
<div id="interactive-detrending" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Interactive detrending<a href="using-dplr.html#interactive-detrending" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are many instances where a user needs fine scale control while detrending perhaps fitting a negative exponential curve to one series, a spline to another, and the mean to a third. Like with crossdating, interactive detrending is a case where an app is useful. The <code>iDetrend</code> app is relatively simple interface to <code>detrend.series</code> that let’s users fit curves and plot them with several different options. When completed the user can save a file with the detrended data as well as generate log file that allows reproduction of the detrending from the command line. It’s available here</p>
<p><a href="https://viz.datascience.arizona.edu/iDetrend/" target="_blank">viz.datascience.arizona.edu/iDetrend/</a></p>
</div>
<div id="other-detrending-methods" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Other Detrending Methods<a href="using-dplr.html#other-detrending-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are other detrending methods that are less commonly used but might have theoretical advantages. These include regional curve standardization (function <code>rcs</code>), C-Method Standardization (function <code>cms</code>), and converting measurements of ring widths to basal area increment (functions <code>bai.in</code> and <code>bai.out</code>). See their help pages for further information.</p>
</div>
</div>
<div id="descriptive-statistics-for-detrended-data" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Descriptive Statistics for Detrended Data<a href="using-dplr.html#descriptive-statistics-for-detrended-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is also easy in <code>dplR</code> to compute commonly used descriptive statistics that describe the correlation between series (both within and between tree correlations) as well as the expressed population signal, signal-to-noise ratio, and subsample signal strength for a data set. These are done in <code>dplR</code> using the <code>rwi.stats</code> function so-named because these statistics are typically (but not always) carried out on detrended and standardized ring widths (rwi). If a data set has more than one core taken per tree this information can be used in the calculations to calculate within vs. between tree correlation. The function <code>read.ids</code> is used to identify which trees have multiple cores.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="using-dplr.html#cb47-1" tabindex="-1"></a>ca533.ids <span class="ot">&lt;-</span> <span class="fu">read.ids</span>(ca533, <span class="at">stc =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb47-2"><a href="using-dplr.html#cb47-2" tabindex="-1"></a><span class="fu">rwi.stats</span>(ca533.rwi, ca533.ids, <span class="at">prewhiten=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   n.cores n.trees  n n.tot n.wt n.bt rbar.tot rbar.wt rbar.bt c.eff rbar.eff
## 1      34      21 21   523   13  510    0.445   0.606    0.44 1.448    0.502
##     eps    snr
## 1 0.955 21.128</code></pre>
<p>There is (at least) one other way of looking at the average interseries correlation of a data set. The <code>interseries.cor</code> function in <code>dplR</code> gives a measure of average interseries correlation that is different from the rbar statistics from <code>rwi.stats</code>. In this function, correlations are calculated serially between each tree-ring series and a master chronology built from all the other series in the <code>rwl</code> object (leave-one-out principle). The average of those correlations is sometimes called the “overall interseries correlation” or even the “COFECHA correlation” in reference to commonly used crossdating software COFECHA. This number is typically higher than the various rbar values given by <code>rwi.stats</code>. We are showing just the first five series and the mean for all series here:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="using-dplr.html#cb49-1" tabindex="-1"></a>ca533.rho <span class="ot">&lt;-</span> <span class="fu">interseries.cor</span>(ca533.rwi, <span class="at">prewhiten=</span><span class="cn">TRUE</span>,</span>
<span id="cb49-2"><a href="using-dplr.html#cb49-2" tabindex="-1"></a>                             <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb49-3"><a href="using-dplr.html#cb49-3" tabindex="-1"></a>ca533.rho[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>##          res.cor p.val
## CAM011 0.5324769     0
## CAM021 0.6826813     0
## CAM031 0.5148129     0
## CAM032 0.6311426     0
## CAM041 0.5007524     0</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="using-dplr.html#cb51-1" tabindex="-1"></a><span class="fu">mean</span>(ca533.rho[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.6381676</code></pre>
<p>Again, if these concepts are unknown to you statistically look at some of the canonical works in dendrochronology like <span class="citation">Cook <em>et al.</em> (<a href="references.html#ref-Cook1990">1990</a>)</span>, <span class="citation">Fritts (<a href="references.html#ref-Fritts2001">2001</a>)</span>, and <span class="citation">Hughes <em>et al.</em> (<a href="references.html#ref-Hughes2011">2011</a>)</span>.</p>
</div>
<div id="building-a-mean-value-chronology" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Building a Mean-Value Chronology<a href="using-dplr.html#building-a-mean-value-chronology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After detrending, a user will typically build a chronology by averaging across the years of the rwi object. In <code>dplR</code> the function for doing this is <code>chron</code> which by default uses Tukey’s biweight robust mean (an average that is unaffected by outliers).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="using-dplr.html#cb53-1" tabindex="-1"></a>ca533.crn <span class="ot">&lt;-</span> <span class="fu">chron</span>(ca533.rwi)</span></code></pre></div>
<p>This object has the same number of rows as the rwi object that was used as the input and two columns. The first gives the chronology and the second the sample depth (the number of series available in that year).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="using-dplr.html#cb54-1" tabindex="-1"></a><span class="fu">dim</span>(ca533.rwi)</span></code></pre></div>
<pre><code>## [1] 1358   34</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="using-dplr.html#cb56-1" tabindex="-1"></a><span class="fu">dim</span>(ca533.crn)</span></code></pre></div>
<pre><code>## [1] 1358    2</code></pre>
<p>An object produced by <code>chron</code> has a generic S3 method for plotting which calls the <code>crn.plot</code> function (which has many arguments for customization). Here we will just make a simple plot of the chronology with a smoothing spline (function <code>caps</code>) added.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="using-dplr.html#cb58-1" tabindex="-1"></a><span class="fu">plot</span>(ca533.crn, <span class="at">add.spline=</span><span class="cn">TRUE</span>, <span class="at">nyrs=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="02-intro_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The <code>chron</code> function is the most basic (and most common) way to buld a chronology but there are many other ways as we will see in the next few chapters.</p>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Conclusion<a href="using-dplr.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general this page aims to give a very cursory overview of basic tasks that most dendrochronologists will want to be aware of. Know that we are just scratching the surface of what <code>dplR</code> is capable of. Browsing the list of functions in <code>dplR</code> will give you an idea of what else is available.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="using-dplr.html#cb59-1" tabindex="-1"></a>?dplR</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chronology-building.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
