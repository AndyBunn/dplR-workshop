<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Intro to dendro time-series | Learning to Love dplR</title>
  <meta name="description" content="Helful materials for dplR" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Intro to dendro time-series | Learning to Love dplR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Helful materials for dplR" />
  <meta name="github-repo" content="OpenDendro/dplR-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Intro to dendro time-series | Learning to Love dplR" />
  
  <meta name="twitter:description" content="Helful materials for dplR" />
  

<meta name="author" content="Andy Bunn" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="xdate.html"/>
<link rel="next" href="acknowledgements.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
      // AGB add fold-hide
    if (classList[i] === 'fold-hide') {
        show = false;
      }
    }
    // AGB
    // if code block has been labeled with class `fold-hide`, hide the code on init!
//    var classList = $(this).attr('class').split(/\s+/);
//    for (var i = 0; i < classList.length; i++) {
//    if (classList[i] === 'fold-hide') {
//        show = false;
//      }
//    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = true;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  // AGB add fold-hide changed === to !== to default to showing code
  window.initializeCodeFolding("show" !== "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#before-starting"><i class="fa fa-check"></i><b>2.1</b> Before Starting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#r"><i class="fa fa-check"></i><b>2.1.1</b> R</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#getting-dplr"><i class="fa fa-check"></i><b>2.1.2</b> Getting dplR</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#layout"><i class="fa fa-check"></i><b>2.2</b> Layout</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#a-note-on-name-conflicts"><i class="fa fa-check"></i><b>2.2.1</b> A Note on Name Conflicts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help-with-r"><i class="fa fa-check"></i><b>2.3</b> Getting Help with R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#citing-r-dplr-and-other-packages"><i class="fa fa-check"></i><b>2.4</b> Citing R, dplR, and Other Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-dplr.html"><a href="using-dplr.html"><i class="fa fa-check"></i><b>3</b> Using dplR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-dplr.html"><a href="using-dplr.html#what-is-covered"><i class="fa fa-check"></i><b>3.1</b> What is Covered</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="using-dplr.html"><a href="using-dplr.html#load-dplr"><i class="fa fa-check"></i><b>3.1.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-dplr.html"><a href="using-dplr.html#working-with-ring-width-data"><i class="fa fa-check"></i><b>3.2</b> Working with Ring-Width Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="using-dplr.html"><a href="using-dplr.html#reading-data"><i class="fa fa-check"></i><b>3.2.1</b> Reading Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="using-dplr.html"><a href="using-dplr.html#describing-and-plotting-ring-width-data"><i class="fa fa-check"></i><b>3.2.2</b> Describing and Plotting Ring-Width Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4" data-path="using-dplr.html"><a href="using-dplr.html#detrending"><i class="fa fa-check"></i><b>3.4</b> Detrending</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="using-dplr.html"><a href="using-dplr.html#common-detrending-methods"><i class="fa fa-check"></i><b>3.4.1</b> Common Detrending Methods</a></li>
<li class="chapter" data-level="3.4.2" data-path="using-dplr.html"><a href="using-dplr.html#interactive-detrending"><i class="fa fa-check"></i><b>3.4.2</b> Interactive detrending</a></li>
<li class="chapter" data-level="3.4.3" data-path="using-dplr.html"><a href="using-dplr.html#other-detrending-methods"><i class="fa fa-check"></i><b>3.4.3</b> Other Detrending Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="using-dplr.html"><a href="using-dplr.html#descriptive-statistics-for-detrended-data"><i class="fa fa-check"></i><b>3.5</b> Descriptive Statistics for Detrended Data</a></li>
<li class="chapter" data-level="3.6" data-path="using-dplr.html"><a href="using-dplr.html#building-a-mean-value-chronology"><i class="fa fa-check"></i><b>3.6</b> Building a Mean-Value Chronology</a></li>
<li class="chapter" data-level="3.7" data-path="using-dplr.html"><a href="using-dplr.html#conclusion"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chronology-building.html"><a href="chronology-building.html"><i class="fa fa-check"></i><b>4</b> Chronology Building</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chronology-building.html"><a href="chronology-building.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chronology-building.html"><a href="chronology-building.html#data-sets"><i class="fa fa-check"></i><b>4.2</b> Data Sets</a></li>
<li class="chapter" data-level="4.3" data-path="chronology-building.html"><a href="chronology-building.html#traditional-chronology"><i class="fa fa-check"></i><b>4.3</b> Traditional Chronology</a></li>
<li class="chapter" data-level="4.4" data-path="chronology-building.html"><a href="chronology-building.html#using-a-sample-depth-cutoff"><i class="fa fa-check"></i><b>4.4</b> Using a Sample Depth Cutoff</a></li>
<li class="chapter" data-level="4.5" data-path="chronology-building.html"><a href="chronology-building.html#using-sss-as-a-cutoff"><i class="fa fa-check"></i><b>4.5</b> Using SSS as a Cutoff</a></li>
<li class="chapter" data-level="4.6" data-path="chronology-building.html"><a href="chronology-building.html#chronology-uncertainty"><i class="fa fa-check"></i><b>4.6</b> Chronology Uncertainty</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chronology-building.html"><a href="chronology-building.html#bootstrapping-confidence-intervals"><i class="fa fa-check"></i><b>4.6.1</b> Bootstrapping confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chronology-building.html"><a href="chronology-building.html#the-arstan-chronology"><i class="fa fa-check"></i><b>4.7</b> The ARSTAN Chronology</a></li>
<li class="chapter" data-level="4.8" data-path="chronology-building.html"><a href="chronology-building.html#stabalizing-the-variance"><i class="fa fa-check"></i><b>4.8</b> Stabalizing the Variance</a></li>
<li class="chapter" data-level="4.9" data-path="chronology-building.html"><a href="chronology-building.html#stripping-out-series-by-eps"><i class="fa fa-check"></i><b>4.9</b> Stripping out series by EPS</a></li>
<li class="chapter" data-level="4.10" data-path="chronology-building.html"><a href="chronology-building.html#conclusion-1"><i class="fa fa-check"></i><b>4.10</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simple-signal-free.html"><a href="simple-signal-free.html"><i class="fa fa-check"></i><b>5</b> Simple Signal-Free</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#making-the-simple-signal-free-chronology"><i class="fa fa-check"></i><b>5.4</b> Making the Simple Signal-Free Chronology</a></li>
<li class="chapter" data-level="5.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#changing-the-detrending-method"><i class="fa fa-check"></i><b>5.5</b> Changing the Detrending Method</a></li>
<li class="chapter" data-level="5.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#walk-through"><i class="fa fa-check"></i><b>5.6</b> Walk Through</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-1-iteration-0"><i class="fa fa-check"></i><b>5.6.1</b> Step 1 (Iteration 0)</a></li>
<li class="chapter" data-level="5.6.2" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-2-and-3-iteration-1"><i class="fa fa-check"></i><b>5.6.2</b> Steps 2 and 3 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.3" data-path="simple-signal-free.html"><a href="simple-signal-free.html#steps-4-and-5-iteration-1"><i class="fa fa-check"></i><b>5.6.3</b> Steps 4 and 5 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.4" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-6-and-7-iteration-1"><i class="fa fa-check"></i><b>5.6.4</b> Step 6 and 7 (Iteration 1)</a></li>
<li class="chapter" data-level="5.6.5" data-path="simple-signal-free.html"><a href="simple-signal-free.html#step-8-begin-iterations"><i class="fa fa-check"></i><b>5.6.5</b> Step 8 (Begin Iterations)</a></li>
<li class="chapter" data-level="5.6.6" data-path="simple-signal-free.html"><a href="simple-signal-free.html#iterations-visualized"><i class="fa fa-check"></i><b>5.6.6</b> Iterations Visualized</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="simple-signal-free.html"><a href="simple-signal-free.html#final-thoughts"><i class="fa fa-check"></i><b>5.7</b> Final Thoughts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="xdate.html"><a href="xdate.html"><i class="fa fa-check"></i><b>6</b> xDate</a>
<ul>
<li class="chapter" data-level="6.1" data-path="xdate.html"><a href="xdate.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="xdate.html"><a href="xdate.html#using-the-xdater-app"><i class="fa fa-check"></i><b>6.2</b> Using the xDater app</a></li>
<li class="chapter" data-level="6.3" data-path="xdate.html"><a href="xdate.html#crossdating-by-hand-in-dplr"><i class="fa fa-check"></i><b>6.3</b> Crossdating by hand in dplR</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="xdate.html"><a href="xdate.html#load-dplr-1"><i class="fa fa-check"></i><b>6.3.1</b> Load dplR</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="xdate.html"><a href="xdate.html#ruining-a-perfectly-good-data-set"><i class="fa fa-check"></i><b>6.4</b> Ruining a Perfectly Good Data Set</a></li>
<li class="chapter" data-level="6.5" data-path="xdate.html"><a href="xdate.html#series-correlation-by-segment"><i class="fa fa-check"></i><b>6.5</b> Series Correlation by Segment</a></li>
<li class="chapter" data-level="6.6" data-path="xdate.html"><a href="xdate.html#individual-series-correlation"><i class="fa fa-check"></i><b>6.6</b> Individual Series Correlation</a></li>
<li class="chapter" data-level="6.7" data-path="xdate.html"><a href="xdate.html#using-cross-correlation"><i class="fa fa-check"></i><b>6.7</b> Using Cross Correlation</a></li>
<li class="chapter" data-level="6.8" data-path="xdate.html"><a href="xdate.html#visual-crossdating"><i class="fa fa-check"></i><b>6.8</b> Visual Crossdating</a></li>
<li class="chapter" data-level="6.9" data-path="xdate.html"><a href="xdate.html#conclusion-2"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html"><i class="fa fa-check"></i><b>7</b> Intro to dendro time-series</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#load-libraries"><i class="fa fa-check"></i><b>7.1.1</b> Load libraries</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#data-sets-1"><i class="fa fa-check"></i><b>7.2</b> Data Sets</a></li>
<li class="chapter" data-level="7.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#smoothing"><i class="fa fa-check"></i><b>7.3</b> Smoothing</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#moving-running-average"><i class="fa fa-check"></i><b>7.3.1</b> Moving (running) average</a></li>
<li class="chapter" data-level="7.3.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#hanning"><i class="fa fa-check"></i><b>7.3.2</b> Hanning</a></li>
<li class="chapter" data-level="7.3.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#splines"><i class="fa fa-check"></i><b>7.3.3</b> Splines</a></li>
<li class="chapter" data-level="7.3.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#loess"><i class="fa fa-check"></i><b>7.3.4</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#characterizing-temporal-structure"><i class="fa fa-check"></i><b>7.4</b> Characterizing Temporal Structure</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#acf-and-pacf"><i class="fa fa-check"></i><b>7.4.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="7.4.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#ar-and-arma"><i class="fa fa-check"></i><b>7.4.2</b> AR and ARMA</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#frequency-domain"><i class="fa fa-check"></i><b>7.5</b> Frequency Domain</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#power-via-spectral-analysis-and-wavelets"><i class="fa fa-check"></i><b>7.5.1</b> Power via Spectral Analysis and Wavelets</a></li>
<li class="chapter" data-level="7.5.2" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#extracting-signals"><i class="fa fa-check"></i><b>7.5.2</b> Extracting signals</a></li>
<li class="chapter" data-level="7.5.3" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#high-pass-low-pass-and-bandpass-filtering"><i class="fa fa-check"></i><b>7.5.3</b> High-pass, low-pass, and bandpass filtering</a></li>
<li class="chapter" data-level="7.5.4" data-path="intro-to-dendro-time-series.html"><a href="intro-to-dendro-time-series.html#interruption-duplicate-function-names"><i class="fa fa-check"></i><b>7.5.4</b> Interruption: Duplicate function names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>8</b> Acknowledgements</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning to Love dplR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro-to-dendro-time-series" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Intro to dendro time-series<a href="intro-to-dendro-time-series.html#intro-to-dendro-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this document we cover some of the basic time series tools in <code>dplR</code>. These include spectral analysis using redfit and wavelets. We also show off a few tools in other <code>R</code> packages like fitting AR and ARMA models, and Butterworth filters. However, this is just a tiny glimpse of tree-ring tools that exist in <code>R</code>.</p>
<div id="introduction-4" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction<a href="intro-to-dendro-time-series.html#introduction-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Dendrochronology Program Library in <code>R</code> (<code>dplR</code>) is a package for dendrochronologists to handle data processing and analysis. This document gives an introduction of some of the functions dealing with time series in <code>dplR</code> and looks at some functions other packages.</p>
<p>However, this document does not purport to be any sort of authority on time series analysis at all! There are many wonderful R-centric books on time series analysis that can tell you about the theory and practice of working with time-series data.</p>
<p>This is kind of a greatest hits of time-series tools that are commonly used in dendro, and not a reference text of any kind.</p>
<div id="load-libraries" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Load libraries<a href="intro-to-dendro-time-series.html#load-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will be using <code>dplR</code> in here as well as a few other packages that are useful for working with time-series data. If you haven’t installed these packages yet you will want to using the <code>install.packages()</code> function.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="intro-to-dendro-time-series.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplR)</span></code></pre></div>
<pre><code>## This is dplR version 1.7.4.
## dplR is part of openDendro https://opendendro.org.
## New users can visit https://opendendro.github.io/dplR-workshop/ to get started.</code></pre>
</div>
</div>
<div id="data-sets-1" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Data Sets<a href="intro-to-dendro-time-series.html#data-sets-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout this document we will use the on-board data set <code>co021</code> which gives the raw ring widths for Douglas fir <em>Pseudotsuga menziesii</em> at Mesa Verde in Colorado, USA. There are 35 series spanning 788 years.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="intro-to-dendro-time-series.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(co021)</span>
<span id="cb161-2"><a href="intro-to-dendro-time-series.html#cb161-2" aria-hidden="true" tabindex="-1"></a>co021.sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(co021)</span>
<span id="cb161-3"><a href="intro-to-dendro-time-series.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(co021.sum)</span></code></pre></div>
<pre><code>##   series first last year  mean median stdev  skew  gini   ar1
## 1 641114  1270 1963  694 0.287   0.23 0.231 2.884 0.372 0.686
## 2 641121  1250 1963  714 0.328   0.26 0.315 3.306 0.410 0.744
## 3 641132  1256 1963  708 0.357   0.29 0.337 4.741 0.373 0.686
## 4 641143  1237 1963  727 0.344   0.27 0.287 2.341 0.397 0.708
## 5 642114  1243 1963  721 0.281   0.24 0.219 2.848 0.358 0.673
## 6 642121  1260 1963  704 0.313   0.21 0.416 4.399 0.474 0.865</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="intro-to-dendro-time-series.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co021, <span class="at">plot.type=</span><span class="st">&quot;spag&quot;</span>)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>These data are gorgeous with long segments (564), high interseries correlation (0.6), and high first-order autocorrelation (0.85).</p>
<p>Let us make a mean-value chronology of the <code>co021</code> data after detrending
each series with a frequency response of 50% at a wavelength of 2/3 of
each series’s length.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="intro-to-dendro-time-series.html#cb164-1" aria-hidden="true" tabindex="-1"></a>co021.rwi <span class="ot">&lt;-</span> <span class="fu">detrend</span>(co021, <span class="at">method=</span><span class="st">&quot;Spline&quot;</span>)</span>
<span id="cb164-2"><a href="intro-to-dendro-time-series.html#cb164-2" aria-hidden="true" tabindex="-1"></a>co021.crn <span class="ot">&lt;-</span> <span class="fu">chron</span>(co021.rwi)</span></code></pre></div>
<p>We can plot the chronology with a smoothing spline with a 20-year period:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="intro-to-dendro-time-series.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co021.crn, <span class="at">add.spline=</span><span class="cn">TRUE</span>, <span class="at">nyrs=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="smoothing" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Smoothing<a href="intro-to-dendro-time-series.html#smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Very often one wants to smooth data to analyze or work only with particular aspects of the data. This kind of analysis is a big deal in time-series analysis. Smoothing is a way of isolating different frequencies of data but still thinking in the time domain. One such mark that we already alluded to above is the use of smoothing splines to detrend and filter tree-ring data. The urge to smooth a time series when we plot it is almost irresistible. It’s a sickness that dendro folks have. There are many different ways of smoothing and we will look at couple here.</p>
<p>The <code>co021.crn</code> object has two columns, the first giving the chronology
and the second the sample depth during that year. Let’s grab the years and the standard chronology and store them in their own objects.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="intro-to-dendro-time-series.html#cb166-1" aria-hidden="true" tabindex="-1"></a>yrs <span class="ot">&lt;-</span> <span class="fu">time</span>(co021.crn)</span>
<span id="cb166-2"><a href="intro-to-dendro-time-series.html#cb166-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> co021.crn<span class="sc">$</span>std</span></code></pre></div>
<div id="moving-running-average" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Moving (running) average<a href="intro-to-dendro-time-series.html#moving-running-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Centered moving averages (aka running averages) tend to be the first smoothing method that most people learn. Let’s revisit them. These have the advantage of being dirt simple. Below we will see that they emphasize low frequency in the examples below (at 32, 64, and 128 years) but retain some jaggedness too.</p>
<p>We will use the base <code>filter</code> function which is a straightforward convolution filter. As with any function always you can see the help file for details (<code>?filter</code>).</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="intro-to-dendro-time-series.html#cb167-1" aria-hidden="true" tabindex="-1"></a>ma32 <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">x=</span>dat, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">32</span>,<span class="at">times=</span><span class="dv">32</span>), <span class="at">sides=</span><span class="dv">2</span>)</span>
<span id="cb167-2"><a href="intro-to-dendro-time-series.html#cb167-2" aria-hidden="true" tabindex="-1"></a>ma64 <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">x=</span>dat, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">64</span>,<span class="at">times=</span><span class="dv">64</span>), <span class="at">sides=</span><span class="dv">2</span>)</span>
<span id="cb167-3"><a href="intro-to-dendro-time-series.html#cb167-3" aria-hidden="true" tabindex="-1"></a>ma128 <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">x=</span>dat, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">128</span>,<span class="at">times=</span><span class="dv">128</span>), <span class="at">sides=</span><span class="dv">2</span>)</span>
<span id="cb167-4"><a href="intro-to-dendro-time-series.html#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="intro-to-dendro-time-series.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Change plotting parameters</span></span>
<span id="cb167-6"><a href="intro-to-dendro-time-series.html#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>, <span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb167-7"><a href="intro-to-dendro-time-series.html#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="intro-to-dendro-time-series.html#cb167-8" aria-hidden="true" tabindex="-1"></a>my.cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#1B9E77&quot;</span>, <span class="st">&quot;#D95F02&quot;</span>, <span class="st">&quot;#7570B3&quot;</span>)</span>
<span id="cb167-9"><a href="intro-to-dendro-time-series.html#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,dat,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb167-10"><a href="intro-to-dendro-time-series.html#cb167-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb167-11"><a href="intro-to-dendro-time-series.html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,ma128, <span class="at">col =</span> my.cols[<span class="dv">1</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-12"><a href="intro-to-dendro-time-series.html#cb167-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,ma64, <span class="at">col =</span> my.cols[<span class="dv">2</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-13"><a href="intro-to-dendro-time-series.html#cb167-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,ma32, <span class="at">col =</span> my.cols[<span class="dv">3</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-14"><a href="intro-to-dendro-time-series.html#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>);<span class="fu">axis</span>(<span class="dv">4</span>)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="hanning" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Hanning<a href="intro-to-dendro-time-series.html#hanning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Hanning filter is similar to the moving average in the sense that the curve emphasizes low frequency variability and loses the jaggedness over the moving average. It’s also a simple filter (look at the code by typing <code>hanning</code> at the <code>R</code> prompt) but it also is a start into thinking in the frequency domain. It’s part of a family of functions called window functions that are zero-valued outside of some interval chosen by the user. It’s used quite a bit by time-series wonks and it is implemented in <code>dplR</code> with the function <code>hanning</code>. I’ll skip the theory here but it’s a great precursor to the work we will do with spectral analysis below.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="intro-to-dendro-time-series.html#cb168-1" aria-hidden="true" tabindex="-1"></a>han32 <span class="ot">&lt;-</span> <span class="fu">hanning</span>(dat,<span class="at">n=</span><span class="dv">32</span>)</span>
<span id="cb168-2"><a href="intro-to-dendro-time-series.html#cb168-2" aria-hidden="true" tabindex="-1"></a>han64 <span class="ot">&lt;-</span> <span class="fu">hanning</span>(dat,<span class="at">n=</span><span class="dv">64</span>)</span>
<span id="cb168-3"><a href="intro-to-dendro-time-series.html#cb168-3" aria-hidden="true" tabindex="-1"></a>han128 <span class="ot">&lt;-</span> <span class="fu">hanning</span>(dat,<span class="at">n=</span><span class="dv">128</span>)</span>
<span id="cb168-4"><a href="intro-to-dendro-time-series.html#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="intro-to-dendro-time-series.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>, <span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb168-6"><a href="intro-to-dendro-time-series.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,dat,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb168-7"><a href="intro-to-dendro-time-series.html#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb168-8"><a href="intro-to-dendro-time-series.html#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,han128, <span class="at">col =</span> my.cols[<span class="dv">1</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb168-9"><a href="intro-to-dendro-time-series.html#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,han64, <span class="at">col =</span> my.cols[<span class="dv">2</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb168-10"><a href="intro-to-dendro-time-series.html#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,han32, <span class="at">col =</span> my.cols[<span class="dv">3</span>], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb168-11"><a href="intro-to-dendro-time-series.html#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>);<span class="fu">axis</span>(<span class="dv">4</span>)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Like the moving average the smooth is shorter than the input data. This is too bad because it is nice to preserve the ends of the data but there is much wringing of hands and gnashing of teeth about the “right” way of running a smoothing algorithm where the data are sparse. This end-member problem is the subject of a lot of work in the time-series literature.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="intro-to-dendro-time-series.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(dat,ma32, han32), <span class="at">n =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##       dat   ma32  han32
## 1  1.0644     NA     NA
## 2  0.9241     NA     NA
## 3  0.9602     NA     NA
## 4  0.8011     NA     NA
## 5  1.2448     NA     NA
## 6  1.3222     NA     NA
## 7  0.4193     NA     NA
## 8  0.7125     NA     NA
## 9  1.0207     NA     NA
## 10 0.9851     NA     NA
## 11 0.4199     NA     NA
## 12 0.7638     NA     NA
## 13 1.4655     NA     NA
## 14 1.0005     NA     NA
## 15 1.0725     NA     NA
## 16 0.4987 0.9226 0.9609
## 17 0.6365 0.9167 0.9648
## 18 0.7509 0.9147 0.9667
## 19 2.0863 0.9205 0.9665
## 20 1.2892 0.9464 0.9644</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="intro-to-dendro-time-series.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">data.frame</span>(dat,ma32, han32), <span class="at">n =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##        dat   ma32  han32
## 769 1.0528 0.9214 0.9836
## 770 0.9065 0.9094 0.9761
## 771 0.4347 0.8989 0.9660
## 772 1.1876 0.8883 0.9533
## 773 1.1743     NA     NA
## 774 1.7610     NA     NA
## 775 0.6408     NA     NA
## 776 0.1934     NA     NA
## 777 1.3441     NA     NA
## 778 0.4973     NA     NA
## 779 0.7076     NA     NA
## 780 0.7565     NA     NA
## 781 0.5028     NA     NA
## 782 1.0647     NA     NA
## 783 1.1284     NA     NA
## 784 0.1459     NA     NA
## 785 1.1805     NA     NA
## 786 0.7720     NA     NA
## 787 0.6233     NA     NA
## 788 0.6441     NA     NA</code></pre>
</div>
<div id="splines" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Splines<a href="intro-to-dendro-time-series.html#splines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the world of tree rings, you’ll see frequent mention of cubic smoothing splines and typically a citation for something by Ed Cook who is the greatest quantitative dendrochronologist of all time. His work has left an enduring mark on nearly every aspect of quantitative dendrochronology. For splines, Cook and Peters <span class="citation">(<a href="references.html#ref-Cook1981" role="doc-biblioref">1981</a>)</span> is the canonical citation but we would point you to Cook and Kairiukstis <span class="citation">(<a href="references.html#ref-Cook1990" role="doc-biblioref">Cook <em>et al.</em>, 1990</a>)</span> for an overview. An R implementation of this spline is implemented in <code>dplR</code> with the <code>ffcsaps</code> function which was written in R and also in the <code>caps</code> function which is a wrapper for Cook’s Fortran code. They produce (nearly) identical results. Because <code>caps</code> is quite a bit faster than <code>ffcsaps</code>, <code>dplR</code> uses it by default.</p>
<p>The important argument for users is the <code>nyrs</code> argument which fits a spline of that many “years” to the data. All the functions in dplR assume annual resolution but they don’t really care if you are using data with a different frequency.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="intro-to-dendro-time-series.html#cb173-1" aria-hidden="true" tabindex="-1"></a>spl128 <span class="ot">&lt;-</span> <span class="fu">caps</span>(dat,<span class="at">nyrs=</span><span class="dv">128</span>)</span>
<span id="cb173-2"><a href="intro-to-dendro-time-series.html#cb173-2" aria-hidden="true" tabindex="-1"></a>spl64 <span class="ot">&lt;-</span> <span class="fu">caps</span>(dat,<span class="at">nyrs=</span><span class="dv">64</span>)</span>
<span id="cb173-3"><a href="intro-to-dendro-time-series.html#cb173-3" aria-hidden="true" tabindex="-1"></a>spl32 <span class="ot">&lt;-</span> <span class="fu">caps</span>(dat,<span class="at">nyrs=</span><span class="dv">32</span>)</span>
<span id="cb173-4"><a href="intro-to-dendro-time-series.html#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="intro-to-dendro-time-series.html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>, <span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb173-6"><a href="intro-to-dendro-time-series.html#cb173-6" aria-hidden="true" tabindex="-1"></a>my.cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#1B9E77&quot;</span>, <span class="st">&quot;#D95F02&quot;</span>, <span class="st">&quot;#7570B3&quot;</span>)</span>
<span id="cb173-7"><a href="intro-to-dendro-time-series.html#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,dat,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb173-8"><a href="intro-to-dendro-time-series.html#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb173-9"><a href="intro-to-dendro-time-series.html#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb173-10"><a href="intro-to-dendro-time-series.html#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,dat,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb173-11"><a href="intro-to-dendro-time-series.html#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,spl128,<span class="at">col=</span>my.cols[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb173-12"><a href="intro-to-dendro-time-series.html#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,spl64,<span class="at">col=</span>my.cols[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb173-13"><a href="intro-to-dendro-time-series.html#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,spl32,<span class="at">col=</span>my.cols[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb173-14"><a href="intro-to-dendro-time-series.html#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>);<span class="fu">axis</span>(<span class="dv">2</span>);<span class="fu">axis</span>(<span class="dv">3</span>);<span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb173-15"><a href="intro-to-dendro-time-series.html#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;dat&quot;</span>, <span class="st">&quot;128yrs&quot;</span>, <span class="st">&quot;64yrs&quot;</span>, <span class="st">&quot;32yrs&quot;</span>), </span>
<span id="cb173-16"><a href="intro-to-dendro-time-series.html#cb173-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,my.cols),<span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb173-17"><a href="intro-to-dendro-time-series.html#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="loess" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Loess<a href="intro-to-dendro-time-series.html#loess" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will highlight a filter used commonly in time-series analysis but largely ignored in dendro. We’ve become increasingly fond of the loess smoother which uses a local, linear polynomial fit to smooth data. The parameter to adjust is the span <code>f</code>. Because <code>f</code> is the proportion of points used in the smoothing, the smaller the number the less smooth the curve will be. E.g., our series is 788 years long. If we want something that approaches a 25-year smooth we can take 25 over 788 and use 0.0317 of the points in the fit.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="intro-to-dendro-time-series.html#cb174-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(yrs)</span>
<span id="cb174-2"><a href="intro-to-dendro-time-series.html#cb174-2" aria-hidden="true" tabindex="-1"></a>f128 <span class="ot">&lt;-</span> <span class="dv">128</span><span class="sc">/</span>n</span>
<span id="cb174-3"><a href="intro-to-dendro-time-series.html#cb174-3" aria-hidden="true" tabindex="-1"></a>f128.lo <span class="ot">&lt;-</span> <span class="fu">lowess</span>(<span class="at">x =</span> yrs, <span class="at">y =</span> dat, <span class="at">f =</span> f128)</span>
<span id="cb174-4"><a href="intro-to-dendro-time-series.html#cb174-4" aria-hidden="true" tabindex="-1"></a>f64 <span class="ot">&lt;-</span> <span class="dv">64</span><span class="sc">/</span>n</span>
<span id="cb174-5"><a href="intro-to-dendro-time-series.html#cb174-5" aria-hidden="true" tabindex="-1"></a>f64.lo <span class="ot">&lt;-</span> <span class="fu">lowess</span>(<span class="at">x =</span> yrs, <span class="at">y =</span> dat, <span class="at">f =</span> f64)</span>
<span id="cb174-6"><a href="intro-to-dendro-time-series.html#cb174-6" aria-hidden="true" tabindex="-1"></a>f32 <span class="ot">&lt;-</span> <span class="dv">32</span><span class="sc">/</span>n</span>
<span id="cb174-7"><a href="intro-to-dendro-time-series.html#cb174-7" aria-hidden="true" tabindex="-1"></a>f32.lo <span class="ot">&lt;-</span> <span class="fu">lowess</span>(<span class="at">x =</span> yrs, <span class="at">y =</span> dat, <span class="at">f =</span> f32)</span>
<span id="cb174-8"><a href="intro-to-dendro-time-series.html#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="intro-to-dendro-time-series.html#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>,<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb174-10"><a href="intro-to-dendro-time-series.html#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,dat,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;RWI&quot;</span>,<span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb174-11"><a href="intro-to-dendro-time-series.html#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb174-12"><a href="intro-to-dendro-time-series.html#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb174-13"><a href="intro-to-dendro-time-series.html#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,dat,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb174-14"><a href="intro-to-dendro-time-series.html#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,f128.lo<span class="sc">$</span>y,<span class="at">col=</span>my.cols[<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb174-15"><a href="intro-to-dendro-time-series.html#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,f64.lo<span class="sc">$</span>y,<span class="at">col=</span>my.cols[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb174-16"><a href="intro-to-dendro-time-series.html#cb174-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,f32.lo<span class="sc">$</span>y,<span class="at">col=</span>my.cols[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb174-17"><a href="intro-to-dendro-time-series.html#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>);<span class="fu">axis</span>(<span class="dv">2</span>);<span class="fu">axis</span>(<span class="dv">3</span>);<span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb174-18"><a href="intro-to-dendro-time-series.html#cb174-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;dat&quot;</span>, <span class="st">&quot;f128&quot;</span>, <span class="st">&quot;f64&quot;</span>, <span class="st">&quot;f32&quot;</span>), </span>
<span id="cb174-19"><a href="intro-to-dendro-time-series.html#cb174-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,my.cols),<span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb174-20"><a href="intro-to-dendro-time-series.html#cb174-20" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>These smoothing lines above are essentially eye candy. We can and will use filtering for more sophisticated analysis below but let’s back up.</p>
</div>
</div>
<div id="characterizing-temporal-structure" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Characterizing Temporal Structure<a href="intro-to-dendro-time-series.html#characterizing-temporal-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="acf-and-pacf" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> ACF and PACF<a href="intro-to-dendro-time-series.html#acf-and-pacf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start with a quick exploratory data analysis into the time-series process. We will start our analysis on the chronology by looking at its autocorrelation structure using R’s <code>acf</code> and <code>pacf</code> functions.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="intro-to-dendro-time-series.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb175-2"><a href="intro-to-dendro-time-series.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(dat)</span>
<span id="cb175-3"><a href="intro-to-dendro-time-series.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(dat)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The ACF function indicates significant autocorrelation out to a lag of about 10 years (which is not uncommon in tree-ring data) while the PACF plot suggests that the persistence after lag 4 is due to the propagation of the autocorrelation at earlier lags. And one could very well argue that the best model here is an <code>AR(2)</code> model given the low value of the PACF at lags 3 and 4. After all, you can get three opinions by asking one statistician to look a time series. But we digress.</p>
<p>We now have the first bit of solid information about the time-series properties of these data, it looks like they fit an <code>AR(4)</code> model.</p>
</div>
<div id="ar-and-arma" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> AR and ARMA<a href="intro-to-dendro-time-series.html#ar-and-arma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>But, <code>R</code> being <code>R</code>, there are many other ways to check this. The easiest way is to use the <code>ar</code> function which fits an autoregressive models up to a specified order and selects the final model by AIC.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="intro-to-dendro-time-series.html#cb176-1" aria-hidden="true" tabindex="-1"></a>dat.ar <span class="ot">&lt;-</span> <span class="fu">ar</span>(dat,<span class="at">order.max =</span> <span class="dv">10</span>)</span>
<span id="cb176-2"><a href="intro-to-dendro-time-series.html#cb176-2" aria-hidden="true" tabindex="-1"></a>dat.ar</span></code></pre></div>
<pre><code>## 
## Call:
## ar(x = dat, order.max = 10)
## 
## Coefficients:
##     1      2      3      4  
## 0.200  0.148  0.046  0.075  
## 
## Order selected 4  sigma^2 estimated as  0.188</code></pre>
<p>Indeed, <code>ar</code> selects an <code>AR(4)</code> model based on AIC. But as our tea-leaf gazing above indicates, an <code>AR(2)</code> model is very close when we look at the AIC values.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="intro-to-dendro-time-series.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,dat.ar<span class="sc">$</span>aic,<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;AR Order&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;AIC&quot;</span>,</span>
<span id="cb178-2"><a href="intro-to-dendro-time-series.html#cb178-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Difference in AIC between each model and the best-fitting model&quot;</span>)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>A strong argument can be made that a model with fewer parameters (e.g., an <code>AR(2)</code> might serve to characterize the data better than a model with more parameters.</p>
<p>We could also fit these models as <code>ARIMA</code> models individually using the <code>arima</code> function. That function will fit a model with components (p, d, q) as the AR order, the degree of difference, and the MA order. Thus, we could fit <code>AR(1)</code> to <code>AR(4)</code> models:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="intro-to-dendro-time-series.html#cb179-1" aria-hidden="true" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dat,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb179-2"><a href="intro-to-dendro-time-series.html#cb179-2" aria-hidden="true" tabindex="-1"></a>ar2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dat,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb179-3"><a href="intro-to-dendro-time-series.html#cb179-3" aria-hidden="true" tabindex="-1"></a>ar3 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dat,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb179-4"><a href="intro-to-dendro-time-series.html#cb179-4" aria-hidden="true" tabindex="-1"></a>ar4 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dat,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb179-5"><a href="intro-to-dendro-time-series.html#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="co"># example output</span></span>
<span id="cb179-6"><a href="intro-to-dendro-time-series.html#cb179-6" aria-hidden="true" tabindex="-1"></a>ar1</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = dat, order = c(1, 0, 0))
## 
## Coefficients:
##         ar1  intercept
##       0.260      0.975
## s.e.  0.034      0.021
## 
## sigma^2 estimated as 0.195:  log likelihood = -473.7,  aic = 953.3</code></pre>
<p>And then compare the Bayesian Information Criterion (BIC) values:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="intro-to-dendro-time-series.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(ar1,ar2,ar3,ar4)</span></code></pre></div>
<pre><code>##     df   BIC
## ar1  3 967.3
## ar2  4 949.9
## ar3  5 953.5
## ar4  6 955.8</code></pre>
<p>Here we find evidence for an <code>AR(2)</code> model over the AR(4) mode that the <code>ar</code> function chose. Clearly there is some wiggle room here.</p>
<p>So as we’ve seen, in addition to AR models we can fit their more complicated cousins, ARIMA models, as well. We can do the same sort of automatic selection of the model order by automatically fitting an ARIMA model using the <code>auto.arima</code> function in the package <code>forecast</code>. As with <code>ar</code>, this will choose a model that minimizes an information criterion after searching over user given constraints. We will use the default search parameters and use BIC to select the model.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="intro-to-dendro-time-series.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="intro-to-dendro-time-series.html#cb185-1" aria-hidden="true" tabindex="-1"></a>dat.arima <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(dat, <span class="at">ic=</span><span class="st">&quot;bic&quot;</span>)</span>
<span id="cb185-2"><a href="intro-to-dendro-time-series.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat.arima)</span></code></pre></div>
<pre><code>## Series: dat 
## ARIMA(1,0,1) with non-zero mean 
## 
## Coefficients:
##         ar1     ma1   mean
##       0.827  -0.634  0.974
## s.e.  0.050   0.068  0.032
## 
## sigma^2 = 0.187:  log likelihood = -457.1
## AIC=922.2   AICc=922.3   BIC=940.9
## 
## Training set error measures:
##                     ME   RMSE    MAE    MPE  MAPE   MASE       ACF1
## Training set 7.679e-05 0.4322 0.3427 -457.9 481.3 0.7942 -0.0004114</code></pre>
<p>Even more confusion! Instead of an <code>AR(p)</code> model, <code>auto.arima</code> went for an
<code>ARMA(1,1)</code> model (aka <code>ARIMA(1,0,1)</code>). The parsimony principle certainly likes a nice simple <code>ARMA(1,1)</code> model. Note that we could look at the residuals, model coefficients, etc. quite easily. And indeed the residuals are quite clean as we would expect.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="intro-to-dendro-time-series.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(dat.arima))</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>This is clearly an incredibly shallow look at a deep topic. Hopefully these will get you started with different tools to characterize temporal structure in data. There are many more resources available and techniques we haven’t covered (e.g., GARCH modelling).</p>
</div>
</div>
<div id="frequency-domain" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Frequency Domain<a href="intro-to-dendro-time-series.html#frequency-domain" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Any time series can be broken down into a (possibly infinite) set of sine and cosine functions. So, a messy looking series like <code>co021.crn</code> is the sum of oscillating functions. The act of breaking these down is exactly what a Fourier transform does. Fourier transforms are everywhere – think JPEGs and MP3s. But we can use them to see what frequencies are important or dominant in a time series.</p>
<p>Someday we will work up the courage to write a tutorial on fast Fourier transforms for dendro using <code>R</code>. It’s hard to know where to start with tackling the subject though as many of the tools that people want for dendro start with <code>fft(dat)</code> but don’t end there. With tree-ring data we often use spectral analysis as a way of detecting periodic signals that are corrupted by noise.</p>
<div id="power-via-spectral-analysis-and-wavelets" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Power via Spectral Analysis and Wavelets<a href="intro-to-dendro-time-series.html#power-via-spectral-analysis-and-wavelets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given the above rationale, we will limit ourselves here to some of the tools that are used in dendro without building these up from the fast Fourier transform itself. In <code>dplR</code>, we’ve implemented two of the most common ways that dendrochronologists go about this and there are a host of other approaches in <code>R</code> that we won’t get to here.</p>
<p>The <code>redfit</code> function in <code>dplR</code> is a port of Schulz’s REDFIT (version 3.8e) program and estimates the red-noise spectrum of a time series <span class="citation">(<a href="references.html#ref-Schulz2002" role="doc-biblioref">Schulz &amp; Mudelsee, 2002</a>)</span> with optional testing of that spectrum against a red-noise background using Monte Carlo simulations.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="intro-to-dendro-time-series.html#cb188-1" aria-hidden="true" tabindex="-1"></a>redf.dat <span class="ot">&lt;-</span> <span class="fu">redfit</span>(dat, <span class="at">nsim =</span> <span class="dv">1000</span>)</span>
<span id="cb188-2"><a href="intro-to-dendro-time-series.html#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="intro-to-dendro-time-series.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">tcl =</span> <span class="fl">0.5</span>, <span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">2.2</span>, <span class="dv">4</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>),<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb188-4"><a href="intro-to-dendro-time-series.html#cb188-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-5"><a href="intro-to-dendro-time-series.html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]],</span>
<span id="cb188-6"><a href="intro-to-dendro-time-series.html#cb188-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">range</span>(redf.dat[[<span class="st">&quot;ci99&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]]),</span>
<span id="cb188-7"><a href="intro-to-dendro-time-series.html#cb188-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Spectrum&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Frequency (cycles per year)&quot;</span>,</span>
<span id="cb188-8"><a href="intro-to-dendro-time-series.html#cb188-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb188-9"><a href="intro-to-dendro-time-series.html#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb188-10"><a href="intro-to-dendro-time-series.html#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]], <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb188-11"><a href="intro-to-dendro-time-series.html#cb188-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], <span class="fu">smooth.spline</span>(redf.dat[[<span class="st">&quot;ci99&quot;</span>]],<span class="at">spar =</span> <span class="fl">0.8</span>)<span class="sc">$</span>y, <span class="at">col =</span> <span class="st">&quot;#D95F02&quot;</span>)</span>
<span id="cb188-12"><a href="intro-to-dendro-time-series.html#cb188-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], <span class="fu">smooth.spline</span>(redf.dat[[<span class="st">&quot;ci95&quot;</span>]],<span class="at">spar =</span> <span class="fl">0.8</span>)<span class="sc">$</span>y, <span class="at">col =</span> <span class="st">&quot;#7570B3&quot;</span>)</span>
<span id="cb188-13"><a href="intro-to-dendro-time-series.html#cb188-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], <span class="fu">smooth.spline</span>(redf.dat[[<span class="st">&quot;ci90&quot;</span>]],<span class="at">spar =</span> <span class="fl">0.8</span>)<span class="sc">$</span>y, <span class="at">col =</span> <span class="st">&quot;#E7298A&quot;</span>)</span>
<span id="cb188-14"><a href="intro-to-dendro-time-series.html#cb188-14" aria-hidden="true" tabindex="-1"></a>freqs <span class="ot">&lt;-</span> <span class="fu">pretty</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]])</span>
<span id="cb188-15"><a href="intro-to-dendro-time-series.html#cb188-15" aria-hidden="true" tabindex="-1"></a>pers <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">/</span> freqs, <span class="dv">2</span>)</span>
<span id="cb188-16"><a href="intro-to-dendro-time-series.html#cb188-16" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> freqs, <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb188-17"><a href="intro-to-dendro-time-series.html#cb188-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>, <span class="at">at =</span> freqs, <span class="at">labels =</span> pers)</span>
<span id="cb188-18"><a href="intro-to-dendro-time-series.html#cb188-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;Period (year)&quot;</span>, <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">1.1</span>)</span>
<span id="cb188-19"><a href="intro-to-dendro-time-series.html#cb188-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb188-20"><a href="intro-to-dendro-time-series.html#cb188-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;dat&quot;</span>, <span class="st">&quot;CI99&quot;</span>, <span class="st">&quot;CI95&quot;</span>, <span class="st">&quot;CI90&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb188-21"><a href="intro-to-dendro-time-series.html#cb188-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;#D95F02&quot;</span>, <span class="st">&quot;#7570B3&quot;</span>, <span class="st">&quot;#E7298A&quot;</span>),</span>
<span id="cb188-22"><a href="intro-to-dendro-time-series.html#cb188-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb188-23"><a href="intro-to-dendro-time-series.html#cb188-23" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Using the Mesa Verde chronology we see that there are frequencies in that time series that are significantly different from a red-noise assumption in the interannual (&lt;3 years) and at low frequencies (multidecadal).</p>
<p>Another popular way to visualize a tree-ring chronology in the frequency domain is through a continuous wavelet transform. In <code>dplR</code>, there is are functions for calculating the transform via <code>wavelet</code> and plotting the result via <code>wavelet.plot</code>.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="intro-to-dendro-time-series.html#cb189-1" aria-hidden="true" tabindex="-1"></a>out.wave <span class="ot">&lt;-</span> <span class="fu">morlet</span>(<span class="at">y1 =</span> dat, <span class="at">x1 =</span> yrs, <span class="at">p2 =</span> <span class="dv">8</span>, <span class="at">dj =</span> <span class="fl">0.1</span>,</span>
<span id="cb189-2"><a href="intro-to-dendro-time-series.html#cb189-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">siglvl =</span> <span class="fl">0.99</span>)</span>
<span id="cb189-3"><a href="intro-to-dendro-time-series.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wavelet.plot</span>(out.wave, <span class="at">useRaster=</span><span class="cn">NA</span>, <span class="at">reverse.y =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>The wavelet plot shows a similar story as the plot from <code>redfit</code> with significant variation at interannual to multidecadal scales.</p>
</div>
<div id="extracting-signals" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Extracting signals<a href="intro-to-dendro-time-series.html#extracting-signals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another common task we’ll mention here is extracting specific frequency components from a time series to look at different aspects of say, high vs low frequency growth. One approach to doing this is to use wavelets again but here we will decompose a time series into its constituent voices using a discrete wavelet transform with the <code>mra</code> function in the package <code>waveslim</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="intro-to-dendro-time-series.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(waveslim)</span></code></pre></div>
<pre><code>## 
## waveslim: Wavelet Method for 1/2/3D Signals (version = 1.8.2)</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="intro-to-dendro-time-series.html#cb192-1" aria-hidden="true" tabindex="-1"></a>nPwrs2 <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="fu">log</span>(n)<span class="sc">/</span><span class="fu">log</span>(<span class="dv">2</span>)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb192-2"><a href="intro-to-dendro-time-series.html#cb192-2" aria-hidden="true" tabindex="-1"></a>dat.mra <span class="ot">&lt;-</span> <span class="fu">mra</span>(dat, <span class="at">wf =</span> <span class="st">&quot;la8&quot;</span>, <span class="at">J =</span> nPwrs2, <span class="at">method =</span> <span class="st">&quot;modwt&quot;</span>,</span>
<span id="cb192-3"><a href="intro-to-dendro-time-series.html#cb192-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">boundary =</span> <span class="st">&quot;periodic&quot;</span>)</span>
<span id="cb192-4"><a href="intro-to-dendro-time-series.html#cb192-4" aria-hidden="true" tabindex="-1"></a>yrsLabels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="dv">2</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>nPwrs2),<span class="st">&quot;yrs&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb192-5"><a href="intro-to-dendro-time-series.html#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="intro-to-dendro-time-series.html#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.25</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>,<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb192-7"><a href="intro-to-dendro-time-series.html#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,<span class="fu">rep</span>(<span class="dv">1</span>,n),<span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb192-8"><a href="intro-to-dendro-time-series.html#cb192-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">38</span>))</span>
<span id="cb192-9"><a href="intro-to-dendro-time-series.html#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;Multiresolution decomposition&quot;</span>,<span class="at">line=</span><span class="fl">0.75</span>)</span>
<span id="cb192-10"><a href="intro-to-dendro-time-series.html#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>)</span>
<span id="cb192-11"><a href="intro-to-dendro-time-series.html#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Years&quot;</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">line =</span> <span class="fl">1.25</span>)</span>
<span id="cb192-12"><a href="intro-to-dendro-time-series.html#cb192-12" aria-hidden="true" tabindex="-1"></a>Offset <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb192-13"><a href="intro-to-dendro-time-series.html#cb192-13" aria-hidden="true" tabindex="-1"></a>dat.mra2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(<span class="fu">as.data.frame</span>(dat.mra))</span>
<span id="cb192-14"><a href="intro-to-dendro-time-series.html#cb192-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> nPwrs2<span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb192-15"><a href="intro-to-dendro-time-series.html#cb192-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> dat.mra2[,i] <span class="sc">+</span> Offset</span>
<span id="cb192-16"><a href="intro-to-dendro-time-series.html#cb192-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(yrs,x)</span>
<span id="cb192-17"><a href="intro-to-dendro-time-series.html#cb192-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span>Offset,<span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb192-18"><a href="intro-to-dendro-time-series.html#cb192-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="fu">names</span>(dat.mra)[[i]],<span class="at">side=</span><span class="dv">2</span>,<span class="at">at=</span>Offset,<span class="at">line =</span> <span class="dv">0</span>)</span>
<span id="cb192-19"><a href="intro-to-dendro-time-series.html#cb192-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(yrsLabels[i],<span class="at">side=</span><span class="dv">4</span>,<span class="at">at=</span>Offset,<span class="at">line =</span> <span class="dv">0</span>)</span>
<span id="cb192-20"><a href="intro-to-dendro-time-series.html#cb192-20" aria-hidden="true" tabindex="-1"></a>  Offset <span class="ot">&lt;-</span> Offset<span class="sc">+</span><span class="dv">5</span></span>
<span id="cb192-21"><a href="intro-to-dendro-time-series.html#cb192-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-22"><a href="intro-to-dendro-time-series.html#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Here the Mesa Verde chronology is shown via an additive decomposition for each power of 2 from <span class="math inline">\(2^1\)</span> to <span class="math inline">\(2^8\)</span>. Note that each voice is scaled to itself by dividing by its standard deviation in order to present them on the same y-axis. If the <code>scale</code> function were to be removed (and we leave that as an exercise to the reader) the variations between voices would be greatly reduced. Note the similarity in the continuous and discrete wavelet plots for the variation in the 64-year band around the year 1600 and the lower frequency variation at 128 years around the year 1400.</p>
</div>
<div id="high-pass-low-pass-and-bandpass-filtering" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> High-pass, low-pass, and bandpass filtering<a href="intro-to-dendro-time-series.html#high-pass-low-pass-and-bandpass-filtering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another common technique used in tree-ring analysis is to filter data like we did above with moving averages, splines, and so on but doing so in the frequency domain explicitly rather than in the time domain. For instance, we might want to remove the high frequencies from a data set and leave the low frequencies (low-pass filtering) or vice versa (high-pass filtering). Or extract specific frequencies and discard others (band-pass and stop-pass filtering).</p>
<p>Let’s look at the <code>signal</code> library.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="intro-to-dendro-time-series.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(signal)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;signal&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplR&#39;:
## 
##     hanning</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, poly</code></pre>
<p>We can start low-pass filtering in <code>R</code> with the Butterworth filter. We will fit two 4th order filters with frequencies of 0.2 and 0.05.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="intro-to-dendro-time-series.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here are two frequencies that we will use for demonstrating filtering</span></span>
<span id="cb197-2"><a href="intro-to-dendro-time-series.html#cb197-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># period of 5</span></span>
<span id="cb197-3"><a href="intro-to-dendro-time-series.html#cb197-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># period of 20</span></span>
<span id="cb197-4"><a href="intro-to-dendro-time-series.html#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="intro-to-dendro-time-series.html#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the butterworth filter.</span></span>
<span id="cb197-6"><a href="intro-to-dendro-time-series.html#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiply freq by 2</span></span>
<span id="cb197-7"><a href="intro-to-dendro-time-series.html#cb197-7" aria-hidden="true" tabindex="-1"></a>f1Low <span class="ot">&lt;-</span> <span class="fu">butter</span>(<span class="at">n=</span><span class="dv">4</span>, <span class="at">W=</span>f1<span class="sc">*</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;low&quot;</span>)</span>
<span id="cb197-8"><a href="intro-to-dendro-time-series.html#cb197-8" aria-hidden="true" tabindex="-1"></a>f2Low <span class="ot">&lt;-</span> <span class="fu">butter</span>(<span class="at">n=</span><span class="dv">4</span>, <span class="at">W=</span>f2<span class="sc">*</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;low&quot;</span>)</span>
<span id="cb197-9"><a href="intro-to-dendro-time-series.html#cb197-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-10"><a href="intro-to-dendro-time-series.html#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We will use filtfilt do run the filter. </span></span>
<span id="cb197-11"><a href="intro-to-dendro-time-series.html#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="co"># But before that there is a wrinkle. We have to </span></span>
<span id="cb197-12"><a href="intro-to-dendro-time-series.html#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mirror and extend the data near the edge to </span></span>
<span id="cb197-13"><a href="intro-to-dendro-time-series.html#cb197-13" aria-hidden="true" tabindex="-1"></a><span class="co"># avoid end effects. The matlab/octave versions do something </span></span>
<span id="cb197-14"><a href="intro-to-dendro-time-series.html#cb197-14" aria-hidden="true" tabindex="-1"></a><span class="co"># like this behind the scenes I think. Regardless, it</span></span>
<span id="cb197-15"><a href="intro-to-dendro-time-series.html#cb197-15" aria-hidden="true" tabindex="-1"></a><span class="co"># is a simple form of padding.</span></span>
<span id="cb197-16"><a href="intro-to-dendro-time-series.html#cb197-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-17"><a href="intro-to-dendro-time-series.html#cb197-17" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(dat)</span>
<span id="cb197-18"><a href="intro-to-dendro-time-series.html#cb197-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create a pas that is adds a 1/4 of the length to the front and</span></span>
<span id="cb197-19"><a href="intro-to-dendro-time-series.html#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="co"># back of the data. This can be tuned according to the freqs in question</span></span>
<span id="cb197-20"><a href="intro-to-dendro-time-series.html#cb197-20" aria-hidden="true" tabindex="-1"></a><span class="co"># and there is nothing special about 1/4</span></span>
<span id="cb197-21"><a href="intro-to-dendro-time-series.html#cb197-21" aria-hidden="true" tabindex="-1"></a>pad <span class="ot">&lt;-</span> <span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb197-22"><a href="intro-to-dendro-time-series.html#cb197-22" aria-hidden="true" tabindex="-1"></a><span class="co"># pad the data</span></span>
<span id="cb197-23"><a href="intro-to-dendro-time-series.html#cb197-23" aria-hidden="true" tabindex="-1"></a>datPad <span class="ot">&lt;-</span> <span class="fu">c</span>(dat[pad<span class="sc">:</span><span class="dv">1</span>],dat,dat[n<span class="sc">:</span>(n<span class="sc">-</span>pad)]) </span>
<span id="cb197-24"><a href="intro-to-dendro-time-series.html#cb197-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-25"><a href="intro-to-dendro-time-series.html#cb197-25" aria-hidden="true" tabindex="-1"></a><span class="co"># run the filter  </span></span>
<span id="cb197-26"><a href="intro-to-dendro-time-series.html#cb197-26" aria-hidden="true" tabindex="-1"></a>datF1Low <span class="ot">&lt;-</span> <span class="fu">filtfilt</span>(f1Low, datPad)</span>
<span id="cb197-27"><a href="intro-to-dendro-time-series.html#cb197-27" aria-hidden="true" tabindex="-1"></a>datF2Low <span class="ot">&lt;-</span> <span class="fu">filtfilt</span>(f2Low, datPad)</span>
<span id="cb197-28"><a href="intro-to-dendro-time-series.html#cb197-28" aria-hidden="true" tabindex="-1"></a><span class="co"># unpad the filtered data</span></span>
<span id="cb197-29"><a href="intro-to-dendro-time-series.html#cb197-29" aria-hidden="true" tabindex="-1"></a>datF1Low <span class="ot">&lt;-</span> datF1Low[(pad<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>pad)]</span>
<span id="cb197-30"><a href="intro-to-dendro-time-series.html#cb197-30" aria-hidden="true" tabindex="-1"></a>datF2Low <span class="ot">&lt;-</span> datF2Low[(pad<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>pad)]</span>
<span id="cb197-31"><a href="intro-to-dendro-time-series.html#cb197-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-32"><a href="intro-to-dendro-time-series.html#cb197-32" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>,<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb197-33"><a href="intro-to-dendro-time-series.html#cb197-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,dat,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb197-34"><a href="intro-to-dendro-time-series.html#cb197-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb197-35"><a href="intro-to-dendro-time-series.html#cb197-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb197-36"><a href="intro-to-dendro-time-series.html#cb197-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,dat,<span class="at">col=</span><span class="st">&quot;grey80&quot;</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb197-37"><a href="intro-to-dendro-time-series.html#cb197-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,datF1Low,<span class="at">col=</span>my.cols[<span class="dv">1</span>],<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb197-38"><a href="intro-to-dendro-time-series.html#cb197-38" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,datF2Low,<span class="at">col=</span>my.cols[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb197-39"><a href="intro-to-dendro-time-series.html#cb197-39" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>);<span class="fu">axis</span>(<span class="dv">2</span>);<span class="fu">axis</span>(<span class="dv">3</span>);<span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb197-40"><a href="intro-to-dendro-time-series.html#cb197-40" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;f &lt; 0.2&quot;</span>, <span class="st">&quot;f &lt; 0.05&quot;</span>), </span>
<span id="cb197-41"><a href="intro-to-dendro-time-series.html#cb197-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">c</span>(my.cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),<span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb197-42"><a href="intro-to-dendro-time-series.html#cb197-42" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>To satisfy ourselves that the low-pass filter did what we thought it should let’s look at the power spectrum of the filtered data for <code>f1</code>:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="intro-to-dendro-time-series.html#cb198-1" aria-hidden="true" tabindex="-1"></a>redf.dat <span class="ot">&lt;-</span> <span class="fu">redfit</span>(datF1Low, <span class="at">mctest=</span><span class="cn">FALSE</span>)</span>
<span id="cb198-2"><a href="intro-to-dendro-time-series.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">tcl =</span> <span class="fl">0.5</span>, <span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">2.2</span>, <span class="dv">4</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>),<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb198-3"><a href="intro-to-dendro-time-series.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]],</span>
<span id="cb198-4"><a href="intro-to-dendro-time-series.html#cb198-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb198-5"><a href="intro-to-dendro-time-series.html#cb198-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Spectrum&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Frequency (cycles per year)&quot;</span>,</span>
<span id="cb198-6"><a href="intro-to-dendro-time-series.html#cb198-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb198-7"><a href="intro-to-dendro-time-series.html#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb198-8"><a href="intro-to-dendro-time-series.html#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]], <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb198-9"><a href="intro-to-dendro-time-series.html#cb198-9" aria-hidden="true" tabindex="-1"></a>freqs <span class="ot">&lt;-</span> <span class="fu">pretty</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]])</span>
<span id="cb198-10"><a href="intro-to-dendro-time-series.html#cb198-10" aria-hidden="true" tabindex="-1"></a>pers <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">/</span> freqs, <span class="dv">2</span>)</span>
<span id="cb198-11"><a href="intro-to-dendro-time-series.html#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> freqs, <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb198-12"><a href="intro-to-dendro-time-series.html#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>, <span class="at">at =</span> freqs, <span class="at">labels =</span> pers)</span>
<span id="cb198-13"><a href="intro-to-dendro-time-series.html#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;Period (year)&quot;</span>, <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">1.1</span>)</span>
<span id="cb198-14"><a href="intro-to-dendro-time-series.html#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb198-15"><a href="intro-to-dendro-time-series.html#cb198-15" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>We could repeat this with high-pass filters by changing <code>type="high"</code> when we first make the filter. We could also filter to include only specified frequencies by providing the lower and upper bands. E.g., <code>butter(n=4, W=c(f2,f1)*2, type="pass")</code>.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="intro-to-dendro-time-series.html#cb199-1" aria-hidden="true" tabindex="-1"></a>f1f2Pass <span class="ot">&lt;-</span> <span class="fu">butter</span>(<span class="at">n=</span><span class="dv">4</span>, <span class="at">W=</span><span class="fu">c</span>(f2,f1)<span class="sc">*</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;pass&quot;</span>)</span>
<span id="cb199-2"><a href="intro-to-dendro-time-series.html#cb199-2" aria-hidden="true" tabindex="-1"></a>datPass <span class="ot">&lt;-</span> <span class="fu">filtfilt</span>(f1f2Pass, datPad)</span>
<span id="cb199-3"><a href="intro-to-dendro-time-series.html#cb199-3" aria-hidden="true" tabindex="-1"></a>datPass <span class="ot">&lt;-</span> datPass[(pad<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>pad)]</span>
<span id="cb199-4"><a href="intro-to-dendro-time-series.html#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="intro-to-dendro-time-series.html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.25</span>,<span class="dv">0</span>),<span class="at">tcl=</span><span class="fl">0.5</span>,<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>,<span class="at">yaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb199-6"><a href="intro-to-dendro-time-series.html#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yrs,datPass,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb199-7"><a href="intro-to-dendro-time-series.html#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb199-8"><a href="intro-to-dendro-time-series.html#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb199-9"><a href="intro-to-dendro-time-series.html#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(yrs,datPass,<span class="at">col=</span>my.cols[<span class="dv">3</span>],<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb199-10"><a href="intro-to-dendro-time-series.html#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>);<span class="fu">axis</span>(<span class="dv">2</span>);<span class="fu">axis</span>(<span class="dv">3</span>);<span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb199-11"><a href="intro-to-dendro-time-series.html#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;0.05 &lt; f &lt; 0.2&quot;</span>, </span>
<span id="cb199-12"><a href="intro-to-dendro-time-series.html#cb199-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">c</span>(my.cols[<span class="dv">3</span>]),<span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb199-13"><a href="intro-to-dendro-time-series.html#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>And as above, here is the power spectrum of the band-pass data:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="intro-to-dendro-time-series.html#cb200-1" aria-hidden="true" tabindex="-1"></a>redf.dat <span class="ot">&lt;-</span> <span class="fu">redfit</span>(datPass, <span class="at">mctest=</span><span class="cn">FALSE</span>)</span>
<span id="cb200-2"><a href="intro-to-dendro-time-series.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">tcl =</span> <span class="fl">0.5</span>, <span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">2.2</span>, <span class="dv">4</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>),<span class="at">xaxs=</span><span class="st">&quot;i&quot;</span>)</span>
<span id="cb200-3"><a href="intro-to-dendro-time-series.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]],</span>
<span id="cb200-4"><a href="intro-to-dendro-time-series.html#cb200-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb200-5"><a href="intro-to-dendro-time-series.html#cb200-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Spectrum&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Frequency (cycles per year)&quot;</span>,</span>
<span id="cb200-6"><a href="intro-to-dendro-time-series.html#cb200-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-7"><a href="intro-to-dendro-time-series.html#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb200-8"><a href="intro-to-dendro-time-series.html#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]], redf.dat[[<span class="st">&quot;gxxc&quot;</span>]], <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb200-9"><a href="intro-to-dendro-time-series.html#cb200-9" aria-hidden="true" tabindex="-1"></a>freqs <span class="ot">&lt;-</span> <span class="fu">pretty</span>(redf.dat[[<span class="st">&quot;freq&quot;</span>]])</span>
<span id="cb200-10"><a href="intro-to-dendro-time-series.html#cb200-10" aria-hidden="true" tabindex="-1"></a>pers <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">/</span> freqs, <span class="dv">2</span>)</span>
<span id="cb200-11"><a href="intro-to-dendro-time-series.html#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> freqs, <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-12"><a href="intro-to-dendro-time-series.html#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">3</span>, <span class="at">at =</span> freqs, <span class="at">labels =</span> pers)</span>
<span id="cb200-13"><a href="intro-to-dendro-time-series.html#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;Period (year)&quot;</span>, <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">1.1</span>)</span>
<span id="cb200-14"><a href="intro-to-dendro-time-series.html#cb200-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb200-15"><a href="intro-to-dendro-time-series.html#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="06-timeSeries_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="interruption-duplicate-function-names" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Interruption: Duplicate function names<a href="intro-to-dendro-time-series.html#interruption-duplicate-function-names" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Take a moment to look back at the messages given off from loading <code>signal</code>. There are times when two packages will have the same function names. For instance both the <code>signal</code> package and <code>dplR</code> have a function called <code>hanning</code> (which applies the hanning filter to a time series). When two libraries are loaded that have two functions with the same name, R has to decide which to use when the function is called from the command line. Thus if we type <code>hanning</code> at the prompt we will get the `<code>hanning</code> function from the <code>signal</code> library. Because <code>signal</code> was loaded after <code>dplR</code> the <code>hanning</code> function from <code>signal</code> gets primacy. The same goes for the signal functions <code>filter</code> and <code>poly</code> which have counterparts the library <code>stats</code> which is loaded when <code>R</code> is first started.</p>
<p>This dual name phenomenon can occasionally (but only occasionally) be a hindrance if you forget that it has happened. For instance, the function <code>hanning</code> in <code>signal</code> doesn’t do the same thing as the function <code>hanning</code> does in <code>dplR</code>. If you were expecting the behavior of one and got the other you might break your scripts, confuse yourself, and spend time tracking down the error. So, pay attention to masking when you load a package.</p>
<p>We can still access dplR’s version of <code>hanning</code> via <code>dplR::hanning</code> if you want it. The same goes for <code>stats::filter</code>, <code>stats::poly</code>, and so on.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>But note the information on name masking that gets spit out when we do – see explanation in the next section.<a href="intro-to-dendro-time-series.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="xdate.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="acknowledgements.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
